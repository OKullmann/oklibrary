# Oliver Kullmann, 8.1.2021 (Swansea)

Testing generator LSRG


A) Non-uniform distributions for N=4

c version                               "0.1.2"
c machine_name                          "csltok2"
c bogomips                              5799.77
c command-line                          "./TimingLSRG" "4" "1e7" "ma"
c N                                     4
c T                                     10000000
c gen-option                            ma-only
c num_e-seeds                           15
c  e-seeds                              1609092523835210350 1 0 1609092786237186306 0 3 2 0 4 4 0 0 0 10000000 0
N=4, reduced=0, L(N)=576
T=10000000, found=576
exact prob=L(N)/T = 0.0017361111111111111111
frequency statistics:
     0.00093749999999999999998      0.0017361111111111111109      0.0025479999999999999999
                        median                    0.00172925
                            sd     0.00077162359056155813681
p-value statistics:
    1.6486458284489786069e-828     8.320211783362720547e-671    4.7724108435879807136e-668
                        median    2.8348512089861107719e-748
                            sd    1.9885075187367791728e-669
ks:     5.2583805365546965049e-18
Comparison with uniform generator for the exact prob:
Frequencies:
                     0.0016987      0.0017361111111111111113                     0.0017702
                        median      0.0017364499999999999999
                            sd     1.2695759572042592489e-05
P-values:
      0.0044863621347049854507        0.51214074421369390607        0.99932657992069730805
                        median        0.51904296296171698971
                            sd        0.28571274864247577481
ks:         0.3421826524930107568
real	1m49.499s
user	1m49.462s
sys	0m0.029s


c date                                  "8.1.2021"
c machine_name                          "csltok2"
c bogomips                              5799.77
c command-line                          "./TimingLSRG" "4" "1e7" "jm"
c N                                     4
c T                                     10000000
c gen-option                            jm-only
c num_e-seeds                           15
c  e-seeds                              1609092523835210350 1 0 1609092786237186306 0 3 1 0 4 4 0 0 0 10000000 0
N=4, reduced=0, L(N)=576
T=10000000, found=576
exact prob=L(N)/T = 0.0017361111111111111111
frequency statistics:
     0.00055379999999999999998      0.0017361111111111111113      0.0021671000000000000001
                        median                     0.0021154
                            sd      0.0006691426282079360655
p-value statistics:
   3.2337927138938901998e-1754    3.6193153064604971872e-150    2.0746912764077813203e-147
                        median     7.500160563028696437e-196
                            sd    8.6445753211905786018e-149
ks:     5.2583805365546965049e-18
Comparison with uniform generator for the exact prob:
Frequencies:
                     0.0016978       0.001736111111111111111      0.0017818000000000000001
                        median      0.0017368499999999999999
                            sd     1.3271383328761821208e-05
P-values:
     0.00051938046563738816353        0.50114701239404882654        0.99932657992069730805
                        median        0.52590561174070686817
                            sd        0.28892996270289777316
ks:        0.65651923463565427464
real	3m24.155s
user	3m24.134s
sys	0m0.020s


c version                               "0.1.2"
c machine_name                          "csltok2"
c bogomips                              5799.77
c command-line                          "./TimingLSRG" "4" "1e7" "mj"
c N                                     4
c T                                     10000000
c gen-option                            ma+jm
c num_e-seeds                           15
c  e-seeds                              1609092523835210350 1 0 1609092786237186306 0 3 0 0 4 4 0 0 0 10000000 0
N=4, reduced=0, L(N)=576
T=10000000, found=576
exact prob=L(N)/T = 0.0017361111111111111111
frequency statistics:
     0.00055780000000000000001      0.0017361111111111111113                     0.0021683
                        median      0.0021162500000000000001
                            sd     0.00066965235225826255182
p-value statistics:
   2.1983018982821485317e-1742    2.2810448875618654533e-151    1.3138749326503452891e-148
                        median    5.3009196781022326105e-196
                            sd    5.4744788359552382921e-150
ks:     5.2583805365546965049e-18

Comparison with uniform generator for the exact prob:
Frequencies:
                     0.0016992      0.0017361111111111111118                     0.0017772
                        median      0.0017361500000000000001
                            sd     1.3065105792605763524e-05
P-values:
      0.0018015364580046877201        0.50511844565979244844        0.99932657992069730805
                        median        0.51060321577511626797
                            sd        0.29022599199245495755
ks:         0.9491387825291809931
real	3m41.374s
user	3m41.304s
sys	0m0.036s


We didn't expect the ma-form to be uniformly distributed (though one can
look into that, whether this can be improved).
The jm-version appears very similar to the ma+jm-version.


A) Non-uniform distributions for N=5

First T=10^7:

> time ./TimingLSRG 5 1e7 ma
c version                               "0.1.3"
c machine_name                          "csltok2"
c bogomips                              5799.77
c command-line                          "./TimingLSRG" "5" "1e7" "ma"
c N                                     5
c T                                     10000000
c gen-option                            ma-only
c num_e-seeds                           15
c  e-seeds                              1609092523835210350 1 0 1609092786237186306 0 3 2 0 4 5 0 0 0 10000000 0
N=5, reduced=0, L(N)=161280
T=10000000, found=161280
exact prob=L(N)/T = 6.2003968253968253968e-06
frequency statistics:
                       1.6e-06     6.2003968253968253646e-06                      1.42e-05
                        median     6.5999999999999999999e-06
                            sd     2.0799931273474561136e-06
p-value statistics:
     3.0150156274804762267e-24        0.15280260436400951437        0.99959790274704210641
                        median       0.022287493892994687504
                            sd        0.24607384748906350551
ks:                           nan
Comparison with uniform generator for the exact prob:
Frequencies:
                       3.2e-06     6.2003968253968245486e-06     9.9999999999999999999e-06
                        median     6.1999999999999999999e-06
                            sd     7.8747037419379595035e-07
P-values:
     1.3974962379774915775e-06        0.50150063935886159149        0.99959790274704210641
                        median        0.52511133986465211064
                            sd          0.290196271230939012
XXX


To be updated:

>  ./TimingLSRG 5 1e7 jm > TLSRG_5_1e7_jm &
9990
XXX

c command-line                          "./TimingLSRG" "5" "1e7" "jm"
N=5, reduced=0, L(N)=161280
T=10000000, found=161280
exact prob=L(N)/T = 6.2004e-06
frequency statistics:
  2.9e-06 6.2004e-06 1.25e-05; 9.92024e-07
p-value statistics:
  1.24144e-15 0.452215 0.999598; 0.305323

Comparison with uniform generator for the exact prob:
Frequencies:
  2.8e-06 6.2004e-06 1.01e-05; 7.86561e-07
P-values:
  7.33196e-07 0.501601 0.999598; 0.290138


>  ./TimingLSRG 5 1e7 mj > TLSRG_5_1e7_mj &
10447
XXX

c command-line                          "./TimingLSRG" "5" "1e7"
N=5, reduced=0, L(N)=161280
T=10000000, found=161280
exact prob=L(N)/T = 6.2004e-06
frequency statistics:
  2.8e-06 6.2004e-06 1.18e-05; 9.92397e-07
p-value statistics:
  1.14957e-12 0.452211 0.999598; 0.305133

Comparison with uniform generator for the exact prob:
Frequencies:
  2.7e-06 6.2004e-06 1e-05; 7.88884e-07
P-values:
  1.3975e-06 0.499851 0.999598; 0.289887


The very low p-values for the uniform generator possibly come from
the approximate computation.


T=10^8:

> ./TimingLSRG 5 1e8 ma > TLSRG_5_1e8_ma &
c version                               "0.1.4"
c command-line                          "./TimingLSRG" "5" "1e8" "ma"
c N                                     5
c T                                     100000000
c gen-option                            ma-only
c num_e-seeds                           15
c  e-seeds                              1609092523835210350 1 0 1609092786237186306 0 3 2 0 4 5 0 0 0 100000000 0
N=5, reduced=0, L(N)=161280
T=100000000, found=161280
exact prob=L(N)/T = 6.2003968253968253968e-06
frequency statistics:
N=161280
     3.0299999999999999999e-06     6.2003968253968252144e-06                     1.087e-05
                        median     7.1000000000000000001e-06
                            sd     1.9413662402755900537e-06
p-value statistics:
N=161280
     1.8284955706186279001e-78      0.0022881257976435608101        0.99872845732415639375
                        median     2.9100598118705413468e-10
                            sd       0.021669236273706412829
ks:                           nan
Comparison with uniform generator for the exact prob:
Frequencies:
N=161280
     5.0900000000000000002e-06     6.2003968253968256868e-06     7.3099999999999999999e-06
                        median     6.1999999999999999999e-06
                            sd     2.4898773982122524146e-07
P-values:
N=161280
     8.2215454151109295836e-06        0.49991049389422723142        0.99872845732415639375
                        median        0.49579362993827710143
                            sd         0.2888142334645329614
ks:    -6.3208986655904908503e-16


> ./TimingLSRG 5 1e8 jm > TLSRG_5_1e8_jm &
10496
XXX

c command-line                          "./TimingLSRG" "5" "1e8" "jm"
N=5, reduced=0, L(N)=161280
T=100000000, found=161280
exact prob=L(N)/T = 6.2004e-06
frequency statistics:
  4.91e-06 6.2004e-06 9.19e-06; 6.52214e-07
p-value statistics:
  3.29694e-33 0.356737 0.998728; 0.309315
Comparison with uniform generator for the exact prob:
Frequencies:
  5.14e-06 6.2004e-06 7.48e-06; 2.48618e-07
P-values:
  2.76408e-07 0.501044 0.998728; 0.288944
real	47m27.973s
user	47m27.832s
sys	0m0.017s


> ./TimingLSRG 5 1e8 mj > TLSRG_5_1e8_mj &
c version                               "0.1.4"
c command-line                          "./TimingLSRG" "5" "1e8" "mj"
c N                                     5
c T                                     100000000
c gen-option                            ma+jm
c num_e-seeds                           15
c  e-seeds                              1609092523835210350 1 0 1609092786237186306 0 3 0 0 4 5 0 0 0 100000000 0
N=5, reduced=0, L(N)=161280
T=100000000, found=161280
exact prob=L(N)/T = 6.2003968253968253968e-06
frequency statistics:
N=161280
                      4.92e-06     6.2003968253968255325e-06     8.9699999999999999999e-06
                        median                      6.03e-06
                            sd     6.5274924011133801204e-07
p-value statistics:
N=161280
     9.7312499423632069483e-29        0.35704697196455171249        0.99872845732415639375
                        median         0.2956771210371766127
                            sd        0.30953656997442864234
ks:                           nan
Comparison with uniform generator for the exact prob:
Frequencies:
N=161280
                      5.18e-06     6.2003968253968256797e-06     7.3499999999999999999e-06
                        median     6.1999999999999999999e-06
                            sd     2.4932385954666609912e-07
P-values:
N=161280
     3.8973250525111845882e-06        0.49969993247857207272        0.99872845732415639375
                        median        0.49579362993827710143
                            sd        0.28872582024371673415
ks:    -6.3208986655904908503e-16



T=10^9:

> ./TimingLSRG 5 1e9 ma > TLSRG_5_1e9_ma &
c version                               "0.1.4"
c command-line                          "./TimingLSRG" "5" "1e9" "ma"
c N                                     5
c T                                     1000000000
c gen-option                            ma-only
c num_e-seeds                           15
c  e-seeds                              1609092523835210350 1 0 1609092786237186306 0 3 2 0 4 5 0 0 0 1000000000 0
N=5, reduced=0, L(N)=161280
T=1000000000, found=161280
exact prob=L(N)/T = 6.2003968253968253968e-06
frequency statistics:
N=161280
                     3.556e-06      6.200396825396825475e-06                    1.0051e-05
                        median     7.1340000000000000001e-06
                            sd     1.9265136768651740543e-06
p-value statistics:
N=161280
    8.7149034140255481879e-522     4.7072877216931942928e-17     6.6273266244235425538e-12
                        median     1.8119329153112732948e-71
                            sd     1.6551204153410037301e-14
ks:                           nan
Comparison with uniform generator for the exact prob:
Frequencies:
N=161280
                      5.85e-06     6.2003968253968253819e-06     6.5489999999999999999e-06
                        median     6.1999999999999999999e-06
                            sd     7.8987123007916514821e-08
P-values:
N=161280
     8.5904072074087676233e-06        0.49800756609593707817        0.99597904432025106941
                        median        0.49769512755813000439
                            sd        0.28837258785995068677
ks:     1.5938891793107305694e-08


> ./TimingLSRG 5 1e9 jm > TLSRG_5_1e9_jm &
c version                               "0.1.4"
c command-line                          "./TimingLSRG" "5" "1e9" "jm"
c N                                     5
c T                                     1000000000
c gen-option                            jm-only
c num_e-seeds                           15
c  e-seeds                              1609092523835210350 1 0 1609092786237186306 0 3 1 0 4 5 0 0 0 1000000000 0
N=5, reduced=0, L(N)=161280
T=1000000000, found=161280
exact prob=L(N)/T = 6.2003968253968253968e-06
frequency statistics:
N=161280
     5.6649999999999999998e-06     6.2003968253968254857e-06     8.2899999999999999997e-06
                        median     6.0030000000000000002e-06
                            sd     6.0918474297545231774e-07
p-value statistics:
N=161280
    3.6071387216565386331e-155       0.050393777220291410684        0.99597904432025106941
                        median      0.0049286382018155028455
                            sd        0.11935726514878531074
ks:                           nan
Comparison with uniform generator for the exact prob:
Frequencies:
N=161280
     5.8709999999999999998e-06     6.2003968253968253315e-06     6.5829999999999999999e-06
                        median     6.1999999999999999999e-06
                            sd     7.9014260819627510058e-08
P-values:
N=161280
     1.1802497924289760923e-06        0.49915677695008649214        0.99597904432025106941
                        median        0.49769512755813000439
                            sd        0.28937779192136546855
ks:     5.2392240292452611685e-05


> ./TimingLSRG 5 1e9 mj > TLSRG_5_1e9_mj &
c version                               "0.1.4"
c command-line                          "./TimingLSRG" "5" "1e9" "mj"
c N                                     5
c T                                     1000000000
c gen-option                            ma+jm
c num_e-seeds                           15
c  e-seeds                              1609092523835210350 1 0 1609092786237186306 0 3 0 0 4 5 0 0 0 1000000000 0
N=5, reduced=0, L(N)=161280
T=1000000000, found=161280
exact prob=L(N)/T = 6.2003968253968253968e-06
frequency statistics:
N=161280
     5.6800000000000000001e-06      6.200396825396825444e-06                     8.294e-06
                        median     6.0030000000000000002e-06
                            sd     6.0877236510531349098e-07
p-value statistics:
N=161280
    9.3394701392050867017e-156       0.050970938744397739336        0.99597904432025106941
                        median      0.0049286382018155028455
                            sd        0.12202591296734382098
ks:                           nan
Comparison with uniform generator for the exact prob:
Frequencies:
N=161280
     5.8189999999999999999e-06     6.2003968253968253728e-06     6.5319999999999999999e-06
                        median     6.1999999999999999999e-06
                            sd     7.8849690791397147834e-08
P-values:
N=161280
     1.2750458627921167109e-06        0.49972908566244429672        0.99597904432025106941
                        median        0.49769512755813000439
                            sd        0.28892020094283879443
ks:     0.00047994852657373769092


Seems clear that:
 1. jm is clearly better than ma
 2. ma+jm is slightly better than jm
 3. jm is not uniform.


The low ks-p-values for the uniform generator can have the following reasons:

1. The frequency-p-values can be highly accurate; for this the more precise
   two-sided binomial probabilities need to be computed.
2. The ks-value itself can be inaccurate; the new computation of ks-values is
   underway.
3. The frequency-p-values are not independent, and they are of a discrete nature.
   This is fundamental; the bigger T, the less weight should have this.
