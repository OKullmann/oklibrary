# Oliver Kullmann, 8.1.2021 (Swansea)

Testing generator LSRG


A) Non-uniform distributions for N=4

T = N^7:

Random> time ./TimingLSRG 4 1e7 ma
c version        0.10148                        "0.2.1"
c machine_name                          "csltok2"
c bogomips                              5799.77
c command-line                          "./TimingLSRG" "4" "1e7" "ma"
c N                                     4
c T                                     10000000
c gen-option                            ma-only
c num_e-seeds                           15
c  e-seeds                              1609092523835210350 1 0 1609092786237186306 0 3 2 0 4 4 0 0 0 10000000 0
N=4, reduced=0, L(N)=576
T=10000000, found=576
exact prob=L(N)/T = 0.0017361111111111111111
frequency statistics:
N=576
     0.00093749999999999999998      0.0017361111111111111109      0.0025479999999999999999
                        median                    0.00172925
                            sd     0.00077162359056155813681
p-value statistics:
N=576
    1.6486458284489786069e-828     8.320211783362720547e-671    4.7724108435879807136e-668
                        median    2.8348512089861107719e-748
                            sd    1.9885075187367791728e-669
ks:                             1                             0
Comparison with uniform generator for the exact prob:
Frequencies:
N=576
                     0.0016987      0.0017361111111111111113                     0.0017702
                        median      0.0017364499999999999999
                            sd     1.2695759572042592489e-05
P-values:
N=576
      0.0044863621347049854507        0.51214074421369390607        0.99932657992069730805
                        median        0.51904296296171698971
                            sd        0.28571274864247577481
ks:       0.038804891581282612017        0.34218265249301159023
real	1m6.215s
user	1m6.212s
sys	0m0.000s


Random> time ./TimingLSRG 4 1e7 jm
c version                               "0.2.1"
c machine_name                          "csltok2"
c bogomips                              5799.77
c command-line                          "./TimingLSRG" "4" "1e7" "jm"
c N                                     4
c T                                     10000000
c gen-option                            jm-only
c num_e-seeds                           15
c  e-seeds                              1609092523835210350 1 0 1609092786237186306 0 3 1 0 4 4 0 0 0 10000000 0
N=4, reduced=0, L(N)=576
T=10000000, found=576
exact prob=L(N)/T = 0.0017361111111111111111
frequency statistics:
N=576
     0.00055379999999999999998      0.0017361111111111111113      0.0021671000000000000001
                        median                     0.0021154
                            sd      0.0006691426282079360655
p-value statistics:
N=576
   3.2337927138938901998e-1754    3.6193153064604971872e-150    2.0746912764077813203e-147
                        median     7.500160563028696437e-196
                            sd    8.6445753211905786018e-149
ks:                             1                             0
Comparison with uniform generator for the exact prob:
Frequencies:
N=576
                     0.0016978       0.001736111111111111111      0.0017818000000000000001
                        median      0.0017368499999999999999
                            sd     1.3271383328761821208e-05
P-values:
N=576
     0.00051938046563738816353        0.50114701239404882654        0.99932657992069730805
                        median        0.52590561174070686817
                            sd        0.28892996270289777316
ks:       0.030240726587910447267        0.65651923463565427464
real	2m42.294s
user	2m42.269s
sys	0m0.009s


c version                               "0.1.2"
c machine_name                          "csltok2"
c bogomips                              5799.77
c command-line                          "./TimingLSRG" "4" "1e7" "mj"
c N                                     4
c T                                     10000000
c gen-option                            ma+jm
c num_e-seeds                           15
c  e-seeds                              1609092523835210350 1 0 1609092786237186306 0 3 0 0 4 4 0 0 0 10000000 0
N=4, reduced=0, L(N)=576
T=10000000, found=576
exact prob=L(N)/T = 0.0017361111111111111111
frequency statistics:
     0.00055780000000000000001      0.0017361111111111111113                     0.0021683
                        median      0.0021162500000000000001
                            sd     0.00066965235225826255182
p-value statistics:
   2.1983018982821485317e-1742    2.2810448875618654533e-151    1.3138749326503452891e-148
                        median    5.3009196781022326105e-196
                            sd    5.4744788359552382921e-150
ks:     5.2583805365546965049e-18

Comparison with uniform generator for the exact prob:
Frequencies:
                     0.0016992      0.0017361111111111111118                     0.0017772
                        median      0.0017361500000000000001
                            sd     1.3065105792605763524e-05
P-values:
      0.0018015364580046877201        0.50511844565979244844        0.99932657992069730805
                        median        0.51060321577511626797
                            sd        0.29022599199245495755
ks:         0.9491387825291809931
real	3m41.374s
user	3m41.304s
sys	0m0.036s


T = N^8:

> time ./TimingLSRG 4 1e8 ma
c version                               "0.2.0"
c machine_name                          "csltok2"
c bogomips                              5799.77
c command-line                          "./TimingLSRG" "4" "1e8" "ma"
c N                                     4
c T                                     100000000
c gen-option                            ma-only
c num_e-seeds                           15
c  e-seeds                              1609092523835210350 1 0 1609092786237186306 0 3 2 0 4 4 0 0 0 100000000 0
N=4, reduced=0, L(N)=576
T=100000000, found=576
exact prob=L(N)/T = 0.0017361111111111111111
frequency statistics:
N=576
                    0.00095392      0.0017361111111111111109      0.0025211300000000000001
                        median                   0.001732835
                            sd     0.00077216818003929562842
p-value statistics:
N=576
                             0                             0                             0
                        median                             0
                            sd                             0
ks:                             1                             0
Comparison with uniform generator for the exact prob:
Frequencies:
N=576
                    0.00172127      0.0017361111111111111108                    0.00175087
                        median                   0.001736165
                            sd     4.2285014076608005756e-06
P-values:
N=576
     0.00036390808136651942144        0.51400602891911520122        0.99829636807407043841
                        median        0.51120004707591714738
                            sd        0.29710468547604962245
ks:       0.043374653629060823173        0.22211930176909405499
real	11m5.436s
user	11m5.297s
sys	0m0.032s


Random> time ./TimingLSRG 4 1e8 jm
c version                               "0.2.0"
c machine_name                          "csltok2"
c bogomips                              5799.77
c command-line                          "./TimingLSRG" "4" "1e8" "jm"
c N                                     4
c T                                     100000000
c gen-option                            jm-only
c num_e-seeds                           15
c  e-seeds                              1609092523835210350 1 0 1609092786237186306 0 3 1 0 4 4 0 0 0 100000000 0
N=4, reduced=0, L(N)=576
T=100000000, found=576
exact prob=L(N)/T = 0.0017361111111111111111
frequency statistics:
N=576
     0.00057327999999999999998      0.0017361111111111111113      0.0021339000000000000001
                        median      0.0021199250000000000001
                            sd     0.00066873570622635937775
p-value statistics:
N=576
                             0   2.3290119737550324145e-1769   1.3365080887562992097e-1766
                        median   7.1059197997322521706e-1889
                            sd   5.5687669058576987286e-1768
ks:                             1                             0
Comparison with uniform generator for the exact prob:
Frequencies:
N=576
                    0.00172283      0.0017361111111111111111                    0.00175006
                        median                     0.0017363
                            sd     4.2340906500511112164e-06
P-values:
N=576
     0.00080624128391721302579        0.47763249420705373684        0.99829636807407043841
                        median        0.45793917321347582777
                            sd        0.27743648999085846688
ks:        0.05121696347755252455       0.094079268167095019915
real	27m4.842s
user	27m4.476s
sys	0m0.060s


Random> time ./TimingLSRG 4 1e8
c version                               "0.2.0"
c machine_name                          "csltok2"
c bogomips                              5799.77
c command-line                          "./TimingLSRG" "4" "1e8"
c N                                     4
c T                                     100000000
c gen-option                            ma+jm
c num_e-seeds                           15
c  e-seeds                              1609092523835210350 1 0 1609092786237186306 0 3 0 0 4 4 0 0 0 100000000 0
N=4, reduced=0, L(N)=576
T=100000000, found=576
exact prob=L(N)/T = 0.0017361111111111111111
frequency statistics:
N=576
     0.00057374999999999999998      0.0017361111111111111111      0.0021355099999999999999
                        median      0.0021197000000000000001
                            sd     0.00066886422964967280542
p-value statistics:
N=576
                             0   1.1004927196559439588e-1688   6.3388380652182372025e-1686
                        median   9.2077623102831352041e-1887
                            sd   2.6411825271742655027e-1687
ks:                             1                             0
Comparison with uniform generator for the exact prob:
Frequencies:
N=576
                    0.00172359      0.0017361111111111111102                    0.00174727
                        median                    0.00173598
                            sd     4.2026519761753103726e-06
P-values:
N=576
      0.0026325135850111939313        0.49874441956008786511        0.99829636807407043841
                        median        0.51369148535778497519
                            sd         0.2891003196492062518
ks:       0.021829087743363275072        0.94092208723618222409
real	34m20.417s
user	34m20.303s
sys	0m0.016s


Random> ./TimingLSRG 4 1e11 ma > TLSRG_4_1e11_ma &
XXX
Random> ./TimingLSRG 4 1e11 jm > TLSRG_4_1e11_jm &
XXX
Random> ./TimingLSRG 4 1e11 mj > TLSRG_4_1e11_mj &
XXX



We didn't expect the ma-form to be uniformly distributed (though one can
look into that, whether this can be improved).
The jm-version appears very similar to the ma+jm-version.



B) Non-uniform distributions for N=5

First T=10^7:

Random> time ./TimingLSRG 5 1e7 ma
c version                               "0.2.1"
c machine_name                          "csltok2"
c bogomips                              5799.77
c command-line                          "./TimingLSRG" "5" "1e7" "ma"
c N                                     5
c T                                     10000000
c gen-option                            ma-only
c num_e-seeds                           15
c  e-seeds                              1609092523835210350 1 0 1609092786237186306 0 3 2 0 4 5 0 0 0 10000000 0
N=5, reduced=0, L(N)=161280
T=10000000, found=161280
exact prob=L(N)/T = 6.2003968253968253968e-06
frequency statistics:
N=161280
                       1.6e-06     6.2003968253968253646e-06                      1.42e-05
                        median     6.5999999999999999999e-06
                            sd     2.0799931273474561136e-06
p-value statistics:
N=161280
     3.0150156274804762267e-24        0.15280260436400951437        0.99959790274704210641
                        median       0.022287493892994687504
                            sd        0.24607384748906350551
ks:        0.58391846062531716269                             0
Comparison with uniform generator for the exact prob:
Frequencies:
N=161280
                       3.2e-06     6.2003968253968245486e-06     9.9999999999999999999e-06
                        median     6.1999999999999999999e-06
                            sd     7.8747037419379595035e-07
P-values:
N=161280
     1.3974962379774915775e-06        0.50150063935886159149        0.99959790274704210641
                        median        0.52511133986465211064
                            sd          0.290196271230939012
ks:       0.050640082160746012041                             0
real	1m32.053s
user	1m32.019s
sys	0m0.032s


Random> time ./TimingLSRG 5 1e7 jm
c version                               "0.2.1"
c machine_name                          "csltok2"
c bogomips                              5799.77
c command-line                          "./TimingLSRG" "5" "1e7" "jm"
c N                                     5
c T                                     10000000
c gen-option                            jm-only
c num_e-seeds                           15
c  e-seeds                              1609092523835210350 1 0 1609092786237186306 0 3 1 0 4 5 0 0 0 10000000 0

N=5, reduced=0, L(N)=161280
T=10000000, found=161280
exact prob=L(N)/T = 6.2003968253968253968e-06
frequency statistics:
N=161280
     2.9000000000000000001e-06     6.2003968253968246743e-06                      1.25e-05
                        median     6.0999999999999999998e-06
                            sd     9.9202392872613672824e-07
p-value statistics:
N=161280
      1.241438455313841022e-15         0.4522146290456724105        0.99959790274704210641
                        median        0.44577196807659679766
                            sd        0.30532301916886749019
ks:        0.10119717279418038154                             0
Comparison with uniform generator for the exact prob:
Frequencies:
N=161280
     2.8000000000000000001e-06     6.2003968253968245916e-06                      1.01e-05
                        median     6.1999999999999999999e-06
                            sd     7.8656089003817817252e-07
P-values:
N=161280
     7.3319611227932026416e-07        0.50160129421782939175        0.99959790274704210641
                        median        0.52511133986465211064
                            sd        0.29013812876564044039
ks:       0.050844695255984107257                             0
real	4m48.418s
user	4m48.372s
sys	0m0.032s


Random> time ./TimingLSRG 5 1e7
c version                               "0.2.1"
c machine_name                          "csltok2"
c bogomips                              5799.77
c command-line                          "./TimingLSRG" "5" "1e7"
c N                                     5
c T                                     10000000
c gen-option                            ma+jm
c num_e-seeds                           15
c  e-seeds                              1609092523835210350 1 0 1609092786237186306 0 3 0 0 4 5 0 0 0 10000000 0
N=5, reduced=0, L(N)=161280
T=10000000, found=161280
exact prob=L(N)/T = 6.2003968253968253968e-06
frequency statistics:
N=161280
     2.8000000000000000001e-06     6.2003968253968246751e-06                      1.18e-05
                        median     6.0999999999999999998e-06
                            sd       9.92396688372657021e-07
p-value statistics:
N=161280
     1.1495693950526237317e-12        0.45221118502098258546        0.99959790274704210641
                        median        0.44577196807659679766
                            sd        0.30513316975233191223
ks:        0.10148239104814863549                             0
Comparison with uniform generator for the exact prob:
Frequencies:
N=161280
                       2.7e-06     6.2003968253968245878e-06     9.9999999999999999999e-06
                        median     6.1999999999999999999e-06
                            sd     7.8888372440704666804e-07
P-values:
N=161280
     1.3974962379774915775e-06        0.49985087610348817428        0.99959790274704210641
                        median        0.52511133986465211064
                            sd        0.28988705815277858804
ks:       0.050546309303827886557                             0
real	5m24.259s
user	5m24.233s
sys	0m0.020s


The very low p-values for the uniform generator possibly come from
the approximate computation.


To be updated:

T=10^8:

> ./TimingLSRG 5 1e8 ma > TLSRG_5_1e8_ma &
c version                               "0.1.4"
c command-line                          "./TimingLSRG" "5" "1e8" "ma"
c N                                     5
c T                                     100000000
c gen-option                            ma-only
c num_e-seeds                           15
c  e-seeds                              1609092523835210350 1 0 1609092786237186306 0 3 2 0 4 5 0 0 0 100000000 0
N=5, reduced=0, L(N)=161280
T=100000000, found=161280
exact prob=L(N)/T = 6.2003968253968253968e-06
frequency statistics:
N=161280
     3.0299999999999999999e-06     6.2003968253968252144e-06                     1.087e-05
                        median     7.1000000000000000001e-06
                            sd     1.9413662402755900537e-06
p-value statistics:
N=161280
     1.8284955706186279001e-78      0.0022881257976435608101        0.99872845732415639375
                        median     2.9100598118705413468e-10
                            sd       0.021669236273706412829
ks:                           nan
Comparison with uniform generator for the exact prob:
Frequencies:
N=161280
     5.0900000000000000002e-06     6.2003968253968256868e-06     7.3099999999999999999e-06
                        median     6.1999999999999999999e-06
                            sd     2.4898773982122524146e-07
P-values:
N=161280
     8.2215454151109295836e-06        0.49991049389422723142        0.99872845732415639375
                        median        0.49579362993827710143
                            sd         0.2888142334645329614
ks:    -6.3208986655904908503e-16


> ./TimingLSRG 5 1e8 jm > TLSRG_5_1e8_jm &
10496
XXX

c command-line                          "./TimingLSRG" "5" "1e8" "jm"
N=5, reduced=0, L(N)=161280
T=100000000, found=161280
exact prob=L(N)/T = 6.2004e-06
frequency statistics:
  4.91e-06 6.2004e-06 9.19e-06; 6.52214e-07
p-value statistics:
  3.29694e-33 0.356737 0.998728; 0.309315
Comparison with uniform generator for the exact prob:
Frequencies:
  5.14e-06 6.2004e-06 7.48e-06; 2.48618e-07
P-values:
  2.76408e-07 0.501044 0.998728; 0.288944
real	47m27.973s
user	47m27.832s
sys	0m0.017s


> ./TimingLSRG 5 1e8 mj > TLSRG_5_1e8_mj &
c version                               "0.1.4"
c command-line                          "./TimingLSRG" "5" "1e8" "mj"
c N                                     5
c T                                     100000000
c gen-option                            ma+jm
c num_e-seeds                           15
c  e-seeds                              1609092523835210350 1 0 1609092786237186306 0 3 0 0 4 5 0 0 0 100000000 0
N=5, reduced=0, L(N)=161280
T=100000000, found=161280
exact prob=L(N)/T = 6.2003968253968253968e-06
frequency statistics:
N=161280
                      4.92e-06     6.2003968253968255325e-06     8.9699999999999999999e-06
                        median                      6.03e-06
                            sd     6.5274924011133801204e-07
p-value statistics:
N=161280
     9.7312499423632069483e-29        0.35704697196455171249        0.99872845732415639375
                        median         0.2956771210371766127
                            sd        0.30953656997442864234
ks:                           nan
Comparison with uniform generator for the exact prob:
Frequencies:
N=161280
                      5.18e-06     6.2003968253968256797e-06     7.3499999999999999999e-06
                        median     6.1999999999999999999e-06
                            sd     2.4932385954666609912e-07
P-values:
N=161280
     3.8973250525111845882e-06        0.49969993247857207272        0.99872845732415639375
                        median        0.49579362993827710143
                            sd        0.28872582024371673415
ks:    -6.3208986655904908503e-16



T=10^9:

> ./TimingLSRG 5 1e9 ma > TLSRG_5_1e9_ma &
c version                               "0.1.4"
c command-line                          "./TimingLSRG" "5" "1e9" "ma"
c N                                     5
c T                                     1000000000
c gen-option                            ma-only
c num_e-seeds                           15
c  e-seeds                              1609092523835210350 1 0 1609092786237186306 0 3 2 0 4 5 0 0 0 1000000000 0
N=5, reduced=0, L(N)=161280
T=1000000000, found=161280
exact prob=L(N)/T = 6.2003968253968253968e-06
frequency statistics:
N=161280
                     3.556e-06      6.200396825396825475e-06                    1.0051e-05
                        median     7.1340000000000000001e-06
                            sd     1.9265136768651740543e-06
p-value statistics:
N=161280
    8.7149034140255481879e-522     4.7072877216931942928e-17     6.6273266244235425538e-12
                        median     1.8119329153112732948e-71
                            sd     1.6551204153410037301e-14
ks:                           nan
Comparison with uniform generator for the exact prob:
Frequencies:
N=161280
                      5.85e-06     6.2003968253968253819e-06     6.5489999999999999999e-06
                        median     6.1999999999999999999e-06
                            sd     7.8987123007916514821e-08
P-values:
N=161280
     8.5904072074087676233e-06        0.49800756609593707817        0.99597904432025106941
                        median        0.49769512755813000439
                            sd        0.28837258785995068677
ks:     1.5938891793107305694e-08


> ./TimingLSRG 5 1e9 jm > TLSRG_5_1e9_jm &
c version                               "0.1.4"
c command-line                          "./TimingLSRG" "5" "1e9" "jm"
c N                                     5
c T                                     1000000000
c gen-option                            jm-only
c num_e-seeds                           15
c  e-seeds                              1609092523835210350 1 0 1609092786237186306 0 3 1 0 4 5 0 0 0 1000000000 0
N=5, reduced=0, L(N)=161280
T=1000000000, found=161280
exact prob=L(N)/T = 6.2003968253968253968e-06
frequency statistics:
N=161280
     5.6649999999999999998e-06     6.2003968253968254857e-06     8.2899999999999999997e-06
                        median     6.0030000000000000002e-06
                            sd     6.0918474297545231774e-07
p-value statistics:
N=161280
    3.6071387216565386331e-155       0.050393777220291410684        0.99597904432025106941
                        median      0.0049286382018155028455
                            sd        0.11935726514878531074
ks:                           nan
Comparison with uniform generator for the exact prob:
Frequencies:
N=161280
     5.8709999999999999998e-06     6.2003968253968253315e-06     6.5829999999999999999e-06
                        median     6.1999999999999999999e-06
                            sd     7.9014260819627510058e-08
P-values:
N=161280
     1.1802497924289760923e-06        0.49915677695008649214        0.99597904432025106941
                        median        0.49769512755813000439
                            sd        0.28937779192136546855
ks:     5.2392240292452611685e-05


> ./TimingLSRG 5 1e9 mj > TLSRG_5_1e9_mj &
c version                               "0.1.4"
c command-line                          "./TimingLSRG" "5" "1e9" "mj"
c N                                     5
c T                                     1000000000
c gen-option                            ma+jm
c num_e-seeds                           15
c  e-seeds                              1609092523835210350 1 0 1609092786237186306 0 3 0 0 4 5 0 0 0 1000000000 0
N=5, reduced=0, L(N)=161280
T=1000000000, found=161280
exact prob=L(N)/T = 6.2003968253968253968e-06
frequency statistics:
N=161280
     5.6800000000000000001e-06      6.200396825396825444e-06                     8.294e-06
                        median     6.0030000000000000002e-06
                            sd     6.0877236510531349098e-07
p-value statistics:
N=161280
    9.3394701392050867017e-156       0.050970938744397739336        0.99597904432025106941
                        median      0.0049286382018155028455
                            sd        0.12202591296734382098
ks:                           nan
Comparison with uniform generator for the exact prob:
Frequencies:
N=161280
     5.8189999999999999999e-06     6.2003968253968253728e-06     6.5319999999999999999e-06
                        median     6.1999999999999999999e-06
                            sd     7.8849690791397147834e-08
P-values:
N=161280
     1.2750458627921167109e-06        0.49972908566244429672        0.99597904432025106941
                        median        0.49769512755813000439
                            sd        0.28892020094283879443
ks:     0.00047994852657373769092


Random> ./TimingLSRG 5 1e8 ma > TLSRG_5_1e8_ma &
XXX
Random> ./TimingLSRG 5 1e8 jm > TLSRG_5_1e8_jm &
XXX
Random> ./TimingLSRG 5 1e8 mj > TLSRG_5_1e8_mj &
XXX

Random> ./TimingLSRG 5 1e11 ma > TLSRG_5_1e11_ma &
XXX
Random> ./TimingLSRG 5 1e11 jm > TLSRG_5_1e11_jm &
XXX
Random> ./TimingLSRG 5 1e11 mj > TLSRG_5_1e11_mj &
XXX


Seems clear that:
 1. jm is clearly better than ma
 2. ma+jm is slightly better than jm
 3. jm is not uniform.


The low ks-p-values for the uniform generator can have the following reasons:

1. The frequency-p-values can be highly accurate; for this the more precise
   two-sided binomial probabilities need to be computed.
2. The ks-value itself can be inaccurate; the new computation of ks-values is
   underway.
3. The frequency-p-values are not independent, and they are of a discrete nature.
   This is fundamental; the bigger T, the less weight should have this.



C) N=6


Random> ./TimingLSRG 6 1e11 ma > TLSRG_6_1e11_ma &
XXX
Random> ./TimingLSRG 6 1e11 jm > TLSRG_6_1e11_jm &
XXX
Random> ./TimingLSRG 6 1e11 mj > TLSRG_6_1e11_mj &
XXX
