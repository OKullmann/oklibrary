# Counts for N >= 2:
# 0, 1, 2, 18, 0, 342480, >= 89, >= 6, >= 5
# >= 4

# https://oeis.org/A266166
# 0, 1, 2, 18, 0, 342480, 7850589120, 7188534981260640

#   hash=8119773079495343995


# gcMols:

# N=6:

# MOLS> ./gcMols 6 data/SpecsCollection/Euler/red "" satd dom - - "" 1 1 "t,2"
# best:
#  N       rt  pl  bt        bv   bo gcd      satc           t           ppc        flvs        gnds     gd st
#  6     satd dom enu maxdegdom  asc   1         0       1.139       5725499       64171      115311     15  0

# Only using "rred A" (instead of "red A"):
# MOLS> time ./gcMols 6 "@squares A B aux\nrred A B aux\nls A B aux\nrprod B aux A\n" "" satd dom enu maxdegdom "" 1 12 ""
#  N       rt  pl  bt        bv   bo gcd      satc           t           ppc        flvs        gnds     gd st
#  6     satd dom enu maxdegdom  asc   1         0     470.024     878498275    12873210    22174141     22  0
# real	0m49.590s user	7m50.031s sys	1m4.661s
# 12873210/64171 = 200.6079

# N=7:

# MOLS> ./gcMols 7 data/SpecsCollection/Euler/red "" count dom enu maxdegdom "" 1 16 ""
#  N       rt  pl  bt        bv   bo gcd      satc           t           ppc        flvs        gnds     gd st
#  7    count dom enu maxdegdom  asc   1    342480   92337.310  133424386240  1592675990  2963526787     28  0

# N=8:

# MOLS> ./gcMols 8 data/SpecsCollection/Euler/red "" count dom enu maxdegdom "" 1 12 "t,100"
#  N       rt  pl  bt        bv   bo gcd      satc           t           ppc        flvs        gnds     gd st
#  8    count dom enu maxdegdom  asc   1        89    1084.057    1782610678    19993226    36623522     37  1

# N=9:

# MOLS> time ./gcMols 9 data/SpecsCollection/Euler/red "" +count dom enu maxdegdom "" 1 16 ""
# aborted after 6 solutions found:
# real    5m19.051s user    72m49.562s sys     9m22.122

# N=10:

# MOLS> time ./gcMols 10 data/SpecsCollection/Euler/red "" +count dom enu maxdegdom "" 1 16 ""
# aborted after 5 solutions found:
# real    378m13.939s user    5467m54.713s sys     469m52.471s

# N=11:

# MOLS> time ./gcMols 11 data/SpecsCollection/Euler/red "" +count dom enu maxdegdom "" 1 16 ""
# aborted; 4 solutions found:
# real    16596m42.380s user    240618m5.459s sys     18521m37.061s




# rlaMols:

# N=6:

# MOLS> ./rlaMols 6 data/SpecsCollection/Euler "" satd dom - - "" "" 1 12 "nds,5000"
# Three runs succeeding:
#   N       rt  pl  bt        bv   bo    lar  gcd       satc           t        ppc     flvs     gnds    gd st      nds      lvs
#   6     satd dom bin    maxdeg  asc  relpr    1          0      43.572     327795     2475     7424    15  0     4949     2475
#      vals      props     elvals      prunes      mprune       probes    rounds      solc         t   qelvals   qprunes
#   293.100     10.246     13.713      68.944     185.711      297.589     1.806     0.000     0.070     0.044     0.297
#   116.000      0.000      0.000       0.000       0.000        2.000     1.000     0.000     0.000     0.000     0.000
#   418.000     72.000     86.000     579.000     395.000     1388.000     7.000     0.000     0.542     0.255     6.529
#    87.800     12.548     16.153      79.850     125.680      250.430     1.020     0.000     0.076     0.048     0.597
#   N       rt  pl  bt        bv   bo    lar  gcd       satc           t        ppc     flvs     gnds    gd st      nds      lvs
#   6     satd dom enu    maxdeg  asc  relpr    1          0      33.367     379690     2848     7263    10  0     4415     2848
#      vals      props     elvals      prunes      mprune       probes    rounds      solc         t   qelvals   qprunes
#   271.577     11.242     15.436      54.759     138.636      249.791     1.737     0.000     0.064     0.051     0.254
#   116.000      0.000      0.000       0.000       0.000        2.000     1.000     0.000     0.000     0.000     0.000
#   418.000     73.000     89.000     541.000     395.000     1388.000     7.000     0.000     0.569     0.261     6.529
#    93.471     12.780     16.296      79.866     121.331      261.772     1.029     0.000     0.083     0.047     0.605
#   N       rt  pl  bt        bv   bo    lar  gcd       satc           t        ppc     flvs     gnds    gd st      nds      lvs
#   6     satd dom enu maxdegdom  asc  relpr    1          0      36.049     338883     2639     7134    10  0     4495     2639
#      vals      props     elvals      prunes      mprune       probes    rounds      solc         t   qelvals   qprunes
#   273.021     11.302     15.152      63.652     148.948      272.045     1.836     0.000     0.070     0.049     0.301
#   116.000      0.000      0.000       0.000       0.000        2.000     1.000     0.000     0.000     0.000     0.000
#   418.000     73.000     89.000     766.000     395.000     1331.000     6.000     0.000     0.494     0.261     6.529
#    94.694     13.186     16.750      88.121     123.011      265.265     1.067     0.000     0.085     0.049     0.754
# So maxdeg with enum or possibly bin seems best.

# N=7:

# MOLS> time ./rlaMols 7 data/SpecsCollection/Euler/red "" +count dom enu maxdegdom "" "" 1 16 "" ""
#  N       rt  pl  bt        bv   bo    lar gcd     satc           t        ppc st      nds      lvs
#  7   +count dom enu maxdegdom  asc  relpr   1   342480 1753870.794 5465046037  0 66188195 34867187
#    mu0  qfppc  pprunes  pmprune  pprobes  rounds   solc     tr  pelvals      dp
#304.748  0.667   50.061  128.417  145.901   1.770  0.000  0.640    0.893  14.925
#186.000  0.000    4.630   25.097   32.174   1.000  0.000  0.000    0.000   0.000
#558.000  3.000  316.393  136.559  901.038  10.000  3.000  6.256   20.599  24.000
# 40.200  0.509   19.731    2.806   63.322   0.688  0.009  0.368    1.179   2.093
#    mu0  qfppc  pprunes  pmprune   pprobes  rounds    solc     tr  pelvals      dp
#242.569  1.878    1.368   36.074    65.695   1.157   0.010  0.221    8.014  16.975
#  8.000  1.031    0.000    0.000     0.909   1.000   0.000  0.000    0.581  10.000
#394.000  5.000   86.127  132.852  1129.286  12.000  15.000  6.179   28.409  25.000
# 18.721  0.414    2.962   25.480    58.162   0.469   0.166  0.236    3.154   1.959
# real    2234m21.780s user    29231m10.801s sys     4927m14.182s



# Only using "rred A" (instead of "red A"):
# N=6:
# MOLS> ./rlaMols 6 "@squares A B aux\nrred B aux\nls A B aux\nrprod B aux A\n" "" satd dom enu maxdeg "" "" 1 12 "" ""
#  N       rt  pl  bt        bv   bo    lar gcd     satc           t        ppc st      nds      lvs
#  6     satd dom enu    maxdeg  asc  relpr   1        0    7379.982   75504627  0  1426991   839972
#    mu0  qfppc  pprunes  pmprune  pprobes  rounds   solc     tr  pelvals      dp
#217.788  0.091   70.236  132.544   87.319   1.101  0.000  0.088    0.225  11.656
# 56.000  0.000    0.000   55.556   26.667   1.000  0.000  0.000    0.000   0.000
#360.000  2.071  656.522  157.143  305.051   4.000  0.000  0.466   20.354  17.000
# 26.508  0.293   54.138    4.130   27.139   0.339  0.000  0.034    1.204   1.775
#    mu0  qfppc  pprunes  pmprune  pprobes  rounds   solc     tr  pelvals      dp
#178.832  1.937    8.270   39.992   42.431   1.070  0.000  0.039    7.176  13.575
# 40.000  1.069    0.000    0.000    2.273   1.000  0.000  0.000    1.282   9.000
#232.000  4.000  550.000  160.000  328.319   4.000  0.000  0.565   30.093  18.000
# 30.116  0.473   43.356   28.822   37.641   0.269  0.000  0.043    4.025   1.571
# 839972 / 2848 = 294.934; 7379.982 / 33.367 = 221.1761



# laMols with wdL:

# N=6:

# Preparing complete RESTART:

# LVS/red_6_wdL> time BBSample S1 ./Ss1 "" 90 1 "lvs st nsel nsuel t aroundsi aroundsl apelvalsi apelvalsl adpi adpl aestlvs sddestlvs auestlvs sdduestlvs adm0 aw altausp aminp ameanp amaxp asddp minminp maxmaxp"
#BBS_S1_2E2FSs1_1697333756210445785.R
#real    1967m10.793s user    175321m45.467s sys     78m17.786s
# (So 160000 calls needed ~ 30h; all 4 intervals run from 0.0001 to 7,
#  with 20 points).
# Analysis:
#> summary(E$lvs)
#   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.
#   3144    8671    9214    8147    9370   10001
# plot(E$Xi, E$lvs):
# X1 >= 1
# X2 <= 1
# X3 <= 1.5
# X4 seems to have no influence.
#> F=E[E$lvs <= 3500,]
#> nrow(F)
#[1] 1520
# X1 <= 2
# LVS/red_6_wdL> time BBSample S2 ./Ss1 "" 90 1 "lvs st nsel nsuel t aroundsi aroundsl apelvalsi apelvalsl adpi adpl aestlvs sddestlvs auestlvs sdduestlvs adm0 aw altausp aminp ameanp amaxp asddp minminp maxmaxp"
#BBS_S2_2E2FSs1_1697454012021779713.R
#real    49m5.454s user    4096m52.935s sys     2m39.711s
# Viewing the cases lvs<=3500 leads to S3.
# LVS/red_6_wdL> time BBSample S3 ./Ss1 "" 90 1 "lvs st nsel nsuel t aroundsi aroundsl apelvalsi apelvalsl adpi adpl aestlvs sddestlvs auestlvs sdduestlvs adm0 aw altausp aminp ameanp amaxp asddp minminp maxmaxp"
#BBS_S3_2E2FSs1_1697458387353262333.R
#real    72m27.056s user    6455m4.850s sys     4m16.250s
#> summary(E$lvs)
#   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.
#   3072    3216    3264    3293    3336    4596
# Viewing the cases lvs<=3100 leads to S4:
# LVS/red_6_wdL> time BBSample S4 ./Ss1 0 90 1 "lvs st nsel nsuel t aroundsi aroundsl apelvalsi apelvalsl adpi adpl aestlvs sddestlvs auestlvs sdduestlvs adm0 aw altausp aminp ameanp amaxp asddp minminp maxmaxp"
#BBS_S4_2E2FSs1_1697485480370333342.R
#real    35m16.951s user    3139m11.671s sys     2m5.422s
# Final refinement:
# plot(E$i, E$lvs) suggests:
# X1 >= 1.6
# X2 <= 0.04
# 1.0 <= X3 <= 1.07
#> F=E[E$lvs<=3072,]
# summary(F)
# has min/max:
# X1 : 1.611 1.800
# X2 : 0.000100 0.036905 # same as S4
# X3 : 1.005 1.067 # same as S4
# Remark: X1, X2, X3 have a strong negative linear correlation with nsel (F)
# as well as with altausp, while nsuel is constant (F).
# One would assume that all minimum runs have the same underlying
# branching tree?
# LVS/red_6_wdL> time BBSample S5 ./Ss1 0 90 1 "lvs st nsel nsuel t aroundsi aroundsl apelvalsi apelvalsl adpi adpl aestlvs sddestlvs auestlvs sdduestlvs adm0 aw altausp aminp ameanp amaxp asddp minminp maxmaxp"
#BBS_S5_2E2FSs1_1697532544281858318.R
#real    281m7.346s user    25181m42.433s sys     16m43.487s
#> summary(E$lvs)
#   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.
#   3072    3144    3192    3194    3216    3336
# Kind of "final evaluation", to obtain a reasonable fine grid to compare
# different heuristics:
# LVS/red_6_wdL> time BBSample Sfinal ./Ssfinal "" 120 1 "lvs st nsel nsuel t aroundsi aroundsl apelvalsi apelvalsl adpi adpl aestlvs sddestlvs auestlvs sdduestlvs adm0 aw altausp aminp ameanp amaxp asddp minminp maxmaxp"
#BBS_Sfinal_2E2FSsfinal_1699707614252467479.R
# real    7876m17.209s user    940196m23.072s sys     851m5.059s


# New distance wdL-degm:
# LVS/red_6_wdLdegm> time BBSample S1 ./Ss1 "" 128 1 "lvs st nsel nsuel t aroundsi aroundsl apelvalsi apelvalsl adpi adpl aestlvs sddestlvs auestlvs sdduestlvs adm0 aw altausp aminp ameanp amaxp asddp minminp maxmaxp"
#BBS_S1_2E2FSs1_1697600303885103870.R
#real    1101m8.319s user    139050m12.097s sys     66m59.081s
#> summary(E$lvs)
#   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.
#   3068    5053    8868    7566    9006   10001
# Viewing plot(E$Xi, E$lvs) suggests:
# 1 <= X1 <= 4
# X2 <= 0.3
# 1 <= X3 <= 2
# X4 = 1
# Viewing F=E[E$lvs<=3500,] confirms this.
# LVS/red_6_wdLdegm> time BBSample S2 ./Ss1 "" 128 1 "lvs st nsel nsuel t aroundsi aroundsl apelvalsi apelvalsl adpi adpl aestlvs sddestlvs auestlvs sdduestlvs adm0 aw altausp aminp ameanp amaxp asddp minminp maxmaxp"
#BBS_S2_2E2FSs1_1697681620550562617.R
#real    97m1.457s user    12109m14.106s sys     6m31.218s
#> summary(E$lvs)
#   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.
#   2876    3304    3703    3957    4707    7411
# Viewing plot(E$Xi, E$lvs):
# X1 >= 2.5
# 0.15 <= X2 <= 0.24
# 1.5 <= X3 <= 1.6
# From F=E[E$lvs<=2900,] (nrow=55, all lvs=2876) the summary:
# X1 : 2.448 4
# X2 : 0.1449 0.2380
# X3 : 1.517 1.552
# LVS/red_6_wdLdegm> time BBSample S3 ./Ss1 "" 128 1 "lvs st nsel nsuel t aroundsi aroundsl apelvalsi apelvalsl adpi adpl aestlvs sddestlvs auestlvs sdduestlvs adm0 aw altausp aminp ameanp amaxp asddp minminp maxmaxp"
#BBS_S3_2E2FSs1_1697699403302535178.R
#real    71m16.575s user    9023m25.310s sys     5m31.986s
#> summary(E$lvs)
#   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.
#   2876    2924    2972    3060    3020    4157
# It seems by X1 >= 3, X2 <= 0.16 we could eliminate the bad values (clearly a
# separate population, with lvs > 3600).
# Final refinement:
# LVS/red_6_wdLdegm> time BBSample S4 ./Ss1 0 128 1 "lvs st nsel nsuel t aroundsi aroundsl apelvalsi apelvalsl adpi adpl aestlvs sddestlvs auestlvs sdduestlvs adm0 aw altausp aminp ameanp amaxp asddp minminp maxmaxp"
#BBS_S4_2E2FSs1_1697706840869540098.R
#real    69m18.101s user    8846m3.253s sys     5m28.572s
#> summary(E$lvs)
#   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.
#   2972    2972    2972    2996    3020    3068
# It seems cutting off X1 < 3 was too aggressive (or the +-optimisation?) regarding
# the very best values (which possibly don't matter that much?).
# Nomad-optimisation yields no improvement:
# LVS/red_6_wdLdegm> nomad np_hack
# 1 2876          2.45       0.145      1.52
# A termination criterion is reached: No termination (all). Mesh minimum precision reached (Algo)
# Blackbox evaluations: 2682 Total model evaluations: 330808 Cache hits: 829 Total number of evaluations: 3511
# Kind of "final evaluation", to obtain a reasonable fine grid to compare
# different heuristics:
# LVS/red_6_wdLdegm> time BBSample Sfinal ./Ssfinal "" 120 1 "lvs st nsel nsuel t aroundsi aroundsl apelvalsi apelvalsl adpi adpl aestlvs sddestlvs auestlvs sdduestlvs adm0 aw altausp aminp ameanp amaxp asddp minminp maxmaxp"
#BBS_Sfinal_2E2FSsfinal_1700306892498532980.R
# real    7200m41.966s user    859597m19.698s sys     817m16.702s



# MOLS> time ./laMols 6 data/SpecsCollection/Euler/red "" satd "" enu wdL "" "" 1 1 "" "" ""
#   weights: 0 0 1 2 3 4 5
#  N       rt  pl lbt  dis   lbo    lar gcd     satc           t        ppc st      nds      lvs          nsel         nsuel
#  6     satd dom enu  wdL   asc  relpr   1        0      14.337     470836  0     6965     3868  1.146310e+00  1.655407e+00
#   mu0    qfppc  pprunes  pmprune  pprobes   rounds  solc         tr  pelvals      dp
#120.01  0.54122   165.95   142.11   102.56     1.68     0  0.0024958   4.0795  7.2945
#    12        0        0   31.977   8.7719        1     0          0        0       0
#   310      2.5      900      200   384.53        6     0    0.01388   35.385      11
#81.591  0.62704   188.02   52.391   70.758  0.90682     0   0.002624    7.291  1.7574
#   mu0    qfppc  pprunes  pmprune  pprobes  rounds  solc          tr  pelvals      dp
#48.243   2.0292   1.3496   6.0909   26.463  1.0199     0  0.00025848   20.023  8.7839
#     8   1.1429        0        0   2.4194       1     0           0   2.4194       5
#   191        5       45   117.88   174.86       2     0     0.00693       25      12
#64.933  0.39982    4.501   16.219   21.151  0.1397     0   0.0007886   8.1198  1.5363
#      estlvs       uestlvs
#8.950657e+03  1.446776e+04
#5.627191e+02  2.880000e+02
#1.491274e+05  1.866240e+05
#1.344266e+04  2.020429e+04
#   dm0        w  ltausp      minp     meanp     maxp       sdd         tb
#29.963   2.2486  1.9447   0.39398   0.46128  0.54351  0.069987  0.0017629
#     0        2       1  0.017661      0.25     0.25         0          0
#   164        4       7       0.5       0.5  0.87864    0.3856   0.007712
#53.833  0.50211  1.2445   0.14444  0.075069  0.10696   0.10277  0.0018318
#   weights: L -> 0 0 1 1.5849625007211561815 2 2.3219280948873623478 2.5849625007211561815
#  N       rt  pl lbt  dis   lbo    lar gcd     satc           t        ppc st      nds      lvs          nsel         nsuel
#  6     satd dom enu  wdL   asc  relpr   1        0      14.608     473448  0     7025     3892  1.148240e+00  2.456870e+00
#   mu0    qfppc  pprunes  pmprune  pprobes   rounds  solc         tr  pelvals      dp
#116.76  0.49649   185.11   148.78   93.893   1.5918     0  0.0022844   3.9005  7.7689
#    12        0        0   32.099   6.5574        1     0          0        0       0
#   310        3      900      200   308.79        5     0   0.012374     37.5      12
#82.226  0.61488   198.31   45.992   59.152  0.80366     0  0.0023712   7.8673  1.9182
#   mu0   qfppc  pprunes  pmprune  pprobes   rounds  solc          tr  pelvals      dp
#58.382  2.1007  0.84131   7.6482    25.27   1.0195     0  0.00028363   18.768  9.2518
#     8   1.125        0        0   2.5862        1     0           0   2.5862       5
#   182       5   68.182   107.82   177.14        2     0    0.006796       25      13
#68.476   0.547   3.4262   16.469   20.477  0.13839     0  0.00077637    8.598  1.7282
#      estlvs       uestlvs
#9.023427e+03  2.738494e+04
#7.165589e+02  2.880000e+02
#1.812501e+05  4.976640e+05
#1.825244e+04  6.136358e+04
#   dm0        w  ltausp      minp     meanp     maxp       sdd         tb
#20.816   2.2419  2.1047   0.37595   0.46268  0.56794  0.089457  0.0019777
#     0        2       1  0.010442      0.25     0.25         0    3.8e-05
#   161        4       7       0.5       0.5  0.80439   0.30439   0.006281
#43.667  0.50559  1.1756   0.15611  0.074701  0.10438   0.10977  0.0018818
# real	0m28.997s user	0m28.949s sys	0m0.048s

# A bit of optimisation by hand:
# MOLS> time ./laMols 6 data/SpecsCollection/Euler "" satd "" enu wdL "" "" 1 6 "1.2,1.5,0.9,1" ""
#  N       rt  pl lbt  dis   lbo    lar gcd     satc           t        ppc     flvs     gnds    gd     larc      lvs   larbc
#  6     satd dom enu  wdL   asc  relpr   1        0      15.166     455794     3905    10636    10     6731     3905    2826
#      vals      props     elvals      prunes      mprune       probes    rounds      solc        tr   qelvals   qprunes
#   195.841      4.415      6.521      22.597      67.576       89.173     1.307     0.000     0.008     0.027     0.559
#   116.000      0.000      0.000       0.000       0.000        2.000     1.000     0.000     0.000     0.000     0.000
#   418.000     56.000     61.000     600.000     395.000     1344.000     9.000     0.000     0.159     0.217     9.000
#    83.592      8.138     10.287      52.665      96.410      148.862     0.721     0.000     0.014     0.035     1.270
#        mu         w      ltau        mind       meand        maxd         sdd         dp        tb
#   165.514     2.381     0.092      22.637      33.787      45.956      10.141      6.518     0.010
#    12.000     2.000     0.006       4.000       4.000       4.000       0.000      0.000     0.000
#   861.000     4.000     0.173     168.702     168.702     360.319     127.465     10.000     0.048
#   182.613     0.605     0.077      22.541      34.422      58.607      21.131      1.317     0.011
# real	0m2.800s user	0m15.173s sys	0m0.442s
# Further optimisiaton (one variable at a time, with "a") regarding nds:
# MOLS> time ./laMols 6 data/SpecsCollection/Euler "" satd "" enu wdL "" "" 1 6 "0.3,0.7,0.9,1" ""
#   weights: 0.30000000000000000001 0.69999999999999999999 0.89999999999999999998 1 -> 0 0 1 1.2311444133449162845 2 3.7321319661472296639 7.4642639322944593278
#  N       rt  pl lbt  dis   lbo    lar gcd     satc           t        ppc     flvs     gnds    gd st      nds      lvs    inds
#  6     satd dom enu  wdL   asc  relpr   1        0      14.440     473931     3752    10113    11  0     6361     3752    2609
#      vals      props     elvals      prunes      mprune       probes    rounds      solc        tr   qelvals   qprunes
#   197.980      4.491      6.666      21.381      69.573       92.310     1.351     0.000     0.008     0.028     0.392
#   116.000      0.000      0.000       0.000       0.000        2.000     1.000     0.000     0.000     0.000     0.000
#   418.000     65.000     72.000     365.000     395.000     1317.000     8.000     0.000     0.144     0.244     9.000
#    82.629      7.647      9.895      45.923      97.645      155.409     0.756     0.000     0.014     0.034     0.964
#        mu         w      ltau       mind      meand       maxd        sdd         dp        tb
#    64.946     2.438     0.121      9.439     13.124     16.903       -nan      6.498     0.009
#    12.000     2.000     0.012      3.538      4.000      4.000      0.000      0.000     0.000
#   265.000     4.000     0.173     55.849     55.849     75.130     35.600     10.000     0.045
#    58.902     0.638     0.058     11.064     12.671     17.750       -nan      1.366     0.010
# real	0m2.926s user	0m14.447s sys	0m0.227s

# New standard of optimisation (MAX_TIME=600, rep=100):
# TAU_red_6_wdL_ave> nomad np
# 300  2522.399051   5.1036     0.1004     1.000988   4.12
# Blackbox evaluations: 421 Total model evaluations: 14182 Cache hits:  34 Total number of evaluations: 455
# Reproduction:
# TAU_red_6_wdL_ave> ./TAUscan 6 ../red "" wdL hash "5.1036,0.1004,1.000988,4.12" 100 1 all
# 100 : 7.84615381788186725120e+02 2.52239905075203275198e+03 1.45323955521193176441e+04; 2.15939041273235808327e+03
# Testing:
# TAU_red_6_wdL_ave> ./laMols 6 ../red "" count dom enu wdL "" "" 1 1 "5.1036,0.1004,1.000988,4.12" "" ""
#   weights: 5.1035999999999999998 0.1004 1.0009879999999999999 4.1199999999999999999 -> 0 0 1 34.382439373357200608 36.860404555179445054 73.771312580047510396 1282.717715760716668
#  N       rt  pl lbt  dis   lbo    lar gcd     satc           t        ppc st      nds    inds      lvs     plvs
#  6    count dom enu  wdL   asc  relpr   1        0      10.313     401272  0     5397    2189     3208        0
#    mu0  qfppc  pprunes  pmprune  pprobes  rounds   solc     tr  pelvals      dp
#131.738  0.612  144.590  137.201  103.612   1.676  0.000  0.002    4.380   7.156
# 12.000  0.000    0.000   27.473    7.207   1.000  0.000  0.000    0.000   0.000
#310.000  3.000  900.000  200.000  332.990   5.000  0.000  0.011   39.773  11.000
# 81.657  0.680  169.132   51.505   65.817   0.811  0.000  0.002    8.150   1.654
#    mu0  qfppc  pprunes  pmprune  pprobes  rounds   solc     tr  pelvals      dp
# 74.310  1.953    1.349   12.157   32.601   1.052  0.000  0.000   17.794   8.404
#  8.000  1.080    0.000    0.000    3.008   1.000  0.000  0.000    2.256   5.000
#189.000  4.000   29.897  130.055  344.809   4.000  0.000  0.015   25.000  12.000
# 75.530  0.325    3.826   20.930   42.543   0.316  0.000  0.001    8.509   1.470
#   estlvs
# 7168.461
#  763.622
#55424.884
# 8116.539
#     mu1      w   ltau   minp  meanp   maxp    sdd     tb
#1226.892  2.465  0.073  0.378  0.436  0.512  0.059  0.002
#  12.000  2.000  0.001  0.050  0.250  0.250  0.000  0.000
#5163.000  4.000  0.173  0.500  0.500  0.897  0.397  0.007
#1300.520  0.761  0.083  0.162  0.100  0.105  0.094  0.002
# Good result, best weights yet.
# Optimising on ave+sd:
# TAU_red_6_wdL_avepsd> nomad np
# 296   4526.098554   2.09       0.0001     0.8345     5.07
# Blackbox evaluations: 402 Total model evaluations: 14999 Cache hits: 45 Total number of evaluations: 447
# Reproduction:
# TAU_red_6_wdL_avepsd> ./TAUscan 6 ../red "" wdL hash "2.09,0.0001,0.8345,5.07" 100 1 all
# 100 : 7.78530766064131046544e+02 2.57205284770010203799e+03 9.53815811033630565774e+03; 1.95404570665926208051e+03
# Testing:
# TAU_red_6_wdL_avepsd> ./laMols 6 ../red "" count dom enu wdL "" "" 1 1 "2.09,0.0001,0.8345,5.07" "" ""
#  N       rt  pl lbt  dis   lbo    lar gcd     satc           t        ppc st      nds    inds      lvs     plvs
#  6    count dom enu  wdL   asc  relpr   1        0      10.382     413143  0     5501    2237     3264        0
#    mu0  qfppc  pprunes  pmprune  pprobes  rounds   solc     tr  pelvals      dp
#133.968  0.646  137.304  133.823  103.478   1.707  0.000  0.002    4.610   7.224
# 12.000  0.000    0.000   27.473    7.207   1.000  0.000  0.000    0.000   0.000
#310.000  3.000  900.000  200.000  332.990   5.000  0.000  0.009   39.773  11.000
# 79.787  0.689  165.755   51.761   67.826   0.843  0.000  0.002    8.572   1.708
#    mu0  qfppc  pprunes  pmprune  pprobes  rounds   solc     tr  pelvals      dp
# 69.766  2.017    1.214   10.999   31.643   1.051  0.000  0.000   17.932   8.501
#  8.000  1.080    0.000    0.000    2.439   1.000  0.000  0.000    2.256   5.000
#189.000  4.000   29.897  130.055  344.809   4.000  0.000  0.009   25.000  12.000
# 73.648  0.448    3.562   20.647   41.898   0.309  0.000  0.001    8.673   1.524
#   estlvs
# 8009.069
#  778.531
#65518.625
#11913.403
#    mu1      w   ltau   minp  meanp   maxp    sdd     tb
#152.054  2.459  0.089  0.364  0.437  0.532  0.075  0.002
# 12.000  2.000  0.006  0.042  0.250  0.250  0.000  0.000
#545.000  4.000  0.173  0.500  0.500  0.860  0.360  0.006
#143.418  0.756  0.072  0.173  0.099  0.115  0.109  0.002
# Similar to above.

# Alternative optimisation on max (MAX_TIME=600, rep=100)::
# TAU_red_6_wdL_max> nomad np
# 235  9861.8524     3.19       0.0103     0.0335     5.5113
# Blackbox evaluations: 414 Total model evaluations: 37704 Cache hits: 97 Total number of evaluations: 511
# Reproduction:
# TAU_red_6_wdL_max> time ./TAUscan 6 ../red "" wdL hash "3.19,0.0103,0.0335,5.5113" 100 1 all
# 100 : 4.94365315449992619889e+02 2.96020008781907699547e+03 9.86185239964791143574e+03; 2.15253276501522312758e+03
# real    0m12.571s user    0m12.308s sys     0m0.269s
# TAU_red_6_wdL_max> time ./laMols 6 ../red "" count dom enu wdL "" "" 1 1 "3.19,0.0103,0.0335,5.5113" "" ""
#  N       rt  pl lbt  dis   lbo    lar gcd     satc           t        ppc st      nds    inds      lvs     plvs
#  6    count dom enu  wdL   asc  relpr   1        0      20.016     461585  0     6353    2677     3676        0
#    mu0  qfppc  pprunes  pmprune  pprobes  rounds   solc     tr  pelvals      dp
#124.370  0.556  166.246  142.036   96.383   1.602  0.000  0.004    3.828   7.005
# 12.000  0.000    0.000   28.750    6.557   1.000  0.000  0.000    0.000   0.000
#310.000  3.000  900.000  200.000  596.667   8.000  0.000  0.028   36.184  11.000
# 83.097  0.662  186.917   50.579   70.479   0.836  0.000  0.004    7.237   1.717
#    mu0  qfppc  pprunes  pmprune  pprobes  rounds   solc     tr  pelvals      dp
# 64.580  2.014    1.168   10.119   30.726   1.044  0.000  0.001   18.726   8.368
#  8.000  1.143    0.000    0.000    2.439   1.000  0.000  0.000    2.439   5.000
#189.000  5.000   61.111  130.168  286.034   3.000  0.000  0.017   25.000  12.000
# 72.914  0.402    3.893   19.496   33.534   0.240  0.000  0.002    8.302   1.534
#      estlvs
#1.724233e+04
#4.943653e+02
#7.826484e+05
#7.547792e+04
#    mu1      w   ltau   minp  meanp   maxp    sdd     tb
#276.363  2.373  0.083  0.380  0.447  0.526  0.067  0.003
# 12.000  2.000  0.003  0.004  0.250  0.250  0.000  0.000
#793.000  4.000  0.173  0.500  0.500  0.936  0.436  0.011
#280.306  0.671  0.078  0.160  0.091  0.106  0.100  0.003
# real    0m20.042s user    0m20.023s sys     0m0.016s
# Similar to above.

# Alternative optimisation on sd (MAX_TIME=600, rep=100)::
# TAU_red_6_wdL_sd> nomad np
# 384 2402.596516   5.256455   0.018174   0.473962   4.088964
# Blackbox evaluations: 431 Total model evaluations: 39027 Cache hits: 151 Total number of evaluations: 582
# Reproduction:
# TAU_red_6_wdL_sd> time ./TAUscan 6 ../red "" wdL hash "5.256455,0.018174,0.473962,4.088964" 100 1 all
# 100 : 6.56691320217026156092e+02 3.33220320364157519655e+03 1.75308438729909129492e+04; 3.19743969685985083840e+03
# real    0m12.877s user    0m12.576s sys     0m0.306s
# TAU_red_6_wdL_sd> time ./laMols 6 ../red "" count dom enu wdL "" "" 1 1 "5.256455,0.018174,0.473962,4.088964" "" ""
#  N       rt  pl lbt  dis   lbo    lar gcd     satc           t        ppc st      nds    inds      lvs     plvs
#  6    count dom enu  wdL   asc  relpr   1        0      18.141     408411  0     5941    2541     3400        0
#    mu0  qfppc  pprunes  pmprune  pprobes  rounds   solc     tr  pelvals      dp
#113.816  0.528  180.601  145.115   96.051   1.636  0.000  0.003    4.363   7.311
# 12.000  0.000    0.000   28.750    7.207   1.000  0.000  0.000    0.000   0.000
#310.000  3.000  900.000  200.000  423.626   7.000  0.000  0.021   39.773  11.000
# 85.101  0.664  173.794   52.378   73.443   0.939  0.000  0.004    8.238   1.585
#    mu0  qfppc  pprunes  pmprune  pprobes  rounds   solc     tr  pelvals      dp
# 56.676  1.931    1.214   10.835   36.901   1.075  0.000  0.001   20.215   8.653
#  8.000  1.080    0.000    0.000    3.008   1.000  0.000  0.000    2.256   5.000
#189.000  3.000   29.897  130.055  344.809   4.000  0.000  0.016   25.000  12.000
# 72.757  0.257    3.701   22.160   46.626   0.347  0.000  0.002    7.430   1.411
#      estlvs
#7.837459e+03
#6.566913e+02
#5.771244e+04
#9.018840e+03
#     mu1      w   ltau   minp  meanp   maxp    sdd     tb
#1025.430  2.338  0.082  0.401  0.453  0.511  0.049  0.002
#  12.000  2.000  0.001  0.045  0.250  0.250  0.000  0.000
#4118.000  4.000  0.173  0.500  0.500  0.933  0.433  0.011
#1224.596  0.672  0.084  0.150  0.089  0.094  0.085  0.003
# real    0m18.156s user    0m18.148s sys     0m0.008s
# Similar to above.

# Absolute optimisation on lvs:
# LVS/red_6_wdL> nomad np
# A termination criterion is reached: No termination (all). Mesh minimum precision reached (Algo)
# Best feasible solution: #43973 ( 3.172 0.1205 0.9897 0.6864 ) Evaluation OK f = 3096 h =   0
# Blackbox evaluations: 1143 Total model evaluations: 65480 Cache hits: 503 Total number of evaluations: 1646
# LVS_red_6_wdL> ./laMols 6 ../red "" count dom enu wdL "" "" 1 1 "3.172,0.1205,0.9897,0.6864" "" ""
#  N       rt  pl lbt  dis   lbo    lar gcd     satc           t        ppc st      nds    inds      lvs     plvs
#  6    count dom enu  wdL   asc  relpr   1        0       9.982     397370  0     5189    2093     3096        0
#    mu0  qfppc  pprunes  pmprune  pprobes  rounds   solc     tr  pelvals      dp
#137.773  0.625  128.513  134.512  105.505   1.692  0.000  0.002    4.573   7.125
# 12.000  0.000    0.000   27.473    6.306   1.000  0.000  0.000    0.000   0.000
#310.000  4.000  900.000  200.000  332.990   5.000  0.000  0.009   35.119  11.000
# 79.208  0.687  156.716   50.127   65.020   0.843  0.000  0.002    8.180   1.648
#    mu0  qfppc  pprunes  pmprune  pprobes  rounds   solc     tr  pelvals      dp
# 74.319  2.054    1.408   11.948   30.825   1.049  0.000  0.000   17.377   8.406
#  8.000  1.080    0.000    0.000    2.679   1.000  0.000  0.000    2.256   5.000
#189.000  5.000   30.374  130.055  344.809   4.000  0.000  0.009   25.000  12.000
# 74.294  0.534    3.881   20.861   40.606   0.290  0.000  0.001    8.764   1.426
#      estlvs
#6.106944e+03
#7.663355e+02
#5.476722e+04
#7.579415e+03
#     mu1      w   ltau   minp  meanp   maxp    sdd     tb
# 351.616  2.479  0.077  0.360  0.434  0.534  0.079  0.002
#  12.000  2.000  0.003  0.051  0.250  0.250  0.000  0.000
#1364.000  4.000  0.173  0.500  0.500  0.870  0.370  0.008
# 342.540  0.756  0.079  0.170  0.100  0.121  0.111  0.002

# Rerunning with version >= 0.99:

# First rerunning old values:
# MOLS> ./laMols 6 data/SpecsCollection/Euler/red "" count dom enu wdL "" "" 1 1 "3.172,0.1205,0.9897,0.6864" "" ""
#  N       rt  pl lbt  dis   lbo    lar gcd     satc           t        ppc st      nds      lvs          nsel         nsuel
#  6    count dom enu  wdL   asc  relpr   1        0      10.333     399082  0     5237     3096  9.638776e-01  1.767969e+00
#   mu0    qfppc  pprunes  pmprune  pprobes   rounds  solc         tr  pelvals      dp
#138.11  0.64085   128.19   134.08   105.05   1.6815     0  0.0023225    4.231   7.163
#    12        0        0   27.473   6.3063        1     0          0        0       0
#   310        4      900      200   332.99        5     0   0.019397   30.928      11
# 78.52  0.69659   155.45    50.28   65.893  0.81767     0  0.0021166   7.7114  1.6435
#   mu0    qfppc  pprunes  pmprune  pprobes   rounds  solc          tr  pelvals      dp
#74.947   2.0343   1.4162    12.42   31.085   1.0491     0  0.00045798   17.431  8.4677
#     8     1.08        0        0   2.7027        1     0           0   2.2556       5
#   189        5   30.374   130.05   344.81        4     0    0.009199       25      12
#74.797  0.50892   3.8847   21.054   40.448  0.29014     0   0.0011779   8.6926   1.432
#      estlvs       uestlvs
#5.972370e+03  1.277321e+04
#8.108037e+02  3.840000e+02
#3.441823e+04  1.474560e+05
#5.763847e+03  2.499981e+04
#   dm0        w  ltausp      minp     meanp     maxp       sdd         tb
#32.639   2.4456  2.7388   0.36596   0.43792  0.53145  0.075028  0.0017978
#     0        2       1  0.050992      0.25     0.25         0    3.5e-05
#   171        4   9.936       0.5       0.5  0.86486   0.36486   0.014467
#55.978  0.73463  1.9328   0.16616  0.097688  0.11759   0.10735  0.0016761
# Same number of leaves.

# Optimisation on LVS  (10000s):
# LVS/red_6_wdL$ nomad np
#1   3676          0.1        0.1        0.1        0.1      (Phase One)
#241 3416          0.059      0.15       0.0001     2.57
# A termination criterion is reached: No termination (all). Mesh minimum precision reached (Algo)
# Blackbox evaluations: 1124 Total model evaluations: 88866 Cache hits: 490 Total number of evaluations: 1614
# Strange failure of optimisation.
# Rerunning without "opportunism", and leaving more space for lvs:
# LVS/red_6_wdL$ nomad np
# 918 3354          5.027203   0.202203   0.820314   2.370683
# A termination criterion is reached: No termination (all). Mesh minimum precision reached (Algo)
# Blackbox evaluations:        1161 Total model evaluations:     77784 Cache hits:                  302 Total number of evaluations: 1463
# Again a failure: very incomplete scanning; so increasing
# the LH_SEARCH:
# LVS/red_6_wdL$ nomad np
# 983 3140          6.792821   0.153117   1.159172   5.802498
# A termination criterion is reached: No termination (all). Mesh minimum precision reached (Algo)
# Blackbox evaluations: 2090 Total model evaluations: 85038 Cache hits: 345 Total number of evaluations: 2435
# Close to the above value 3096, but not there yet.
# Another optimisation, with 3096 as starting point:
# LVS/red_6_wdL$ nomad np2
# no improvement found:
# Blackbox evaluations: 1683 Total model evaluations: 69137 Cache hits: 42 Total number of evaluations: 1725
#
# Rerunning with MAX_TIME=20000, LH_SEARCH=1000 10, MEGA_SEARCH_POLL=true, SPECULATIVE_SEARCH_MAX=10
# EVAL_OPPORTUNISTIC=yes
# LVS/red_6_wdL$ nomad np
# 1 3676          0.1        0.1        0.1        0.1      (Phase One)
# 203 3096          2.5001     0.0001     0.86       5.1
# 293 3072          2.5701     0.0201     0.87       5.19
# 902 3071          2.5701     0.0201     0.87       5.19
# A termination criterion is reached: No termination (all). Mesh minimum precision reached (Algo)
# Best feasible solution:     #118144 ( 2.5701 0.0201 0.87 5.19 ) Evaluation OK    f = 3071
# Blackbox evaluations: 1171 Total model evaluations: 68622 Cache hits: 570 Total number of evaluations: 1741
# Found the known best solution easily this time; perhaps LH_SEARCH was too high.
# MOLS> ./laMols 6 ../../red "" count dom enu wdL "" "" 1 1 "2.5701,0.0201,0.87,5.19" "" ""
#   weights: 2.5701 0.020099999999999999999 0.87 5.1900000000000000001 -> 0 0 1 5.9385058941123850937 6.0218217335341814598 11.005860175556927652 401.76275040629190619
#  N       rt  pl lbt  dis   lbo    lar gcd     satc           t        ppc st      nds      lvs          nsel         nsuel
#  6    count dom enu  wdL   asc  relpr   1        0       9.840     380593  0     5213     3072  9.973704e-01  1.731722e+00
#   mu0    qfppc  pprunes  pmprune  pprobes   rounds  solc         tr  pelvals      dp
# 131.1  0.58433   143.14   138.68   107.23   1.6857     0  0.0021832   4.6921  7.1406
#    12        0        0   27.473   6.3063        1     0          0        0       0
#   310        4      900      200   332.99        5     0   0.008757   39.773      11
#82.725  0.66255    174.1   51.044   67.424  0.87367     0  0.0020338    8.814   1.641
#   mu0    qfppc  pprunes  pmprune  pprobes   rounds  solc          tr  pelvals      dp
#73.322   1.9854   1.3383   12.262   32.925   1.0527     0  0.00046327   17.993   8.418
#     8     1.08        0        0   3.0075        1     0       2e-06   2.2556       5
#   189        5   32.258   130.05   344.81        4     0    0.008581       25      12
#75.768  0.42873   3.6615   20.687   41.171  0.30274     0   0.0011345   8.4067  1.4619
#      estlvs       uestlvs
#6.127865e+03  1.228450e+04
#8.189471e+02  3.840000e+02
#3.809268e+04  1.474560e+05
#6.115190e+03  2.486265e+04
#   dm0        w  ltausp      minp     meanp     maxp       sdd         tb
#30.644   2.4344  3.1433   0.37837   0.44072  0.51722   0.06208  0.0017111
#     0        2       1  0.053005      0.25     0.25         0    3.8e-05
#   171        4  11.453       0.5       0.5  0.86316   0.36316   0.006854
#54.223  0.74884  2.5118   0.16297  0.098232  0.10367  0.094051  0.0016574


# Optimisation on tau-probs (600s, rep=100):
# TAU/red_6_wdL_ave$ nomad np
# 800 2389.213469   0.202478   2.100818   0.090158   0.0001
# A termination criterion is reached: No termination (all). Mesh minimum precision reached (Algo)
# Blackbox evaluations: 977 Total model evaluations: 87118 Cache hits: 400 Total number of evaluations: 1377
# TAU/red_6_wdL_ave> time ./TAUscan 6 ../../red "" enu wdL hash "0.202478,2.100818,0.090158,0.0001" 100 1 all
# 100 : 2.62190673276673962916e+02 3.89583051353802562322e+03 1.75819593179287095825e+04; 4.22304958108537223715e+03
# real    0m7.120s user    0m6.965s sys     0m0.146s
# MOLS> ./laMols 6 ../../red "" count dom enu wdL "" "" 1 1 "0.202478,2.100818,0.090158,0.0001" "" ""
#  N       rt  pl lbt  dis   lbo    lar gcd     satc           t        ppc st      nds      lvs          nsel         nsuel
#  6    count dom enu  wdL   asc  relpr   1        0      13.807     426759  0     6155     3539  1.495407e+00  1.122871e+00
#   mu0    qfppc  pprunes  pmprune  pprobes  rounds  solc         tr  pelvals      dp
#139.75  0.73126   121.52   132.73   124.56  1.8234     0  0.0027962    4.419  6.3234
#    12        0   3.3123   29.834   6.1538       1     0    1.4e-05        0       0
#   310      2.5   729.41      200   648.69       8     0   0.018658    36.31       9
#83.511  0.66765    148.1   53.582   96.767  1.0132     0  0.0029087   7.4768  1.3787
#   mu0    qfppc  pprunes  pmprune  pprobes   rounds  solc          tr  pelvals      dp
#61.458   1.9131    2.463   10.732   35.065   1.0715     0  0.00049367   19.066  7.7762
#     8   1.0909        0        0      1.6        1     0       2e-06      1.6       4
#   226        4       50   138.51   325.86        3     0    0.009916       25      10
#75.787  0.30967   5.2462    23.88   41.242  0.30211     0   0.0012814   8.5032  1.1178
#      estlvs       uestlvs
#1.145306e+04  8.001108e+03
#2.621907e+02  3.200000e+02
#1.262590e+05  3.456000e+04
#1.817293e+04  7.494358e+03
#   dm0        w  ltausp      minp     meanp      maxp       sdd         tb
#40.359   2.3524  2.5655   0.39409   0.44652   0.51302  0.053088  0.0017752
#     0        2       1  0.012157       0.2      0.25         0    4.2e-05
#   183        5  11.916       0.5       0.5   0.82439   0.32439   0.008198
#63.281  0.60116  1.9659   0.15243  0.085516  0.081613  0.083498   0.001828
# Misguided search.
# Stronger optimisation on tau-probs (6000s, rep=1000):
# TAU/red_6_wdL_ave$ nomad np2
# 854 2880.585183   6.0801     0.17       1.08       2.2501
# A termination criterion is reached: No termination (all). Mesh minimum precision reached (Algo)
# Blackbox evaluations: 989 Total model evaluations: 86865 Cache hits: 402 Total number of evaluations: 1391
# TAU/red_6_wdL_ave> time ./TAUscan 6 ../../red "" enu wdL hash "6.0801,0.17,1.08,2.2501" 1000 10 all
# 1000 : 8.03038956849400439753e+02 2.94499383858335104125e+03 2.37420107597432020263e+04; 2.63415130910515469598e+03
# real    0m8.034s user    1m17.607s sys     0m1.392s
# MOLS> ./laMols 6 ../../red "" count dom enu wdL "" "" 1 1 "6.0801,0.17,1.08,2.2501" "" ""
#  N       rt  pl lbt  dis   lbo    lar gcd     satc           t        ppc st      nds      lvs          nsel         nsuel
#  6    count dom enu  wdL   asc  relpr   1        0      11.105     406206  0     5357     3168  9.852629e-01  1.844911e+00
#   mu0    qfppc  pprunes  pmprune  pprobes   rounds  solc         tr  pelvals      dp
#136.05  0.62146    136.5   135.36    105.4   1.6738     0  0.0023845   4.3248  7.2654
#    12        0        0   27.473   6.3063        1     0    1.3e-05        0       0
#   310        4      900      200   332.99        5     0   0.009581   30.928      11
#79.212  0.69105    170.3   50.488   65.029  0.81269     0  0.0021124   7.7497  1.7139
#   mu0    qfppc  pprunes  pmprune  pprobes   rounds  solc          tr  pelvals      dp
#74.653   2.0253   1.3751   12.429   31.071   1.0455     0  0.00046795   17.554  8.5366
#     8     1.08        0        0   2.7027        1     0       2e-06   2.2556       5
#   189        5   52.941   130.05   344.81        4     0    0.009385       25      12
#74.772  0.47257   3.8702   20.481   38.749  0.26563     0   0.0011707   8.5918   1.519
#      estlvs       uestlvs
#6.243314e+03  1.395091e+04
#8.030390e+02  3.840000e+02
#3.279788e+04  1.474560e+05
#5.945560e+03  2.525815e+04
#   dm0        w  ltausp      minp     meanp     maxp       sdd         tb
#32.088   2.4468  2.6701   0.37381   0.43928  0.52346  0.067723  0.0019689
#     0        2       1  0.053747      0.25     0.25         0    4.3e-05
#   171        4  9.5938       0.5       0.5   0.8694    0.3694   0.005285
#55.969  0.75978  1.8763   0.16223  0.099365  0.11456    0.1018  0.0018242
# Close to known optimum.
# Rerunning with maximum value 10 for weights:
# TAU/red_6_wdL_ave$ nomad np3
# 358 3207.693818   0.170088   0.499333   0.0001     1.050757
# A termination criterion is reached: No termination (all). Mesh minimum precision reached (Algo)
# Blackbox evaluations: 973 Total model evaluations: 86505 Cache hits: 424 Total number of evaluations: 1397
# TAU/red_6_wdL_ave$ ./laMols 6 ../../red "" count dom enu wdL "" "" 1 6 "0.170088,0.499333,0.0001,1.050757" "" ""
#   weights: 0.170088 0.499333 0.0001 1.050757 -> 0 0 1 1.1251271119200772599 1.590434546785483562 1.5905447911284141456 3.2949989374444896512
# N       rt  pl lbt  dis   lbo    lar gcd     satc           t        ppc st      nds      lvs          nsel         nsuel
# 6    count dom enu  wdL   asc  relpr   1        0      21.278     424529  0     6381     3572  1.877483e+00  1.195938e+00
#   mu0   qfppc  pprunes  pmprune  pprobes   rounds  solc        tr  pelvals      dp
#123.31  0.5646   145.84    139.5    105.3   1.6853     0   0.01881   4.8999  6.7497
#    12       0        0   31.977   9.1503        1     0         0        0       0
#   310  2.6667   845.45      200   505.65        7     0   0.19894   36.957      10
#83.274  0.6636   158.13   54.024   75.625  0.97691     0  0.022479   8.9072  1.4861
#   mu0    qfppc  pprunes  pmprune  pprobes   rounds  solc         tr  pelvals      dp
#49.351   1.9935  0.96629   6.7584   30.749   1.0381     0   0.002851   20.521  8.1848
#     8   1.1429        0        0   2.0202        1     0          0   2.0202       5
#   191        5   25.041   124.04   396.17        4     0      0.135       25      11
#68.302  0.33643   2.9849   16.287   36.001  0.27232     0  0.0097949   7.5755  1.2869
#      estlvs       uestlvs
#1.616309e+04  8.680918e+03
#3.406178e+02  3.240000e+02
#9.994633e+05  5.184000e+04
#7.281175e+04  9.088649e+03
#   dm0        w  ltausp       minp     meanp     maxp       sdd        tb
#35.056   2.2713  1.9739    0.40766   0.45795   0.5196  0.049793  0.012988
#     0        2       1  0.0013331       0.2  0.22857         0         0
#   174        5  6.2843        0.5       0.5  0.76195   0.31416  0.072471
#58.295  0.53286  1.1151    0.14759  0.077119  0.08438  0.085866  0.014841
# Very bad optimisation??
# Trying again, with doubled MAX_TIME=12000, LH_SEARCH=2000 10:
# TAU/red_6_wdL_ave$ nomad np4
# 363 3207.693818   0.170088   0.499333   0.0001     1.050757
# A termination criterion is reached: No termination (all). Mesh minimum precision reached (Algo)
# Blackbox evaluations: 973 Total model evaluations: 86505 Cache hits: 424 Total number of evaluations: 1397
# Exactly the same as before.
# Now with EVAL_OPPORTUNISTIC=no:
# TAU/red_6_wdL_ave$ nomad np5
# 463 3056.770822   1.998373   0.0001     0.150589   0.0001
# Blackbox evaluations: 1140 Total model evaluations: 100362 Cache hits: 358 Total number of evaluations: 1498
# Reproducing TAUscan (not exact):
# TAU/red_6_wdL_ave$ time ./TAUscan 6 ../../red "" enu wdL hash "1.998373,0.0001,0.150589,0.0001" 100 100 all
# 100 : 4.55143260313238629172e+02 2.95763420830345286694e+03 1.03465484409996945594e+04; 2.18814350929255342026e+03
# real    0m0.166s user    0m9.357s sys     0m0.346s
# Plotting the data shows a much higher spread: incline to a two-peaked mountain,
# followed by a softer decline, with a small peak halfway.
# Thus the TAUscan preditions should be worse than compared to basis
# (relatively speaking(!) -- the range of values here is much smaller).
# Running laMols:
# TAU/red_6_wdL_ave$ ./laMols 6 ../../red "" count dom enu wdL "" "" 1 6 "1.998373,0.0001,0.150589,0.0001" "" ""
# weights: 1.998373 0.0001 0.150589 0.0001 -> 0 0 1 3.9954915408352000698 3.9957684968032997075 4.4353931818938373693 4.435700630576944119
#  N       rt  pl lbt  dis   lbo    lar gcd     satc           t        ppc st      nds      lvs          nsel         nsuel
#  6    count dom enu  wdL   asc  relpr   1        0      20.114     398658  0     5809     3296  1.013948e+00  1.747883e+00
#  mu0    qfppc  pprunes  pmprune  pprobes  rounds  solc        tr  pelvals      dp
#119.67   0.4933   166.82   144.56   98.205  1.5838     0  0.016915   4.0933  7.0593
#    12        0        0   34.211   8.9109       1     0         0        0       0
#   310        4      900      200   332.99       5     0   0.11815   35.057      11
#84.966  0.64314   178.86   50.529   63.986  0.8457     0  0.019228   7.9122  1.6803
#   mu0    qfppc  pprunes  pmprune  pprobes   rounds  solc         tr  pelvals      dp
#61.715   2.0374   1.7543   10.831    33.87   1.0692     0  0.0039029   19.099  8.4964
#     8   1.1053        0        0    1.626        1     0          0    1.626       5
#   189        5     87.5   115.85   327.87        4     0   0.085417       25      12
#72.097  0.46616   5.8631   20.965   42.213  0.28638     0   0.010791   8.1657  1.4962
#      estlvs       uestlvs
#6.684586e+03  1.336559e+04
#4.551433e+02  3.840000e+02
#6.817574e+04  1.474560e+05
#9.872068e+03  2.199043e+04
#   dm0        w  ltausp     minp     meanp    maxp       sdd        tb
#26.021   2.3112   3.122  0.38482   0.45414  0.5397  0.071636  0.013989
#     0        2       1  0.04232      0.25    0.25         0         0
#   162        4  10.511      0.5       0.5  0.8556    0.3556  0.061594
#49.294  0.59878  2.4741  0.15576  0.083926  0.1107   0.10576  0.015114
# Improved result, but still away from known optimum; the problem is likely that
# the quality of the predictions is too bad.

# Optimisation on uni-prob (600s, rep=100):
# TAU/red_6_wdL_ave% nomad nprand
# 844 2241.72       6.46       0.723408   0.182324   2.177061
# A termination criterion is reached: No termination (all). Mesh minimum precision reached (Algo)
# Blackbox evaluations: 1149 Total model evaluations: 96131 Cache hits: 437 Total number of evaluations: 1586
# TAU/red_6_wdL_ave> time ./TAUscan 6 ../../red "" enu wdL hash "6.46,0.723408,0.182324,2.177061" 100 1 all
# 100 : 7.13294510786685100334e+02 3.65241791664981558529e+03 2.09198389906928397437e+04; 3.28346161494364241040e+03
# real    0m7.501s user    0m7.349s sys     0m0.144s
# MOLS> ./laMols 6 ../../red "" count dom enu wdL "" "" 1 1 "6.46,0.723408,0.182324,2.177061" "" ""
#  N       rt  pl lbt  dis   lbo    lar gcd     satc           t        ppc st      nds      lvs          nsel         nsuel
#  6    count dom enu  wdL   asc  relpr   1        0      12.760     449495  0     6937     3780  8.619671e-01  2.437915e+00
#   mu0    qfppc  pprunes  pmprune  pprobes   rounds  solc         tr  pelvals      dp
#112.85  0.51734   191.09   149.33   93.123   1.6037     0  0.0019505   3.9926   7.739
#    12        0        0   32.099   6.5574        1     0          0        0       0
#   310        3      900      200   308.79        5     0   0.010224     37.5      12
#82.809  0.62572   194.56   46.839   60.458  0.79552     0  0.0021201   7.9175  1.8805
#   mu0   qfppc  pprunes  pmprune  pprobes  rounds  solc          tr  pelvals      dp
#54.499  2.0117  0.77893   7.2969   26.399  1.0159     0  0.00025342   19.703  9.2582
#     8     1.2        0        0   2.6316       1     0           0   2.6316       5
#   182       5   68.182    116.2   176.57       2     0    0.006856       25      13
#69.157  0.3605    3.333    16.01   19.346   0.125     0  0.00066648   8.0215  1.7052
#      estlvs       uestlvs
#6.588492e+03  2.624617e+04
#6.964302e+02  2.880000e+02
#5.687110e+04  4.976640e+05
#6.519177e+03  6.203652e+04
#   dm0        w  ltausp      minp     meanp      maxp       sdd         tb
#21.005    2.197  1.9158   0.40301   0.46909   0.54724  0.067863  0.0017555
#     0        2       1  0.035034      0.25      0.25         0          0
#   165        4       7       0.5       0.5   0.79201   0.29201   0.007044
#43.315  0.45223  1.0974   0.13726  0.068407  0.097402   0.09782  0.0017405
# Misguided search (worse than tau-probs).
# Stronger optimisation on uni-probs (6000s, rep=1000):
# TAU/red_6_wdL_ave$ nomad np2rand
# 494 2895.936      5.671536   0.24052    1.298477   1.108753
# A termination criterion is reached: No termination (all). Mesh minimum precision reached (Algo)
# Blackbox evaluations: 1159 Total model evaluations: 96896 Cache hits: 368 Total number of evaluations: 1527
# TAU/red_6_wdL_ave> time ./TAUscan 6 ../../red "" enu wdL hash "5.671536,0.24052,1.298477,1.108753" 1000 10 all
# 1000 : 7.82762289126889517610e+02 3.42654401744920680439e+03 1.89522910878759684294e+04; 2.84561067436672469855e+03
# real    0m8.095s user    1m18.207s sys     0m1.456s
# MOLS> ./laMols 6 ../../red "" count dom enu wdL "" "" 1 1 "5.671536,0.24052,1.298477,1.108753" "" ""
#  N       rt  pl lbt  dis   lbo    lar gcd     satc           t        ppc st      nds      lvs          nsel         nsuel
#  6    count dom enu  wdL   asc  relpr   1        0      11.638     433313  0     5789     3408  8.784231e-01  1.867211e+00
#   mu0    qfppc  pprunes  pmprune  pprobes   rounds  solc         tr  pelvals      dp
#127.17  0.62939   154.18   139.78   109.43   1.7854     0  0.0024924   4.8581  7.2709
#    12        0        0   27.473   9.5238        1     0    1.3e-05        0       0
#   310      2.5      900      200   445.45        6     0   0.012559   36.111      11
#81.419  0.65904   175.18   50.185   78.612  0.97948     0  0.0025678   8.7721  1.6831
#   mu0    qfppc  pprunes  pmprune  pprobes   rounds  solc          tr  pelvals      dp
#66.424   2.0596   1.2751   9.4152   28.509   1.0367     0  0.00037105   17.958  8.5082
#     8     1.08        0        0   1.5152        1     0           0   1.5152       5
#   189        5   36.364   130.05   344.81        4     0    0.009436       25      12
#72.356  0.50255    4.079   19.092   37.132  0.27647     0   0.0011246   8.9005  1.5235
#      estlvs       uestlvs
#6.037705e+03  1.528992e+04
#7.827623e+02  3.840000e+02
#1.954536e+04  1.474560e+05
#4.401510e+03  2.560362e+04
#   dm0        w  ltausp      minp     meanp     maxp       sdd         tb
#31.476   2.4309  2.5558   0.37468    0.4425  0.52552  0.067595  0.0018233
#     0        2       1  0.031426      0.25     0.25         0    4.1e-05
#   170        4  10.323       0.5       0.5  0.87345   0.37345   0.007041
#54.364  0.76748  1.8343   0.16604  0.099298  0.10399  0.097708  0.0018075
# Similar picture; so here uni-probs seems clearly worse than tau-probs (for
# the optimisation).

# Optimisation on ave+sd (600s, rep=100):

# TAU-probs:
# TAU/red_6_wdL_avepsd$ nomad np
# 680 4802.940032   0.03       0.1        0.0401     0.17
# A termination criterion is reached: No termination (all). Mesh minimum precision reached (Algo)
# Blackbox evaluations: 1009 Total model evaluations: 87398 Cache hits: 411 Total number of evaluations: 1420
# TAU/red_6_wdL_avepsd$ time ./TAUscan 6 ../../red "" enu wdL hash "0.03,0.1,0.0401,0.17" 100 1 all
# 100 : 7.07918145889257027448e+02 2.84001572383984599646e+03 1.26592228134290162611e+04; 2.23558703244979358038e+03
# real    0m7.067s user    0m6.899s sys     0m0.159s
# TAU/red_6_wdL_avepsd$ ./laMols 6 ../../red "" count dom enu wdL "" "" 1 1 "0.03,0.1,0.0401,0.17" "" ""
#  N       rt  pl lbt  dis   lbo    lar gcd     satc           t        ppc st      nds      lvs          nsel         nsuel
#  6    count dom enu  wdL   asc  relpr   1        0      10.921     436819  0     6299     3576  9.264846e-01  1.458894e+00
# Slightly worse than the optimisation on ave (for rep=100).

# Uni-probs:
# TAU/red_6_wdL_avepsd$ nomad nprand
# 640 4997.025345   0.4746     0.0201     0.0339     7
# A termination criterion is reached: No termination (all). Mesh minimum precision reached (Algo)
# Blackbox evaluations: 1016 Total model evaluations: 88056 Cache hits: 374 Total number of evaluations: 1390
# TAU/red_6_wdL_avepsd$ time ./TAUscan 6 ../../red "" enu,rand wdL hash "0.4746,0.0201,0.0339,7" 100 1 all
# 100 : 2.88000000000000000000e+02 2.39760000000000000009e+03 2.07360000000000000000e+04; 2.63182757103051180048e+03
# real    0m6.444s user    0m6.304s sys     0m0.132s
# TAU/red_6_wdL_avepsd$ ./laMols 6 ../../red "" count dom enu wdL "" "" 1 1 "0.4746,0.0201,0.0339,7" "" ""
#  N       rt  pl lbt  dis   lbo    lar gcd     satc           t        ppc st      nds      lvs          nsel         nsuel
#  6    count dom enu  wdL   asc  relpr   1        0      12.159     465375  0     6837     3856  1.076473e+00  2.416340e+00


# Only using "rred A" (instead of "red A"):

# MOLS> time ./laMols 6 "@squares A B aux\nrred A B aux\nls A B aux\nrprod B aux A\n" "" count dom enu wdL "" "" 1 16 "" "" ""
#   weights: A -> 0 0 1 2 3 4 5
#  N       rt  pl lbt  dis   lbo    lar gcd     satc           t        ppc st      nds      lvs          nsel         nsuel
#  6    count dom enu  wdL   asc  relpr   1        0    6903.029   56600567  0   836646   464160  1.192326e+00  1.657993e+00
#   mu0    qfppc  pprunes  pmprune  pprobes   rounds  solc       tr  pelvals      dp
#120.35  0.54296   165.41   141.98   103.35   1.6836     0   0.1573   4.0529  11.353
#    12        0        0   22.543   7.0175        1     0        0        0       0
#   360        3      900      200   483.43        6     0   1.5911   37.949      15
#81.795   0.6305   187.96   52.456   72.283  0.91568     0  0.16735   7.2886  1.7897
#   mu0   qfppc  pprunes  pmprune  pprobes   rounds  solc        tr  pelvals      dp
#48.243  2.0071   1.3805   6.0037   26.449   1.0196     0  0.015287   19.976  12.857
#     8     1.1        0        0   1.6667        1     0         0   1.4388       8
#   191       5    93.75   120.11   188.83        2     0   0.63828       25      16
#64.925  0.3206   4.8682   16.099   21.234  0.13879     0  0.047115    8.195  1.5444
#      estlvs       uestlvs
#1.124029e+06  1.740109e+06
#4.050162e+04  2.592000e+04
#2.017889e+07  2.239488e+07
#1.745435e+06  2.533041e+06
#   dm0        w  ltausp      minp     meanp     maxp       sdd       tb
#29.896   2.2461   1.949   0.39453   0.46168  0.54363  0.069791   0.1133
#     0        2       1  0.017661       0.2      0.2         0        0
#   164        5       7       0.5       0.5  0.87864    0.3856  0.71737
#53.781  0.50023  1.2479   0.14428  0.074782  0.10675   0.10273  0.11484
##   weights: L -> 0 0 1 1.5849625007211561815 2 2.3219280948873623478 2.5849625007211561815
#  N       rt  pl lbt  dis   lbo    lar gcd     satc           t        ppc st      nds      lvs          nsel         nsuel
#  6    count dom enu  wdL   asc  relpr   1        0    6870.975   56749234  0   843846   467040  1.201022e+00  2.426264e+00
#   mu0    qfppc  pprunes  pmprune  pprobes   rounds  solc       tr  pelvals      dp
# 117.1  0.49863   184.52   148.65   94.099   1.5931     0  0.14039   3.9036  11.825
#    12        0        0    29.87   6.5574        1     0        0        0       0
#   360        3      900      200   315.38        5     0   1.1554     37.5      16
#82.443  0.61726   197.33   46.103   59.578  0.80856     0  0.14684   7.8707  1.9517
#   mu0    qfppc  pprunes  pmprune  pprobes   rounds  solc        tr  pelvals      dp
#58.382    2.049  0.81942   7.3952   25.324   1.0193     0  0.016525   18.739  13.324
#     8   1.0952        0        0   1.7544        1     0         0   1.7544       8
#   182        5   77.273   114.53   188.57        2     0   0.60973       25      17
#68.468  0.41151    3.162   16.041   20.646  0.13753     0  0.046062    8.637  1.7361
#      estlvs       uestlvs
#1.140723e+06  3.216391e+06
#3.961941e+04  2.592000e+04
#2.576324e+07  5.971968e+07
#2.357390e+06  7.095416e+06
#   dm0       w  ltausp      minp     meanp     maxp       sdd       tb
#20.773  2.2395  2.1078   0.37673   0.46307  0.56781  0.089025  0.12325
#     0       2       1  0.010442       0.2      0.2         0        0
#   161       5       7       0.5       0.5  0.80439   0.30439  0.73607
#43.621  0.5037  1.1785   0.15606  0.074409  0.10412   0.10977  0.11483

# Optimising tau-probs, with MAX_TIME=20000, rep=1000:
# TAU/rred_6_wdL_ave$ nomad np
# 245 393230.913862   5.57       0.0328     0.0001     0.0501
# A termination criterion is reached: No termination (all). Mesh minimum precision reached (Algo)
# Blackbox evaluations: 1047 Total model evaluations: 92531 Cache hits: 415 Total number of evaluations: 1462
# TAU/rred_6_wdL_ave> time ./TAUscan 6 "@squares A B aux\nrred A B aux\nls A B aux\nrprod B aux A\n" "" enu wdL hash "5.57,0.0328,0.0001,0.0501" 1000 10 all
# 1000 : 3.07559274672045538317e+04 3.93230913862130902373e+05 3.43661175667245369914e+06; 4.21995700399631999147e+05
# real    0m12.695s user    2m1.707s sys     0m1.549s
# TAU/rred_6_wdL_ave> time ./laMols 6 "@squares A B aux\nrred A B aux\nls A B aux\nrprod B aux A\n" "" count dom enu wdL "" "" 1 16 "5.57,0.0328,0.0001,0.0501" "" ""
#  N       rt  pl lbt  dis   lbo    lar gcd     satc           t        ppc st      nds      lvs          nsel         nsuel
#  6    count dom enu  wdL   asc  relpr   1        0    8107.959   53254483  0   770626   434640  1.147250e+00  1.605001e+00
#   mu0    qfppc  pprunes  pmprune  pprobes  rounds  solc       tr  pelvals      dp
#120.85  0.52106   185.22   147.85   104.05  1.6786     0  0.19049   4.3116  10.861
#    12        0        0   28.042   7.3529       1     0        0        0       0
#   360        3      900      200   598.44       8     0   2.0936   41.146      15
#86.992  0.62107   203.44   47.823   77.905  0.9942     0  0.21652   8.1738  1.6875
#   mu0    qfppc  pprunes  pmprune  pprobes   rounds  solc        tr  pelvals      dp
#62.584   1.9701   1.1247   10.061   32.336   1.0492     0   0.03369   19.259  12.281
#     8     1.05        0        0   1.4184        1     0         0   1.4184       8
#   192        5   128.57   133.14   532.07        5     0    1.7999       25      16
#73.468  0.29651   4.0008   19.623   39.943  0.28471     0  0.095068   7.9755  1.5008
#      estlvs       uestlvs
#1.006706e+06  1.554285e+06
#3.075593e+04  2.304000e+04
#1.784382e+07  1.990656e+07
#1.348349e+06  2.552520e+06
#   dm0        w  ltausp       minp     meanp      maxp       sdd       tb
#24.367   2.2936  4.2955    0.40082   0.45861   0.52536  0.056958  0.14364
#     0        2       1  0.0047529       0.2       0.2         0        0
#   177        5  47.968        0.5       0.5   0.93411   0.43411  0.73022
#48.278  0.62428  5.2689    0.14478  0.084027  0.087087  0.084206  0.14379
# real    12m15.487s user    135m7.966s sys     48m5.437s

# Optimising uni-probs, with MAX_TIME=20000, rep=1000:
# TAU/rred_6_wdL_ave$ nomad nprand
# 301 360439.68       5.7951     0.109385   0.0001     0.102802
# A termination criterion is reached: No termination (all). Mesh minimum precision reached (Algo)
# Blackbox evaluations: 1085 Total model evaluations: 93648 Cache hits: 393 Total number of evaluations: 1478
# TAU/rred_6_wdL_ave> time ./TAUscan 6 "@squares A B aux\nrred A B aux\nls A B aux\nrprod B aux A\n" "" enu,rand wdL hash "5.7951,0.109385,0.0001,0.102802" 1000 10 all
# 1000 : 4.60800000000000000000e+04 3.60439680000000000007e+05 5.89824000000000000000e+06; 5.08426845529967224536e+05
# real    0m11.842s user    1m54.613s sys     0m1.464s
# TAU/rred_6_wdL_ave> time ./laMols 6 "@squares A B aux\nrred A B aux\nls A B aux\nrprod B aux A\n" "" count dom enu wdL "" "" 1 16 "5.7951,0.109385,0.0001,0.102802" "" ""
#  N       rt  pl lbt  dis   lbo    lar gcd     satc           t        ppc st      nds      lvs          nsel         nsuel
#  6    count dom enu  wdL   asc  relpr   1        0    4766.489   56503617  0   788866   449880  1.658940e+00  2.264148e+00
#   mu0    qfppc  pprunes  pmprune  pprobes   rounds  solc       tr  pelvals      dp
#124.62  0.58897   168.41   141.01    99.78   1.6841     0      0.1   3.9195  11.071
#    12        0        0   24.691   6.5574        1     0        0        0       0
#   360        4      900      200   671.11        9     0   1.2033   38.158      15
#82.558  0.68306   188.42    50.67   81.229  0.95789     0  0.12146   7.3453  1.7674
#   mu0    qfppc  pprunes  pmprune  pprobes   rounds  solc        tr  pelvals      dp
#60.361   2.0055    1.034   9.3786   30.161   1.0371     0   0.01571    19.04  12.479
#     8     1.05        0        0    1.626        1     0         0    1.626       9
#   189        5   133.33   131.28   291.62        3     0   0.49551       25      16
#71.509  0.35822    3.538   19.215   31.256  0.21784     0  0.042257   8.2693  1.5627
#      estlvs       uestlvs
#1.687987e+06  2.756130e+06
#3.514054e+04  4.608000e+04
#4.429365e+07  3.981312e+07
#3.869190e+06  5.818648e+06
#   dm0        w  ltausp     minp     meanp     maxp       sdd        tb
#29.391   2.3271  3.2314  0.39215   0.45389  0.52645  0.061393  0.078075
#     0        2       1  0.01225       0.2      0.2         0         0
#   165        5  58.942      0.5       0.5  0.90943   0.40943   0.43775
#52.203  0.64966  3.3903  0.15455  0.087534  0.10132   0.09645  0.080357
# real    12m54.132s user    79m26.496s sys     91m58.392s


# N=7:

# Optimising TAUscan via Nomad (MAX_TIME 10000s, rep=1000):
# TAU_red_7_wdL_ave> nomad np
# aborted:
# 172 28012948.148463   0.6        1.5        0.0121     0.0001     0.088

# Rerunning with version >= 0.99 (MAX_TIME 20000s, rep=2000):
# TAU/red_7_wdL_ave$ nomad np
#1   53789611.783054   0.1        0.1        0.1        0.1        0.1
#126 25439793.094489   6          0.0001     0.1        0.1        2.1
#289 24914877.432501   5.7        0.0201     0.0921     0.08694    2.1374
#381 24487990.20624    5.7036     0.0242     0.091945   0.08794    2.137809
# A termination criterion is reached: No termination (all). Mesh minimum precision reached (Algo)
# Blackbox evaluations: 1135 Total model evaluations: 101042 Cache hits: 406 Total number of evaluations: 1541
# TAU/red_7_wdL_ave$ time ./TAUscan 7 ../../red "" enu wdL hash "5.7036,0.0242,0.091945,0.08794,2.137809" 2000 10 all
# 2000 : 1.04020821839102411991e+06 2.44879902062399620463e+07 3.79302768170800090447e+08; 3.39253242442571671563e+07
# real    0m59.541s user    9m47.207s sys     0m3.329s
# MOLS> time ./laMols 7 data/SpecsCollection/Euler/red "" +count dom enu wdL "" "" 1 16 "5.7036,0.0242,0.091945,0.08794,2.137809" "" ""
#  N       rt  pl lbt  dis   lbo    lar gcd     satc           t        ppc st      nds      lvs          nsel         nsuel
#  7   +count dom enu  wdL   asc  relpr   1   342480 1498762.104 3877199493  0 41438247 26620515  2.390574e+00  2.187754e+00
#   mu0    qfppc  pprunes  pmprune  pprobes   rounds        solc       tr  pelvals      dp
#293.26   0.7171   21.829   130.54   180.34   1.9896  0.00063235  0.65516   1.2399  13.773
#    12        0        0   19.188    6.383        1           0        0        0       0
#   558        4      300      200   970.26       10           2   5.7333   26.756      21
#23.954  0.49738   9.3909   3.5717   77.852  0.91213    0.026701  0.32948   1.7939  1.6293
#   mu0    qfppc  pprunes  pmprune  pprobes   rounds      solc       tr  pelvals      dp
#236.48   1.8105    4.887   29.126   72.009   1.3167  0.012513  0.25667   8.9702  15.296
#     8   1.0196        0        0  0.73529        1         0        0  0.66445      10
#   328        6      290   137.61   1169.1       13        13   6.5926   31.683      22
#38.679  0.55745   6.1871   24.365   86.241  0.70652   0.16197  0.33544   4.7093  1.3759
#      estlvs       uestlvs
#1.787526e+08  1.540334e+08
#5.821017e+05  2.880000e+05
#5.262156e+12  1.911030e+10
#1.065202e+10  4.058311e+08
#   dm0        w  ltausp        minp    meanp     maxp       sdd       tb
# 4.479   2.7965   6.113     0.22629  0.38899  0.58416   0.16221  0.48223
#     0        2       1  3.6504e-06  0.16667      0.2         0        0
#   309        6  53.916         0.5      0.5  0.98318   0.48318    1.329
#9.4783  0.84042  2.6244     0.13678  0.10692  0.14167  0.094653  0.11121
# real    1913m50.782s user    24979m22.116s sys     4274m4.360s
# Worse than newvars below (though better nsel).


# Alternative optimisation, using uniform probabilities:
# TAU/red_7_wdL_ave$ nomad nprand
#1    50733617.76       0.1        0.1        0.1        0.1        0.1
#117  26555394.375      5.8        2.1        0.0001     0.0001     1.14
#1403 24508437.375      1.800708   1.701916   0.040159   0.006998   0.989071
#A termination criterion is reached: No termination (all). Mesh minimum precision reached (Algo)
# Blackbox evaluations: 1463 Total model evaluations: 123018 Cache hits: 438 Total number of evaluations: 1901
# TAU/red_7_wdL_ave$ time ./TAUscan 7 ../../red "" enu,rand wdL hash "1.800708,1.701916,0.040159,0.006998,0.989071" 2000 10 all
# 2000 : 3.37500000000000000000e+05 2.89348031250000000000e+07 8.74800000000000000000e+08; 5.98112477536113680835e+07
# real    0m57.635s user    9m26.673s sys     0m3.300s
# TAU/red_7_wdL_ave$ time ./laMols 7 ../../red "" +count dom enu wdL "" "" 1 16 "1.800708,1.701916,0.040159,0.006998,0.989071" "" ""
#  N       rt  pl lbt  dis   lbo    lar gcd     satc           t        ppc st      nds      lvs          nsel         nsuel
#  7   +count dom enu  wdL   asc  relpr   1   342480 1013441.006 3662037220  0 42519709 28390469  2.733219e+00  2.736847e+00
#   mu0    qfppc  pprunes  pmprune  pprobes   rounds        solc       tr  pelvals      dp
#295.67  0.69177   24.359   130.22   173.77   1.9433  0.00046322  0.42309   1.1559  13.983
#    12        0        0   16.727    4.908        1           0        0        0       0
#   558        4      300      200   941.18       10           3   4.3023   26.523      20
#23.404  0.51049   9.7696    3.435   76.878  0.90421    0.023529  0.32019   1.6925  1.6587
#   mu0    qfppc  pprunes  pmprune  pprobes   rounds      solc       tr  pelvals      dp
#241.17   1.8825   4.0009    29.44   71.826   1.3219  0.011833  0.16825   9.1631  15.412
#     8   1.0189        0        0  0.69686        1         0        0  0.69686      10
#   335        6   128.57    140.1   1026.5       12        15   4.8625   31.746      21
#39.882  0.66445   4.7344   25.101   83.776  0.69444   0.15618  0.25231   4.5853  1.4411
#      estlvs       uestlvs
#2.404811e+08  2.410445e+08
#7.613355e+05  2.700000e+05
#2.296126e+13  1.399680e+11
#2.670643e+10  9.227933e+08
#   dm0       w   ltausp        minp    meanp     maxp       sdd       tb
#4.1697  3.0093   3.8088     0.21972  0.36898  0.53894   0.14246  0.32547
#     0       2        1  7.6373e-06  0.16667  0.17712         0        0
#   292       6   20.255         0.5      0.5  0.97078   0.47078   1.2694
#9.6136  1.0174  0.99962     0.13542  0.11293  0.15295  0.088626  0.19512
# real    1862m52.230s user    16890m41.014s sys     9782m23.998s
# Clearly somewhat worse than the tau-optimisation.


# N=9:

# MOLS> time ./laMols 9 data/SpecsCollection/Euler "" satd "" - wdL - "" 1 12 "" "nds,100000"
# best, and only one finding a solution: enu+asc
#   weights: 0 0 1 2 3 4 5 6 7 8
#  N       rt  pl lbt  dis   lbo    lar gcd     satc           t        ppc     flvs     gnds    gd st      nds      lvs    inds
#  9     satd dom enu  wdL   asc  relpr   1        1    1056.974    3767939    25738    63982    45  1    38244    25742   12502
#       vals      props      elvals      prunes       mprune       probes    rounds      solc        tr   qelvals   qprunes
#    609.478      8.757      14.392      63.959      220.701      305.332     1.314     0.000     0.209     0.024     0.148
#    383.000      0.000       0.000       0.000        0.000        2.000     1.000     0.000     0.000     0.000     0.000
#   1627.000     97.000     119.000     726.000     1592.000     3902.000     8.000     1.000     2.982     0.162     1.084
#     74.878     10.283      14.695      93.828      236.419      360.723     0.655     0.005     0.250     0.024     0.245
#         mu         w      ltau        mind       meand        maxd         sdd         dp        tb
#    417.700     3.143     0.036      20.990      37.124      53.578      14.316     35.188     0.364
#    301.000     2.000     0.007       3.000      10.000      10.000       0.000      0.000     0.045
#   1384.000     7.000     0.098     135.000     164.667     273.000     129.000     45.000     1.126
#     99.470     1.022     0.012      10.971      17.646      34.234      16.237      4.635     0.081



# laMols with wdL for bin

# N=6:

# Optimising for bin-branching, on ave works badly due to
# very high deviations (so that meaningless low values
# are obtained).
# Optimising on sd with MAX_TIME=3600 and rep=100 yields
# some weak results:
# TAU_red_6_bin_wdL_sd> nomad np
# Best feasible solution: #39533 ( 2 4.1 2.1 5 ) Evaluation OK f = 3351.5240109572218898 h =   0
# Blackbox evaluations: 631 Total model evaluations: 23351 Cache hits: 81 Total number of evaluations: 712
# TAU_red_6_bin_wdL_sd> ./TAUscan 6 ../red "" bin wdL hash "2,4.1,2.1,5" 100 10 all
# 100 : 3.64865926995509084994e+01 3.72647546898737321697e+03 2.09195960503287841732e+04; 3.42728808723272508230e+03
# TAU_red_6_bin_wdL_sd> ./laMols 6 ../red "" count dom bin wdL "" "" 1 1 "2,4.1,2.1,5" "" ""
#   N       rt  pl lbt  dis   lbo    lar gcd     satc           t        ppc st      nds    inds      lvs     plvs
#  6    count dom bin  wdL   asc  relpr   1        0      48.667     768323  0    12521    6260     6261        0
#    mu0  qfppc  pprunes  pmprune  pprobes  rounds   solc     tr  pelvals      dp
#183.615  0.416   55.277  130.666  124.799   1.484  0.000  0.003    1.958  19.452
# 12.000  0.000    3.652   23.256    6.452   1.000  0.000  0.000    0.000   0.000
#310.000  3.000  900.000  200.000  618.142   7.000  0.000  0.022   36.441  60.000
# 59.744  0.588   95.638   35.394   67.270   0.818  0.000  0.002    4.886   8.653
#    mu0  qfppc  pprunes  pmprune  pprobes  rounds   solc     tr  pelvals      dp
# 98.458  1.991    7.436   11.899   31.084   1.069  0.000  0.001   13.479  21.448
#  8.000  1.050    0.000    0.000    1.242   1.000  0.000  0.000    1.242   5.000
#270.000  5.000  350.000  155.556  644.595   6.000  0.000  0.021   25.116  61.000
# 78.266  0.562   20.934   21.979   50.897   0.357  0.000  0.002    9.687   8.540
#      estlvs
#1.505823e+05
#3.648659e+01
#2.203674e+07
#7.215392e+05
#      mu1      w   ltau   minp  meanp   maxp    sdd     tb
# 4113.396  2.000  0.035  0.266  0.500  0.734  0.234  0.004
#   12.000  2.000  0.000  0.005  0.500  0.500  0.000  0.000
#18231.000  2.000  0.173  0.500  0.500  0.995  0.495  0.009
# 2850.586  0.000  0.068  0.172  0.000  0.172  0.172  0.002

# Optimising for max (MAX_TIME=3600 and rep=100)
# TAU_red_6_bin_wdL_max> nomad np
# A termination criterion is reached: No termination (all). Min mesh size reached (Algo)
# Best feasible solution: #39175 ( 2.005 5.00229 0.99981 0.098993 ) Evaluation OK f = 13844.869111929894643 h =   0
# TAU_red_6_bin_wdL_max> ./TAUscan 6 ../red "" bin wdL hash "2.005,5.00229,0.99981,0.098993" 100 10 all
# 100 : 3.18021564865660525456e+02 5.15240755434911540966e+03 2.80984897089154951146e+04; 5.52381477511200176744e+03
# TAU_red_6_bin_wdL_max> ./laMols 6 ../red "" count dom bin wdL "" "" 1 1 "2.005,5.00229,0.99981,0.098993" "" ""
#  N       rt  pl lbt  dis   lbo    lar gcd     satc           t        ppc st      nds    inds      lvs     plvs
#  6    count dom bin  wdL   asc  relpr   1        0      43.818     774783  0    12701    6350     6351        0
#    mu0  qfppc  pprunes  pmprune  pprobes  rounds   solc     tr  pelvals      dp
#178.555  0.370   45.763  131.027  128.629   1.414  0.000  0.003    1.916  19.388
# 12.000  0.000    0.000   31.579    7.018   1.000  0.000  0.000    0.000   0.000
#310.000  4.000  900.000  200.000  610.526   8.000  0.000  0.018   39.444  65.000
# 53.438  0.589   96.603   34.470   62.760   0.744  0.000  0.002    5.027   8.219
#    mu0  qfppc  pprunes  pmprune  pprobes  rounds   solc     tr  pelvals      dp
# 97.204  1.958    2.909   14.076   34.873   1.070  0.000  0.001   13.957  21.385
#  8.000  1.091    0.000    0.000    1.190   1.000  0.000  0.000    1.190   5.000
#240.000  5.000  400.000  141.912  576.757   6.000  0.000  0.015   25.000  66.000
# 74.716  0.514    7.561   25.158   49.377   0.316  0.000  0.001    9.286   8.100
#      estlvs
#2.876788e+04
#2.117151e+02
#2.981983e+06
#1.334957e+05
#      mu1      w   ltau   minp  meanp   maxp    sdd     tb
# 5210.542  2.000  0.034  0.237  0.500  0.763  0.263  0.004
#   12.000  2.000  0.000  0.003  0.500  0.500  0.000  0.000
#18008.000  2.000  0.173  0.500  0.500  0.997  0.497  0.008
# 3205.984  0.000  0.068  0.174  0.000  0.174  0.174  0.002
# Very similar to sd.

# Absolute optimisation on lvs:
# LVS_red_6_bin_wdL$ nomad np
# A termination criterion is reached: No termination (all). Mesh minimum precision reached (Algo)
# Best feasible solution: #89132 ( 0.0059 0.004561 0.000124 0.0081 ) Evaluation OK f = 3192 h =   0
# Blackbox evaluations: 1335 Total model evaluations: 102256 Cache hits: 542 Total number of evaluations: 1877
# LVS_red_6_bin_wdL$ ./laMols 6 ../red "" count dom bin wdL "" "" 1 1 "0.0059,0.004561,0.000124,0.0081" "" ""
#  N       rt  pl lbt  dis   lbo    lar gcd     satc           t        ppc st      nds    inds      lvs     plvs
#  6    count dom bin  wdL   asc  relpr   1        0      16.485     416810  0     6383    3191     3192        0
#    mu0  qfppc  pprunes  pmprune  pprobes  rounds   solc     tr  pelvals      dp
#136.295  0.505  129.442  138.237   97.307   1.521  0.000  0.002    3.687  10.800
# 12.000  0.000    0.000   32.370    9.868   1.000  0.000  0.000    0.000   0.000
#310.000  2.500  900.000  200.000  325.521   4.000  0.000  0.008   35.057  17.000
# 79.996  0.632  164.598   49.261   52.745   0.714  0.000  0.002    7.189   2.303
#    mu0  qfppc  pprunes  pmprune  pprobes  rounds   solc     tr  pelvals      dp
# 45.700  1.960    0.853    8.011   30.772   1.039  0.000  0.000   21.178  12.796
#  8.000  1.083    0.000    0.000    2.013   1.000  0.000  0.000    2.013   7.000
#182.000  5.000  109.091  124.725  390.110   4.000  0.000  0.010   25.000  18.000
# 67.112  0.256    3.553   18.828   35.052   0.280  0.000  0.001    6.920   1.831
#      estlvs
#1.748078e+09
#2.351956e+02
#4.688072e+11
#2.412837e+10
#   mu1      w   ltau   minp  meanp   maxp    sdd     tb
#46.116  2.000  0.263  0.403  0.500  0.597  0.097  0.003
#12.000  2.000  0.016  0.000  0.500  0.500  0.000  0.000
#85.000  2.000  3.999  0.500  0.500  1.000  0.500  0.010
#27.582  0.000  0.465  0.140  0.000  0.140  0.140  0.002
# Noticeable here the high values for estlvs.



# laMols with newvars:

# N=6:

# Preparing complete RESTART:

# First all combinations of 10 values per dimension (makes 10^5 samples):
# LVS/red_6_newv> time BBSample S1 ./Ss1 "" 15 1 "lvs st nsel nsuel t aroundsi aroundsl apelvalsi apelvalsl adpi adpl aestlvs sddestlvs auestlvs sdduestlvs adm0 aw altausp aminp ameanp amaxp asddp minminp maxmaxp"
#BBS_S1_2E2FSs1_1696830344459298331.R
#real    1097m27.770s user    88815m0.141s sys     2950m0.145s
# Analysis
# E=read.table("BBS_S1_2E2FSs1_1696830344459298331.R", header=TRUE)
# summary(E)
# min-lvs=2520
# viewing by E[E$lvs==2520,] : X1=0.5bar, X2=7.7bar, X3=-5.5bar, X4=3.3bar, X5 all 10 values)
# Variable dependencies, viewing via plot(E$Xi, E$lvs):
# Clearly X5 has no influence, and can be set to 0.
# Considering only the interesting cases:
# F = E[E$lvs<= 2700,]
# nrow(F)
# 840
# Viewing plot(F$Xi, F$lvs):
# X2: abline(v=-4:10) shows one can restrict to say X2 >= -4.
# X3: abline(v=-10:-3) shows one can restrict to say X3 <= -2.
# The same grid, but +-randomised:
# LVS/red_6_newv> time BBSample S1p ./Ss1 0 20 1 "lvs st nsel nsuel t aroundsi aroundsl apelvalsi apelvalsl adpi adpl aestlvs sddestlvs auestlvs sdduestlvs adm0 aw altausp aminp ameanp amaxp asddp minminp maxmaxp"
#BBS_S1p_2E2FSs1_1696946105117725456.R
#real    828m45.311s user    82151m24.466s sys     5687m37.781s
# Analysis: seems similar to the equidistant case (without better insights).

# More restricted, finer grid (with 20^4 = 160000 samples):
# LVS/red_6_newv> time BBSample S2 ./Ss1 "" 15 1 "lvs st nsel nsuel t aroundsi aroundsl apelvalsi apelvalsl adpi adpl aestlvs sddestlvs auestlvs sdduestlvs adm0 aw altausp aminp ameanp amaxp asddp minminp maxmaxp"
#BBS_S2_2E2FSs1_1696903197127869352.R
#real    1555m9.610s user    116728m6.601s sys     3889m29.507s
# min-lvs=2472
#> E[E$lvs == 2472,]
#          X1        X2        X3       X4 X5  lvs st     nsel    nsuel        t
#1 0.05263158  4.105263 -5.789474 2.631579  0 2472  0 1.114060 1.270023 38.97149
#2 0.15789474  4.842105 -4.947368 1.578947  0 2472  0 1.107372 1.270023 45.47432
#3 0.26315789  5.578947 -5.368421 2.631579  0 2472  0 1.087964 1.270023 35.32696
#4 0.26315789  5.578947 -4.947368 1.578947  0 2472  0 1.109539 1.270023 41.62062
#5 0.36842105  6.315789 -5.368421 2.631579  0 2472  0 1.087626 1.270023 34.28582
#6 0.36842105  6.315789 -4.947368 1.578947  0 2472  0 1.111101 1.270023 39.65117
#7 0.68421053 10.000000 -4.526316 1.578947  0 2472  0 1.095004 1.270023 35.39092

# Again restricting the grid, focussing on the best lvs-value:
# LVS/red_6_newv> time BBSample S3 ./Ss1 "" 15 1 "lvs st nsel nsuel t aroundsi aroundsl apelvalsi apelvalsl adpi adpl aestlvs sddestlvs auestlvs sdduestlvs adm0 aw altausp aminp ameanp amaxp asddp minminp maxmaxp"
#BBS_S3_2E2FSs1_1696999984341381294.R
#real    1312m28.440s user    104462m16.859s sys     3102m13.652s
# Analysis:
# min-lvs=2424
#> E[E$lvs == 2424,]
#          X1       X2        X3       X4 X5  lvs st     nsel    nsuel        t
#1 0.00000000 4.947368 -5.263158 2.894737  0 2424  0 1.041891 1.125054 35.09473
#2 0.07368421 5.263158 -5.263158 2.894737  0 2424  0 1.039469 1.125054 39.95221
#3 0.14736842 5.894737 -5.157895 2.789474  0 2424  0 1.039641 1.125054 36.74104
#  aroundsi aroundsl apelvalsi apelvalsl     adpi     adpl  aestlvs sddestlvs
#1 1.801576 1.121287  5.086191  19.35642 6.976356 8.618812 5055.339  5093.322
#2 1.801576 1.128713  5.091831  19.35748 6.976356 8.618812 5043.122  5060.640
#3 1.801576 1.121287  5.085419  19.35642 6.976356 8.618812 5043.988  5060.964
#  auestlvs sdduestlvs     adm0       aw  altausp     aminp    ameanp     amaxp
#1 5492.172   5145.612 42.44784 2.123319 10.71839 0.4267694 0.4828852 0.5389920
#2 5492.172   5145.612 42.44784 2.123319 10.62909 0.4269173 0.4828852 0.5388414
#3 5492.172   5145.612 42.44784 2.123319 10.28503 0.4269380 0.4828852 0.5388215
#       asddp   minminp   maxmaxp
#1 0.05518803 0.1128199 0.8058237
#2 0.05503849 0.1127687 0.8058793
#3 0.05501868 0.1127543 0.8055675
# The same grid as S3, but +-randomised:
# LVS/red_6_newv> time BBSample S3p ./Ss1 1 20 1 "lvs st nsel nsuel t aroundsi aroundsl apelvalsi apelvalsl adpi adpl aestlvs sddestlvs auestlvs sdduestlvs adm0 aw altausp aminp ameanp amaxp asddp minminp maxmaxp"
#BBS_S3p_2E2FSs1_1697059043337545066.R
#real    1116m23.239s user    102849m35.896s sys     6380m45.938s
# min-lvs=2424
#> E[E$lvs == 2424,]
#           X1       X2        X3       X4 X5  lvs st     nsel    nsuel        t
#1 0.003712721 5.464380 -5.014941 2.567417  0 2424  0 1.046034 1.125054 37.08478
#2 0.096886518 5.464380 -5.169033 2.763057  0 2424  0 1.039764 1.125054 37.69431
#3 0.096886518 5.579850 -5.169033 2.763057  0 2424  0 1.041427 1.125054 38.11472
#4 0.096886518 5.927015 -5.014941 2.567417  0 2424  0 1.044319 1.125054 30.33280
#  aroundsi aroundsl apelvalsi apelvalsl     adpi     adpl  aestlvs sddestlvs
#1 1.801576 1.124587  5.075409  19.36363 6.976356 8.618812 5076.307  5149.810
#2 1.799722 1.121287  5.100398  19.36393 6.976356 8.618812 5044.610  5065.579
#3 1.801576 1.126650  5.076956  19.36835 6.976356 8.618812 5052.999  5084.069
#4 1.805285 1.125000  5.137973  19.39024 6.976356 8.618812 5067.622  5123.890
#  auestlvs sdduestlvs     adm0       aw   altausp     aminp    ameanp     amaxp
#1 5492.172   5145.612 42.44784 2.123319  9.912034 0.4266812 0.4828852 0.5390845
#2 5492.172   5145.612 42.44784 2.123319 10.270560 0.4269574 0.4828852 0.5388018
#3 5492.172   5145.612 42.44784 2.123319 10.344056 0.4268855 0.4828852 0.5388749
#4 5492.172   5145.612 42.44784 2.123319  9.866726 0.4267947 0.4828852 0.5389691
#       asddp   minminp   maxmaxp
#1 0.05528175 0.1126645 0.8045187
#2 0.05499998 0.1126904 0.8053818
#3 0.05507268 0.1126373 0.8053317
#4 0.05516715 0.1125965 0.8045508
# The same grid as S3, but u-randomised:
# LVS/red_6_newv> time BBSample S3u ./Ss1 0 25 1 "lvs st nsel nsuel t aroundsi aroundsl apelvalsi apelvalsl adpi adpl aestlvs sddestlvs auestlvs sdduestlvs adm0 aw altausp aminp ameanp amaxp asddp minminp maxmaxp"
#BBS_S3u_2E2FSs1_1697132774560559856.R
# No real difference seems visible.

# A further refinement of the grid (focussing on the best lvs-values):
# LVS/red_6_newv> time BBSample S4 ./Ss1 "" 15 1 "lvs st nsel nsuel t aroundsi aroundsl apelvalsi apelvalsl adpi adpl aestlvs sddestlvs auestlvs sdduestlvs adm0 aw altausp aminp ameanp amaxp asddp minminp maxmaxp"
#BBS_S4_2E2FSs1_1697092492778080226.R
#real    1266m32.333s user    100344m10.787s sys     2972m53.588s
#> summary(E$lvs)
#   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.
#   2424    2544    2640    2619    2672    2984
# > nrow(E[E$lvs == 2424,])
# [1] 208

# A final refinement of the grid, now using lh-sampling (but equidistant):
# LVS/red_6_newv> time BBSample S5LH ./Ss1 0 25 1 "lvs st nsel nsuel t aroundsi aroundsl apelvalsi apelvalsl adpi adpl aestlvs sddestlvs auestlvs sdduestlvs adm0 aw altausp aminp ameanp amaxp asddp minminp maxmaxp"
#BBS_S5LH_2E2FSs1_1697243623203070823.R
#real    694m59.839s user    84342m53.644s sys     2785m52.792s
#> summary(E$lvs)
#   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.
#   2424    2544    2640    2597    2640    2672
#> nrow(E[E$lvs == 2424,])
#[1] 676
# Now a very narrow spectrum, looking somewhat random.

# Considering the dependency on the 5 dimensions for one solution realising lvs=2424:
# LVS/red_6_newv> time BBSample Sopt_1 ./Ss1 "" 18 1 "lvs st nsel nsuel t aroundsi aroundsl apelvalsi apelvalsl adpi adpl aestlvs sddestlvs auestlvs sdduestlvs adm0 aw altausp aminp ameanp amaxp asddp minminp maxmaxp"
#BBS_Sopt5F1_2E2FSs1_1697244473890864200.R
#real    74m20.207s user    6805m30.352s sys     196m4.315s
# new minimum lvs=2406
#> E[E$lvs == 2406,]
#     X1  X2    X3   X4 X5  lvs st     nsel    nsuel        t aroundsi aroundsl
#1 -0.01 4.9 -5.26 2.89  0 2406  0 1.050028 1.125869 36.52983 1.808034 1.121779
#  apelvalsi apelvalsl    adpi     adpl  aestlvs sddestlvs auestlvs sdduestlvs
#1  5.130497  19.43571 6.96964 8.611804 5058.754  5111.215   5455.8   5085.353
#      adm0       aw  altausp     aminp    ameanp     amaxp      asddp  minminp
#1 42.40262 2.123774 10.72136 0.4268654 0.4828351 0.5387905 0.05504446 0.112822
#    maxmaxp
#1 0.8058046
# A sharp minimum for X1=-0.01.
# This minimum is not reproducible by calling laMols directly, also not with
# the exact values given in the file (also not e.g. the nsel,nsuel,adm0,aw-values,
# where these values show quite a huge difference), and on the same machine.
# Rerunning yields numerical differences in the last digits, and minimum now 2424:
#BBS_Sopt5F1_2E2FSs1_1697272697682875019.R
# Again a sharp minimum, 90 X1-values yielding the minimum, exactly the interval
# [-0.0152, 0.0204]
# (midpoint = 0.0026)
# To the left mostly constant, to the right sharp increase until X1=1, where
# it flattens.
#> summary(E2$lvs)
#   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.
#   2424    2640    2640    3034    3724    3828
# (The first file shows the same, except for Min=2406.)
# LVS/red_6_newv> time BBSample Sopt_2 ./Ss1 "" 18 1 "lvs st nsel nsuel t aroundsi aroundsl apelvalsi apelvalsl adpi adpl aestlvs sddestlvs auestlvs sdduestlvs adm0 aw altausp aminp ameanp amaxp asddp minminp maxmaxp"
#BBS_Sopt5F2_2E2FSs1_1697281000159626816.R
#real    72m1.172s user    6594m9.987s sys     192m59.224s
# Also shows a local (global) minimum for the given values.
# Clearly the best lvs-value don't have the best nsel-values (however they have the best
# nsuel-values).
# LVS/red_6_newv> time BBSample Sopt_3 ./Ss1 "" 18 1 "lvs st nsel nsuel t aroundsi aroundsl apelvalsi apelvalsl adpi adpl aestlvs sddestlvs auestlvs sdduestlvs adm0 aw altausp aminp ameanp amaxp asddp minminp maxmaxp"
#BBS_Sopt5F3_2E2FSs1_1697286015863857095.R
#real    141m36.044s user    12714m12.120s sys     441m39.968s
# X3-values <= -0.5 are all quite good, with the optimum lvs=2424 attained
# exactly for the 12 values -5.268 <= X3 <= -5.246; a "phase transition"
# at about X3=-0.5, where then the lvs reaches quickly around 9000 (and then
# becomes kind of constant).
# LVS/red_6_newv> time BBSample Sopt_4 ./Ss1 "" 18 1 "lvs st nsel nsuel t aroundsi aroundsl apelvalsi apelvalsl adpi adpl aestlvs sddestlvs auestlvs sdduestlvs adm0 aw altausp aminp ameanp amaxp asddp minminp maxmaxp"
#BBS_Sopt5F4_2E2FSs1_1697301191200247304.R
#real    94m27.830s user    8559m2.821s sys     260m56.181s
# Somehow similar to X3: a minimum in a good region (to the left), followed by
# a phase transition to bad values. The optimum lvs=2424 is attained
# exactly for the 19 values 2.880 <= X4 <= 2.916.
# LVS/red_6_newv> time BBSample Sopt_5 ./Ss1 "" 18 1 "lvs st nsel nsuel t aroundsi aroundsl apelvalsi apelvalsl adpi adpl aestlvs sddestlvs auestlvs sdduestlvs adm0 aw altausp aminp ameanp amaxp asddp minminp maxmaxp"
#BBS_Sopt5F5_2E2FSs1_1697307916932584713.R
#real    75m4.344s user    6871m28.989s sys     201m50.158s
# Again we have unreproducible better results:
#> E[E$lvs!=2424,]
#  X1  X2    X3   X4     X5  lvs st     nsel    nsuel        t aroundsi aroundsl
#1  0 4.9 -5.26 2.89  1.776 2400  0 1.042006 1.127948 42.20702 1.800937 1.122500
#2  0 4.9 -5.26 2.89  0.626 2406  0 1.049110 1.125869 36.96201 1.801962 1.120948
#3  0 4.9 -5.26 2.89  3.300 2406  0 1.049110 1.125869 36.71569 1.801962 1.120532
#4  0 4.9 -5.26 2.89 -4.478 2419  0 1.043692 1.125955 36.91887 1.800743 1.121538
#5  0 4.9 -5.26 2.89 -2.994 2419  0 1.043692 1.125955 37.41972 1.800743 1.121538
#6  0 4.9 -5.26 2.89  0.992 2419  0 1.043692 1.125955 38.23199 1.800743 1.121538
#  apelvalsi apelvalsl     adpi     adpl  aestlvs sddestlvs auestlvs sdduestlvs
#1  5.067794  19.32781 6.965808 8.608333 5005.862  5014.008 5453.440   5132.535
#2  5.086935  19.37726 6.969640 8.611804 5054.119  5100.384 5455.800   5085.353
#3  5.088091  19.37894 6.969640 8.611804 5054.119  5100.384 5455.800   5085.353
#4  5.073418  19.35279 6.974454 8.617197 5053.997  5090.713 5485.745   5147.165
#5  5.074744  19.35279 6.974454 8.617197 5053.997  5090.713 5485.745   5147.165
#6  5.074510  19.35279 6.974454 8.617197 5053.997  5090.713 5485.745   5147.165
#      adm0       aw  altausp     aminp    ameanp     amaxp      asddp   minminp
#1 42.37705 2.124122 10.68861 0.4266398 0.4827869 0.5389677 0.05523695 0.1128448
#2 42.40262 2.123774 10.67943 0.4269093 0.4828351 0.5387458 0.05500004 0.1128448
#3 42.40262 2.123774 10.67943 0.4269093 0.4828351 0.5387458 0.05500004 0.1128448
#4 42.37901 2.123549 10.67479 0.4266912 0.4828534 0.5390061 0.05523245 0.1128448
#5 42.37901 2.123549 10.67479 0.4266912 0.4828534 0.5390061 0.05523245 0.1128448
#6 42.37901 2.123549 10.67479 0.4266912 0.4828534 0.5390061 0.05523245 0.1128448
#    maxmaxp
#1 0.8058261
#2 0.8058261
#3 0.8058261
#4 0.8058261
#5 0.8058261
#6 0.8058261
# Running laMols, all these X5-values just yield lvs=2424. Rerunning:
# LVS/red_6_newv> time BBSample Sopt_5 ./Ss1 "" 18 1 "lvs st nsel nsuel t aroundsi aroundsl apelvalsi apelvalsl adpi adpl aestlvs sddestlvs auestlvs sdduestlvs adm0 aw altausp aminp ameanp amaxp asddp minminp maxmaxp"
#BBS_Sopt5F5_2E2FSs1_1697324072479064180.R
#real    75m40.198s user    6888m34.695s sys     203m27.497s
# This time only three outliers.
# Rerunning without gecode-parallelism:
# LVS/red_6_newv> time BBSample Sopt_5 ./Ss2 "" 90 1 "lvs st nsel nsuel t aroundsi aroundsl apelvalsi apelvalsl adpi adpl aestlvs sddestlvs auestlvs sdduestlvs adm0 aw altausp aminp ameanp amaxp asddp minminp maxmaxp"
#BBS_Sopt5F5_2E2FSs2_1697329176714378164.R
#real    53m34.456s user    4772m33.391s sys     2m27.529s
# Remark: quite a bit faster this way.
# Now all results seem exactly the same.
# So there seems to be a problem with the gecode-parallelism (or it could be
# that under parallelism floating-point arithmetic become more unpredictable
# --- but why then always a *lower* leaf-count?)

# Kind of "final evaluation", to obtain a reasonable fine grid to compare
# different heuristics; first setting X1=0:
# LVS/red_6_newv> time BBSample S0final ./Ssfinal "" 120 1 "lvs st nsel nsuel t aroundsi aroundsl apelvalsi apelvalsl adpi adpl aestlvs sddestlvs auestlvs sdduestlvs adm0 aw altausp aminp ameanp amaxp asddp minminp maxmaxp"
#BBS_S0final_2E2FSsfinal_1700797346217894361.R
# real    4616m42.874s user    548553m27.656s sys     728m21.252s



# New distance newv-degm:
# First all combinations of 11 values per dimension (makes 11^5 samples):
# LVS/red_6_newvdegm> time BBSample S1 ./Ss1 "" 25 1 "lvs st nsel nsuel t aroundsi aroundsl apelvalsi apelvalsl adpi adpl aestlvs sddestlvs auestlvs sdduestlvs adm0 aw altausp aminp ameanp amaxp asddp minminp maxmaxp"
#BBS_S1_2E2FSs1_1697289300586757878.R
#real    925m17.311s user    112044m17.798s sys     3799m10.084s
#> min(E$minminp)
#[1] 3.364129e-10
#> summary(E$lvs)
#   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.
#   2472    2864    3504    4487    3884   10006
# Conclusions from plot(E$Xi, E$lvs):
# X1 <= 0.9, X2 >= 0, X3 <= -2, X4 >= 1, X5 = 0
# LVS/red_6_newvdegm> time BBSample S2 ./Ss2 "" 50 1 "lvs st nsel nsuel t aroundsi aroundsl apelvalsi apelvalsl adpi adpl aestlvs sddestlvs auestlvs sdduestlvs adm0 aw altausp aminp ameanp amaxp asddp minminp maxmaxp"
#BBS_S2_2E2FSs2_1697357784265380546.R
#real    797m53.355s user    99289m41.125s sys     888m30.282s
# Non-reproducible optimum lvs=2073, next best lvs=2424.
# Ignoring this "outlier" for now: examining lvs<=2700 (53762 cases)
# and lvs>=9000 (17213 cases) suggests that a sufficient condition
# to get rid off the bad values (though not necessary) by
# X3 <= -7 (this eliminates the lvs=2073)
# X4 <= 5
# where perhaps it is more prudent to only have X4 <= 5.
# Considering only lvs <= 2500 (1206 cases):
# > F=E[E$lvs<=2450,]
# > summary(F)
#       X1                X2               X3               X4
# Min.   :-1.0000   Min.   : 0.000   Min.   :-7.895   Min.   : 1.474
# 1st Qu.:-0.7000   1st Qu.: 4.737   1st Qu.:-7.053   1st Qu.: 4.079
# Median :-0.4000   Median : 6.842   Median :-6.632   Median : 8.579
# Mean   :-0.3245   Mean   : 6.400   Mean   :-5.676   Mean   : 6.808
# 3rd Qu.: 0.1000   3rd Qu.: 8.421   3rd Qu.:-4.105   3rd Qu.: 9.053
# Max.   : 0.9000   Max.   :10.000   Max.   :-2.000   Max.   :10.000
# So likely there is a more complex constraint at work, to restrict
# to only the good cases.
# Restricting to lvs <= 2450 (276 cases):
#> F=E[E$lvs<=2450,]
#> summary(F)
#       X1                X2               X3               X4
# Min.   :-1.0000   Min.   : 1.053   Min.   :-4.105   Min.   :1.947
# 1st Qu.:-0.8000   1st Qu.: 5.789   1st Qu.:-3.684   1st Qu.:1.947
# Median :-0.5000   Median : 7.895   Median :-3.684   Median :1.947
# Mean   :-0.4543   Mean   : 7.311   Mean   :-3.690   Mean   :2.117
# 3rd Qu.:-0.2000   3rd Qu.: 8.947   3rd Qu.:-3.684   3rd Qu.:2.421
# Max.   : 0.7000   Max.   :10.000   Max.   :-2.000   Max.   :3.842
# Let's use this for the next round, and let's not use parallel gc:
# LVS/red_6_newvdegm> time BBSample S3 ./Ss3 "" 128 1 "lvs st nsel nsuel t aroundsi aroundsl apelvalsi apelvalsl adpi adpl aestlvs sddestlvs auestlvs sdduestlvs adm0 aw altausp aminp ameanp amaxp asddp minminp maxmaxp"
#BBS_S3_2E2FSs3_1697428984148463841.R
#real    524m10.949s user    66916m52.060s sys     40m49.909s
#> summary(E$lvs)
#   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.
#   2424    2720    2812    2931    3112    3912
# Further refinement:
# LVS/red_6_newvdegm> time BBSample S4 ./Ss3 "0" 128 1 "lvs st nsel nsuel t aroundsi aroundsl apelvalsi apelvalsl adpi adpl aestlvs sddestlvs auestlvs sdduestlvs adm0 aw altausp aminp ameanp amaxp asddp minminp maxmaxp"
#BBS_S4_2E2FSs3_1697484838489910382.R
#real    519m56.029s user    66418m27.267s sys     39m11.578s
# Final refinement:
# plot(E$Xi, E$lvs) suggests:
# X1 <= -0.2
# X2 >= 8.5
# X3, X4 have little influence.
# > F=E[E$lvs<=2424,]
# > nrow(F)
# [1] 23601
# Via summary(F) we get the min,max of Xi:
# X1 : -0.95451 0.65093
# X2 : 1.326 9.970
# X3 : -4.105 -3.551 # as in S4
# X4 : 1.947 2.845 # as in S4
# LVS/red_6_newvdegm> time BBSample S5 ./Ss3 0 128 1 "lvs st nsel nsuel t aroundsi aroundsl apelvalsi apelvalsl adpi adpl aestlvs sddestlvs auestlvs sdduestlvs adm0 aw altausp aminp ameanp amaxp asddp minminp maxmaxp"
#BBS_S5_2E2FSs3_1697533826474367760.R
#real    288m54.120s user    36896m51.458s sys     19m41.557s
#> summary(E$lvs)
#   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.
#   2424    2424    2544    2504    2544    2624
# Finally trying to find an improvement, with one starting point, by nomad:
# LVS/red_6_newvdegm> time nomad np
# running on server: error message from nomad (problem with the fixed variable);
# seems a bug in nomad; workaround:
# LVS/red_6_newvdegm> time nomad np_hack
#1 2424         -1          8.5       -3.93       2.8
#A termination criterion is reached: Maximum allowed time reached (Base)
# Blackbox evaluations: 3023 Total model evaluations: 338674 Cache hits: 371 Total number of evaluations:  3394
# real    166m39.932s user    3483m59.727s sys     61m21.184s
# Better use of parallelism:
# LVS/red_6_newvdegm> time nomad np2_hack
# error: VNS Mads generateTrialPointsFinal() not yet implemented --- MEGA_SEARCH_POLL removed.
# It seems nomad runs never more than 4 parallel laMols (that is for each dimension one);
# so the only chance to use more computation power is to increase the threads for laMols;
# though from time to time it runs 10 parallel.
# The above np_hack wrongly did not use ns_hack, which shouldn't matter in this
# case, since the last argument doesn't seem to matter at all.
# LVS/red_6_newvdegm> time nomad np2_hack
# 1 2424         -1          8.5       -3.93       2.8
# A termination criterion is reached: No termination (all). Mesh minimum precision reached (Algo)
# Blackbox evaluations: 3420 Total model evaluations: 404892 Cache hits: 619 Total number of evaluations:  4039
# real    164m20.704s user    5868m29.871s sys     234m29.145s

# Kind of "final evaluation", to obtain a reasonable fine grid to compare
# different heuristics; first setting X1=0:
# LVS/red_6_newvdegm> time BBSample S0final ./Ssfinal "" 120 1 "lvs st nsel nsuel t aroundsi aroundsl apelvalsi apelvalsl adpi adpl aestlvs sddestlvs auestlvs sdduestlvs adm0 aw altausp aminp ameanp amaxp asddp minminp maxmaxp"
#BBS_S0final_2E2FSsfinal_1701377039809566517.R
# real    4398m47.163s user    522909m13.557s sys     705m54.230s



# MOLS> time ./laMols 6 data/SpecsCollection/Euler/red "" satd "" - newv "" "" 1 12 "O" "nds,7000" ""
# Best, and only one succeeding: enu
# laMols 0.102.2 2bb2480c69433720ca3d41b3e51c375ef0d6ac4b
#  N       rt  pl lbt  dis   lbo    lar gcd     satc           t        ppc st      nds      lvs          nsel         nsuel
#  6     satd dom enu newv   asc  relpr   1        0      30.435     436474  0     6713     3608  9.485008e-01  1.904617e+00
#   mu0    qfppc  pprunes  pmprune  pprobes   rounds  solc        tr  pelvals      dp
#118.68  0.48226   176.16   147.36   95.141   1.5987     0  0.047159   3.8658  8.1121
#    12        0        0   32.237   9.2105        1     0         0        0       0
#   310   2.3333      900      200   401.06        6     0   0.34371   31.395      13
#82.691  0.60758   190.31   46.155   62.243  0.85667     0  0.052271   7.7576  1.9396
#   mu0    qfppc  pprunes  pmprune  pprobes  rounds  solc         tr  pelvals      dp
#55.101   2.0619  0.95719   8.3972   30.238   1.043     0  0.0081019   19.573  9.7389
#     8   1.1212        0        0   2.6316       1     0          0   2.6316       5
#   185        5   29.539   126.78   344.26       4     0    0.25562       25      14
#69.004  0.52727   3.2826   19.415   33.794  0.2516     0   0.024943   8.1537  1.6589
#      estlvs       uestlvs
#6.853951e+03  1.669626e+04
#6.524710e+02  2.880000e+02
#3.645849e+04  1.658880e+05
#6.128126e+03  2.654143e+04
#   dm0        w  ltausp     minp     meanp      maxp       sdd        tb
#21.372   2.1617  2.0696  0.41305   0.47394   0.54999  0.064692  0.040445
#     0        2       1   0.0372      0.25      0.25         0         0
#   161        4       7      0.5       0.5   0.78145    0.3169   0.14562
#43.698  0.39603  1.1716  0.12854  0.062345  0.085398  0.092335  0.040652
# MOLS> time ./laMols 6 data/SpecsCollection/Euler/red "" satd "" enu newv "" "" 1 12 "Z" "nds,7000" ""
# laMols 0.102.2 2bb2480c69433720ca3d41b3e51c375ef0d6ac4b
#  N       rt  pl lbt  dis   lbo    lar gcd     satc           t        ppc st      nds      lvs          nsel         nsuel
#  6     satd dom enu newv   asc  relpr   1        0      26.307     448928  0     6201     3579  1.051187e+00  2.278395e+00
#   mu0    qfppc  pprunes  pmprune  pprobes  rounds  solc        tr  pelvals      dp
#122.53  0.48914   150.65   143.27    98.29  1.5946     0  0.050728   4.5608  7.0282
#    12        0        0   30.519    10.39       1     0         0        0       0
#   310      2.6      900      200   400.53       6     0   0.31484   35.057      12
#83.543  0.63496   162.21    50.21   62.915  0.8831     0  0.053235   8.5941  1.6823
#   mu0    qfppc  pprunes  pmprune  pprobes   rounds  solc         tr  pelvals      dp
#59.752   2.0702  0.93179   8.6146   27.682   1.0305     0  0.0074948   18.813  8.4641
#     8     1.15        0        0   2.6316        1     0          0   2.6316       5
#   185        5   27.306   126.78    354.4        4     0     0.2833       25      13
#69.927  0.49662   3.1693   18.309   30.117  0.21905     0    0.02323   8.5043  1.4432
#      estlvs       uestlvs
#7.533774e+03  2.215789e+04
#5.097856e+02  3.240000e+02
#2.063908e+05  6.635520e+05
#1.051581e+04  6.353860e+04
#   dm0        w  ltausp      minp     meanp     maxp       sdd        tb
#27.857   2.3646  3.4103   0.36703   0.44355  0.54241  0.079632  0.039917
#     0        2       1  0.003143      0.25     0.25         0         0
#   175        4  13.601       0.5       0.5   0.8939    0.3939    0.1336
# 51.72  0.57925  2.7745   0.17029  0.085469  0.11785   0.11513  0.040688

# Some optimisation:
# MOLS> time ./laMols 6 data/SpecsCollection/Euler/red "" satd "" enu newv "" "" 1 6 "0,-6,1,-3,0" "" ""
# laMols 0.102.2 2bb2480c69433720ca3d41b3e51c375ef0d6ac4b
#   weights: 0 -6 1 -3 0 -> 0 0 0.015625 0.03125 0.00390625 0.00390625 0
#  N       rt  pl lbt  dis   lbo    lar gcd     satc           t        ppc st      nds      lvs          nsel         nsuel
#  6     satd dom enu newv   asc  relpr   1        0      14.782     414803  0     6089     3416  9.197708e-01  1.517129e+00
#   mu0    qfppc  pprunes  pmprune  pprobes  rounds  solc        tr  pelvals      dp
#122.66  0.52027   157.52   143.28   94.942  1.5896     0  0.014194   4.3018  6.9824
#    12        0        0   32.099   9.7403       1     0         0        0       0
#   310      2.5      900      200   307.87       5     0  0.073119   31.609      10
#83.384   0.6355   174.09   50.507   56.204  0.8011     0  0.014132    8.196  1.5812
#   mu0    qfppc  pprunes  pmprune  pprobes   rounds  solc         tr  pelvals      dp
#59.979   2.0179   1.0887   9.7467   29.342   1.0463     0  0.0025633   19.056  8.5176
#     8   1.1154        0        0   2.7586        1     0          0   2.7586       6
#   182        4   26.217   125.27   398.35        4     0   0.079622       25      11
#70.955  0.36858   3.4982   19.808   37.052  0.29276     0  0.0078636   8.2798  1.2939
#      estlvs       uestlvs
#6.305862e+03  1.127854e+04
#6.853716e+02  4.320000e+02
#4.600868e+04  9.331200e+04
#5.801651e+03  1.391790e+04
#   dm0        w  ltausp      minp     meanp     maxp       sdd        tb
#27.373   2.2776  3.0975   0.37953   0.45651  0.54986  0.079469  0.011656
#     0        2       1  0.014617      0.25     0.25         0         0
#   166        4  10.141       0.5       0.5  0.82443   0.34726  0.049114
#51.382  0.51694  2.2989   0.15901  0.077801  0.10959   0.11052  0.011732
# real	0m2.789s user	0m14.785s sys	0m0.505s
# Local optimum regarding lvs for changing one variable:
# MOLS> time ./laMols 6 data/SpecsCollection/Euler/red "" satd "" enu newv "" "" 1 12 "0,5,-6,4,0" "" ""
# laMols 0.102.2 2bb2480c69433720ca3d41b3e51c375ef0d6ac4b
#   weights: 0 5 -6 4 0 -> 0 0 32 0.5 8 8 0
#  N       rt  pl lbt  dis   lbo    lar gcd     satc           t        ppc st      nds      lvs          nsel         nsuel
#  6     satd dom enu newv   asc  relpr   1        0      29.206     345827  0     4821     2544  1.250262e+00  1.246283e+00
#   mu0    qfppc  pprunes  pmprune  pprobes   rounds  solc        tr  pelvals      dp
#152.78  0.71027   130.58   126.68   107.87   1.7576     0   0.05743   5.0217  7.1146
#    12        0        0   32.571   10.458        1     0         0        0       0
#   310        2      900      200    342.7        4     0   0.29285   28.249      11
#67.169  0.64708   186.95   41.528   67.471  0.76103     0  0.049723   7.7665  1.7284
#   mu0    qfppc  pprunes  pmprune  pprobes   rounds  solc        tr  pelvals      dp
#62.715   1.8638   6.3103   21.688   46.143   1.1171     0  0.017359   19.953  8.7437
#     8   1.0952        0        0   4.4304        1     0         0   3.6232       5
#   189        3      400   155.56   286.03        3     0   0.21906       25      12
#77.349  0.25391   31.443   37.144   49.662  0.35644     0  0.034439   7.0599   1.514
#      estlvs       uestlvs
#6.520663e+03  6.495396e+03
#5.869801e+02  5.120000e+02
#2.829427e+04  3.276800e+04
#7.175821e+03  6.330662e+03
#   dm0        w  ltausp      minp     meanp      maxp       sdd        tb
#  38.9   2.1168  13.746   0.43255   0.48379   0.53345  0.049632  0.044886
#     0        2       1   0.11375      0.25      0.25         0         0
#   173        4  53.251       0.5       0.5   0.78606   0.28606   0.15112
#58.168  0.42594   14.96  0.098665  0.057053  0.078801  0.065533  0.039872
# real	0m3.218s user	0m29.211s sys	0m2.937s
# Optimising for nds:
# MOLS> time ./laMols 6 data/SpecsCollection/Euler/red "" satd "" enu newv "" "" 1 12 "0,7,-3,4,0" "" ""
# laMols 0.102.2 2bb2480c69433720ca3d41b3e51c375ef0d6ac4b
#  N       rt  pl lbt  dis   lbo    lar gcd     satc           t        ppc st      nds      lvs          nsel         nsuel
#  6     satd dom enu newv   asc  relpr   1        0      25.680     355770  0     4837     2692  1.066395e+00  1.130475e+00
#   mu0    qfppc  pprunes  pmprune  pprobes   rounds  solc        tr  pelvals      dp
#142.47  0.70585   150.95   129.74   107.34   1.8191     0  0.053782   5.7247  7.1851
#    12        0        0   32.941   11.034        1     0         0        0       0
#   310        2      900      200   445.45        6     0   0.36303   35.829      10
#74.073  0.67865   206.26   45.201   72.806  0.94084     0  0.053209   9.3131   1.541
#   mu0    qfppc  pprunes  pmprune  pprobes   rounds  solc        tr  pelvals      dp
#60.747   1.9537   1.9671   12.736   39.147   1.0955     0  0.012717   19.762  8.6924
#     8     1.08        0        0   2.0134        1     0         0   2.0134       6
#   189        4      160   130.05   344.81        4     0   0.27305       25      11
#74.614  0.33168   7.8888   25.363   51.055  0.39996     0  0.034008   7.6962   1.291
#      estlvs       uestlvs
#5.753338e+03  6.132303e+03
#5.898341e+02  3.840000e+02
#2.613250e+04  2.457600e+04
#5.323166e+03  5.615545e+03
#   dm0        w  ltausp      minp     meanp     maxp       sdd        tb
#38.943   2.2545  5.3078   0.38667   0.46632  0.55261  0.079778  0.038242
#     0        2       1  0.068493      0.25     0.25         0         0
#   174        4  39.557       0.5       0.5   0.8068    0.3068   0.13291
# 56.36  0.63224  4.7871   0.13161  0.081656  0.11232  0.093931  0.037978
# real	0m2.862s user	0m25.682s sys	0m2.515s


# New standard of optimisation (MAX_TIME=600, rep=100):
# TAU/red_6_newv_ave> nomad np
# 256  1628.347884  -0.0165     9.97      -9.5       -0.02       2
# Blackbox evaluations: 410 Total model evaluations: 15783 Cache hits: 47 Total number of evaluations: 457
# Reproduction:
# TAU_red_6_newv_ave> ./TAUscan 6 ../red "" newv hash "-0.0165,9.97,-9.5,-0.02,2" 100 1 all
# 100 : 2.79146673410335744325e+02 1.62834788390386700496e+03 2.43343113179972744611e+04; 2.89150849165987571232e+03
# Testing:
# TAU_red_6_newv_ave> ./laMols 6 ../red "" count dom enu newv "" "" 1 1 "-0.0165,9.97,-9.5,-0.02,2" "" ""
#   weights: -0.0165 9.9700000000000000002 -9.5 -0.02 2 -> 0 -0.0165 1002.9263847290131161 1.3851094681109247189 1.366040256754395519 5.4641610270175820759 0
#  N       rt  pl lbt  dis   lbo    lar gcd     satc           t        ppc st      nds    inds      lvs     plvs
#  6    count dom enu newv   asc  relpr   1        0      14.626     383418  0     5925    2769     3156        0
#    mu0  qfppc  pprunes  pmprune  pprobes  rounds   solc     tr  pelvals      dp
#130.257  0.529  163.294  143.516  110.404   1.697  0.000  0.003    4.573   7.133
# 12.000  0.000    0.000   32.571    8.392   1.000  0.000  0.000    0.000   0.000
#310.000  2.500  900.000  200.000  588.021   8.000  0.000  0.017   40.625  11.000
# 84.830  0.614  198.466   46.863   79.297   0.984  0.000  0.003    8.643   1.660
#    mu0  qfppc  pprunes  pmprune  pprobes  rounds   solc     tr  pelvals      dp
# 57.710  1.902    1.789   13.833   44.883   1.122  0.000  0.001   20.809   8.782
#  8.000  1.120    0.000    0.000    3.125   1.000  0.000  0.000    3.125   5.000
#196.000  4.000   40.000  130.769  532.258   5.000  0.000  0.013   25.000  12.000
# 75.257  0.273    4.827   26.537   61.776   0.488  0.000  0.002    6.639   1.398
#    estlvs
# 41344.045
#   279.147
#372089.307
# 63652.730
#    mu1      w   ltau   minp  meanp   maxp    sdd     tb
# 73.606  2.139  0.076  0.429  0.481  0.532  0.051  0.002
# 12.000  2.000  0.000  0.048  0.200  0.250  0.000  0.000
#187.000  5.000  0.197  0.500  0.500  0.936  0.436  0.006
# 56.975  0.486  0.093  0.110  0.062  0.088  0.075  0.002
# Alright, but not as good as the above solutions; estimation is far off.
# Optimising ave+sd:
# TAU_red_6_newv_avepsd> nomad np
# 254  4014.11333   -0.9649     7.99      -5.1       -7          2.11
# Blackbox evaluations: 407 Total model evaluations: 13270 Cache hits: 74 Total number of evaluations: 481
# Reproduction:
# TAU_red_6_newv_avepsd> ./TAUscan 6 ../red "" newv hash "-0.9649,7.99,-5.1,-7,2.11" 100 1 all
# 100 : 3.56084638063810921732e+02 1.99571857197736176515e+03 1.27328991403001443103e+04; 2.01839475811699688113e+03
# Testing:
# TAU_red_6_newv_avepsd> ./laMols 6 ../red "" count dom enu newv "" "" 1 1 "-0.9649,7.99,-5.1,-7,2.11" "" ""
#   N       rt  pl lbt  dis   lbo    lar gcd     satc           t        ppc st      nds    inds      lvs     plvs
#  6    count dom enu newv   asc  relpr   1        0      14.396     374534  0     5781    2721     3060        0
#    mu0  qfppc  pprunes  pmprune  pprobes  rounds   solc     tr  pelvals      dp
#133.212  0.555  156.807  141.206  109.693   1.697  0.000  0.002    4.446   7.149
# 12.000  0.000    0.000   33.987    7.759   1.000  0.000  0.000    0.000   0.000
#310.000  4.000  900.000  200.000  485.165   6.000  0.000  0.012   36.757  11.000
# 83.026  0.633  199.786   47.139   74.198   0.919  0.000  0.002    8.118   1.662
#    mu0  qfppc  pprunes  pmprune  pprobes  rounds   solc     tr  pelvals      dp
# 56.999  1.900    2.153   14.188   46.333   1.133  0.000  0.001   21.010   8.818
#  8.000  1.125    0.000    0.000    3.125   1.000  0.000  0.000    3.125   5.000
#196.000  4.000  233.333  130.769  532.258   5.000  0.000  0.013   25.000  12.000
# 75.236  0.276   10.142   27.117   62.777   0.498  0.000  0.002    6.415   1.388
#   estlvs
#12134.613
#  356.085
#92312.672
#15893.730
#    mu1      w     ltau   minp  meanp   maxp    sdd     tb
# 74.340  2.124   24.179  0.432  0.483  0.533  0.049  0.002
# 12.000  2.000    0.000  0.049  0.250  0.250  0.000  0.000
#187.000  4.000  271.561  0.500  0.500  0.841  0.341  0.006
# 57.108  0.438   41.184  0.105  0.059  0.083  0.071  0.002
# Likely basically the same.

# Alternative optimisation on max (MAX_TIME=600, rep=100):
# TAU_red_6_newv_max> nomad np
# 309  8714.146177   0.05127   -2.9997     0.0068    -1.93      -0.0086
# Blackbox evaluations: 349 Total model evaluations: 30185 Cache hits: 42 Total number of evaluations: 391
# Reproduction:
# TAU_red_6_newv_max> time ./TAUscan 6 ../red "" newv hash "0.05127,-2.9997,0.0068,-1.93,-0.0086" 100 1 all
# 100 : 7.99455925130492515263e+02 3.11159289904937045579e+03 8.71414617692487977418e+03; 2.26793566149185951608e+03
# real    0m12.597s user    0m12.361s sys     0m0.245s
# TAU_red_6_newv_max> time ./laMols 6 ../red "" count dom enu newv "" "" 1 1 "0.05127,-2.9997,0.0068,-1.93,-0.0086" "" ""
#  N       rt  pl lbt  dis   lbo    lar gcd     satc           t        ppc st      nds    inds      lvs     plvs
#  6    count dom enu newv   asc  relpr   1        0      19.287     447066  0     6265    2649     3616        0
#    mu0  qfppc  pprunes  pmprune  pprobes  rounds   solc     tr  pelvals      dp
#122.436  0.504  147.332  145.004  102.228   1.618  0.000  0.004    4.255   6.922
# 12.000  0.000    0.000   32.099    8.497   1.000  0.000  0.000    0.000   0.000
#310.000  2.500  900.000  200.000  306.742   5.000  0.000  0.017   31.792  10.000
# 84.753  0.628  162.417   49.915   62.131   0.857  0.000  0.004    8.378   1.542
#    mu0  qfppc  pprunes  pmprune  pprobes  rounds   solc     tr  pelvals      dp
# 60.491  2.044    1.079    8.896   27.928   1.045  0.000  0.001   18.713   8.451
#  8.000  1.125    0.000    0.000    2.586   1.000  0.000  0.000    2.586   6.000
#182.000  5.000   45.000  125.275  392.308   4.000  0.000  0.018   25.000  11.000
# 70.282  0.397    3.608   18.864   36.127   0.292  0.000  0.002    8.553   1.234
#      estlvs
#6.377921e+03
#7.994559e+02
#3.839538e+04
#5.423527e+03
#    mu1      w   ltau   minp  meanp   maxp    sdd     tb
# 69.899  2.365  0.133  0.368  0.443  0.529  0.074  0.003
# 12.000  2.000  0.011  0.019  0.250  0.250  0.000  0.000
#187.000  4.000  0.573  0.500  0.500  0.812  0.328  0.011
# 56.032  0.558  0.081  0.163  0.084  0.111  0.106  0.003
# real    0m19.307s user    0m19.294s sys     0m0.013s
# Similar to above.

# Alternative optimisation on sd (MAX_TIME=600, rep=100)::
# TAU_red_6_newv_sd> nomad np
# 298 1657.496578  -0.39       1         -5          6         -2.01
# Blackbox evaluations: 351 Total model evaluations: 36274 Cache hits: 27 Total number of evaluations: 378
# Reproduction:
# TAU_red_6_newv_sd> time ./TAUscan 6 ../red "" newv hash "-0.39,1,-5,6,-2.01" 100 1 all
# 100 : 6.59141666657975251742e+02 2.46957146111985421522e+03 1.00539640975586482519e+04; 1.65749657763998709592e+03
# real    0m12.954s user    0m12.662s sys     0m0.305s
# TAU_red_6_newv_sd> time ./laMols 6 ../red "" count dom enu newv "" "" 1 1 "-0.39,1,-5,6,-2.01" "" ""
#  N       rt  pl lbt  dis   lbo    lar gcd     satc           t        ppc st      nds    inds      lvs     plvs
#  6    count dom enu newv   asc  relpr   1        0      18.860     355026  0     5261    2285     2976        0
#    mu0  qfppc  pprunes  pmprune  pprobes  rounds   solc     tr  pelvals      dp
#127.873  0.550  162.640  142.023  108.440   1.711  0.000  0.004    4.891   7.300
# 12.000  0.000    0.000   27.473   10.417   1.000  0.000  0.000    0.000   0.000
#310.000  2.000  900.000  200.000  445.455   6.000  0.000  0.021   37.500  12.000
# 84.172  0.609  203.607   50.087   69.037   0.937  0.000  0.004    9.088   1.720
#    mu0  qfppc  pprunes  pmprune  pprobes  rounds   solc     tr  pelvals      dp
# 66.794  1.956    1.841   12.707   35.160   1.071  0.000  0.001   18.906   8.663
#  8.000  1.080    0.000    0.000    3.175   1.000  0.000  0.000    2.797   5.000
#189.000  4.000  160.000  130.055  344.809   4.000  0.000  0.016   25.000  13.000
# 75.669  0.375    7.509   23.075   43.550   0.337  0.000  0.002    8.153   1.549
#      estlvs
#5.534176e+03
#6.060262e+02
#2.174510e+04
#4.662736e+03
#    mu1      w   ltau   minp  meanp   maxp    sdd     tb
# 71.287  2.302  0.773  0.399  0.459  0.527  0.059  0.003
# 12.000  2.000  0.013  0.042  0.250  0.250  0.000  0.000
#187.000  4.000  4.442  0.500  0.500  0.867  0.367  0.011
# 56.174  0.666  0.985  0.144  0.087  0.100  0.089  0.003
# real    0m18.876s user    0m18.864s sys     0m0.012s
# Similar to above.

# Absolute optimisation on lvs:
# LVS_red_6_newv$ nomad np
# A termination criterion is reached: No termination (all). Mesh minimum precision reached (Algo)
# Best feasible solution: #19672 ( -0.91 3 -5 6 3 ) Evaluation OK f = 2856 h =   0
# Blackbox evaluations: 1046 Total model evaluations: 61513 Cache hits: 334 Total number of evaluations: 1380
# LVS_red_6_newv$ ./laMols 6 ../red "" count dom enu newv "" "" 1 1 "-0.91,3,-5,6,3" "" ""
#  N       rt  pl lbt  dis   lbo    lar gcd     satc           t        ppc st      nds    inds      lvs     plvs
#  6    count dom enu newv   asc  relpr   1        0      10.832     341082  0     5069    2213     2856        0
#    mu0  qfppc  pprunes  pmprune  pprobes  rounds   solc     tr  pelvals      dp
#133.154  0.571  152.662  139.945  111.119   1.716  0.000  0.002    4.787   7.239
# 12.000  0.000    0.000   27.473   10.417   1.000  0.000  0.000    0.000   0.000
#310.000  2.200  900.000  200.000  445.455   6.000  0.000  0.012   35.829  12.000
# 82.989  0.615  203.690   49.974   71.533   0.949  0.000  0.002    8.973   1.704
#    mu0  qfppc  pprunes  pmprune  pprobes  rounds   solc     tr  pelvals      dp
# 68.710  1.953    1.834   12.808   35.529   1.072  0.000  0.001   18.878   8.622
#  8.000  1.080    0.000    0.000    3.175   1.000  0.000  0.000    2.797   5.000
#189.000  4.000  160.000  130.055  344.809   4.000  0.000  0.009   25.000  13.000
# 76.892  0.379    7.541   22.789   41.761   0.317  0.000  0.001    8.061   1.526
#      estlvs
#5.517101e+03
#5.830844e+02
#2.600631e+04
#5.284374e+03
#    mu1      w     ltau   minp  meanp   maxp    sdd     tb
# 73.330  2.290   21.178  0.399  0.462  0.528  0.060  0.002
# 12.000  2.000    0.004  0.046  0.250  0.250  0.000  0.000
#187.000  4.000  335.748  0.500  0.500  0.865  0.365  0.005
# 56.762  0.668   50.798  0.142  0.086  0.106  0.091  0.002
# Similar to above.

# Rerunning with version >= 0.99:

# MOLS> ./laMols 6 data/SpecsCollection/Euler/red "" count dom enu newv "" "" 1 1 "-0.91,3,-5,6,3" "" ""
#  N       rt  pl lbt  dis   lbo    lar gcd     satc           t        ppc st      nds      lvs          nsel         nsuel
#  6    count dom enu newv   asc  relpr   1        0      11.101     339118  0     4437     2540  9.557417e-01  1.186970e+00
#   mu0    qfppc  pprunes  pmprune  pprobes   rounds  solc         tr  pelvals      dp
#155.94  0.86491   121.51   122.35   115.04   1.9573     0    0.00289   5.9888   6.952
#    12        0        0   27.473    11.94        1     0          0        0       0
#   310        2      900      200   445.45        6     0   0.012899   35.829      11
#64.873  0.65379   181.51   39.974   76.872  0.92764     0  0.0023135   9.3256  1.5604
#   mu0    qfppc  pprunes  pmprune  pprobes   rounds  solc          tr  pelvals      dp
#74.427   1.9452   4.8965   16.274   37.166   1.0874     0  0.00064354   18.053  8.3386
#     8     1.08        0        0   3.1746        1     0           0   3.1056       5
#   189        4      450   155.56   344.81        4     0    0.009814       25      12
#77.857  0.38976   30.323   29.056   46.936  0.36193     0    0.001452   8.2567  1.3379
#      estlvs       uestlvs
#4.860143e+03  6.118602e+03
#6.298942e+02  3.840000e+02
#2.502846e+04  4.915200e+04
#4.716568e+03  8.635684e+03
#   dm0        w  ltausp      minp     meanp     maxp       sdd         tb
#43.009   2.3384  13.412   0.38005   0.45524  0.53582  0.073378  0.0020537
#     0        2       1  0.046471      0.25     0.25         0          0
#   174        4  141.16       0.5       0.5  0.81252   0.31252   0.005529
#57.044  0.70961  17.849   0.14291  0.091496   0.1125  0.091164  0.0017333
# Lower leaf-count.

# Absolute optimisation on lvs:
# LVS/red_6_newv$ nomad np
#  74 2540          0          7         -9         10        -10
# 236 2520          0.06       6.95      -9.06       9.68      -9.5
# A termination criterion is reached: No termination (all). Mesh minimum precision reached (Algo)
# Best feasible solution:     #41694 ( -0.05 7.01 -8.98 9.5 -10 ) Evaluation OK    f = 2520
# Blackbox evaluations: 1125 Total model evaluations: 66721 Cache hits: 482 Total number of evaluations: 1607
# LVS/red_6_newv$ ./laMols 6 ../../red "" count dom enu newv "" "" 1 1 "-0.05,7.01,-8.98,9.5,-10" "" ""
#  N       rt  pl lbt  dis   lbo    lar gcd     satc           t        ppc st      nds      lvs          nsel         nsuel
#  6    count dom enu newv   asc  relpr   1        0      11.842     333415  0     4541     2520  1.042358e+00  1.038648e+00
#   mu0    qfppc  pprunes  pmprune  pprobes   rounds  solc         tr  pelvals      dp
#154.79  0.85344   116.48   125.44   120.05   1.9505     0   0.002818   5.7032  6.9095
#    12        0        0   32.941   12.903        1     0    1.4e-05        0       0
#   310        2   845.45      200   445.45        6     0   0.011789   35.829      10
# 66.57  0.62578   164.72   40.732   78.993  0.91388     0  0.0022814   8.9138  1.4338
#   mu0    qfppc  pprunes  pmprune  pprobes   rounds  solc          tr  pelvals      dp
#72.646   1.9209   4.2575   16.673   40.181   1.0925     0  0.00067281   18.654  8.3698
#     8     1.08        0        0   3.5088        1     0       2e-06   2.7972       5
#   189        4      400   155.56   344.81        4     0    0.008904       25      11
#78.838  0.33487   26.061   29.966   49.201  0.38607     0   0.0014406   7.9167  1.2339
#      estlvs       uestlvs
#5.258004e+03  5.238552e+03
#6.067722e+02  3.840000e+02
#2.774347e+04  2.457600e+04
#4.998297e+03  4.404721e+03
#   dm0        w  ltausp      minp     meanp     maxp       sdd         tb
#38.785   2.2464  94.317   0.38676   0.46821  0.55133  0.079106  0.0021659
#     0        2       1  0.048644      0.25     0.25         0          0
#   174        4  1245.2       0.5       0.5  0.77464   0.27464   0.007488
#56.035  0.63919  170.76   0.13162  0.081305  0.10896  0.088875  0.0017338

# Optimisation on ave (MAX_TIME=600, rep=100):
# TAU/red_6_newv_ave> nomad np
#  65 1469.233671   0         10        -10        -10         10
# 427 1298.348134   0.985256   9.9852   -10.0       -9.89      10.0
# A termination criterion is reached: Maximum allowed time reached (Base) No more points to evaluate
# Blackbox evaluations: 572 Total model evaluations: 54448 Cache hits: 96 Total number of evaluations: 668
# TAU/red_6_newv_ave$ ./laMols 6 ../../red "" count dom enu newv "" "" 1 1 "0.985256,9.9852,-10,-9.89,10" "" ""
#  N       rt  pl lbt  dis   lbo    lar gcd     satc           t        ppc st      nds      lvs          nsel         nsuel
#  6    count dom enu newv   asc  relpr   1        0      14.758     376474  0     5241     2796  3.747509e+00  1.220890e+00
#   mu0    qfppc  pprunes  pmprune  pprobes   rounds  solc         tr  pelvals      dp
#150.46  0.70017   130.39   130.79   116.51   1.8434     0  0.0028026   5.2048  6.9252
#    12        0        0   31.034   8.9041        1     0    1.2e-05        0       0
#   310      2.5      900      200   588.02        8     0    0.01605   40.625      11
#72.523  0.63791   177.66   41.791   79.397  0.95457     0  0.0023873   8.5759  1.6387
#   mu0    qfppc  pprunes  pmprune  pprobes   rounds  solc          tr  pelvals      dp
#64.471   1.8899   4.1392   17.024   46.829   1.1327     0  0.00081153   20.006  8.5694
#     8    1.129        0        0    3.125        1     0       2e-06    3.125       5
#   196        4      450   155.56   532.26        5     0    0.013337       25      12
#77.528  0.28084   25.336    31.12   62.917  0.49893     0    0.001811   6.9656  1.3783
#      estlvs       uestlvs
#4.206252e+04  6.963639e+03
#2.834225e+02  5.120000e+02
#2.683176e+05  3.276800e+04
#5.857425e+04  6.580363e+03
#   dm0        w  ltausp      minp     meanp      maxp       sdd         tb
#35.486   2.1431  63.962   0.41611    0.4804   0.54307  0.062145  0.0022712
#     0        2       1  0.047461      0.25      0.25         0    3.8e-05
#   173        4    1524       0.5       0.5   0.94742   0.44742   0.009359
#55.663  0.47434  107.42   0.11462  0.062841  0.095485  0.081324  0.0018969
# As before, the solution found is somewhat "misleading", but the final result
# is better than before (for versions < 0.99).

# Alternative optimisation, using uniform probabilities:
# TAU/red_6_newv_ave> nomad nprand
# 249 1943.04      -0.9131     3.5       -4         -8.24      -5.64
# A termination criterion is reached: Maximum allowed time reached (Base) No more points to evaluate
# Blackbox evaluations: 589 Total model evaluations: 53947 Cache hits: 155 Total number of evaluations: 744
# TAU/red_6_newv_ave$ ./laMols 6 ../../red "" count dom enu newv "" "" 1 1 "-0.9131,3.5,-4,-8.24,-5.64" "" ""
#  N       rt  pl lbt  dis   lbo    lar gcd     satc           t        ppc st      nds      lvs          nsel         nsuel
#  6    count dom enu newv   asc  relpr   1        0      14.550     378181  0     5097     2720  1.386065e+00  1.239991e+00
#   mu0    qfppc  pprunes  pmprune  pprobes  rounds  solc         tr  pelvals      dp
#159.26  0.75596   114.98   124.42   113.96  1.8376     0  0.0027862   5.0405   6.918
#    12        0        0   32.335   8.3916       1     0    1.3e-05        0       0
#   310   2.3333      900      200   485.71       6     0   0.012667    36.41      11
#64.331  0.65395   169.21   39.419   74.081  0.8447     0  0.0021663   8.1039  1.6521
#   mu0    qfppc  pprunes  pmprune  pprobes   rounds  solc          tr  pelvals      dp
#67.622    1.888   3.6412   18.025    46.43   1.1313     0  0.00081328   19.671  8.6015
#     8   1.1364        0        0   3.5461        1     0       2e-06   3.5294       5
#   196        5      300   155.56   527.96        5     0    0.013382       25      12
#78.045  0.30802   18.574   31.963    61.95  0.48446     0   0.0017792   7.1358   1.362
#      estlvs       uestlvs
#7.945597e+03  6.902212e+03
#4.509724e+02  5.120000e+02
#4.980385e+04  3.276800e+04
#9.922202e+03  7.594117e+03
#   dm0        w  ltausp      minp     meanp      maxp       sdd         tb
#38.782   2.1439  10.809   0.40953   0.47998   0.55006  0.068786  0.0023691
#     0        2       1  0.053563      0.25      0.25         0    3.8e-05
#   174        4  46.847       0.5       0.5   0.83552   0.33552   0.005315
#57.664  0.46728  9.3573    0.1148  0.062671  0.098813   0.08486   0.001854
# Much lower variance than the solution found by tau-probabilities, but number of leaves very similar.

# Optimisation on ave+sd:

# TAU-probs:
# TAU/red_6_newv_avepsd$ nomad np
# 674 3214.650419  -0.235808   9.293981  -2.191164  -7.247938   7.845702
# A termination criterion is reached: No termination (all). Mesh minimum precision reached (Algo)
# Blackbox evaluations: 1120 Total model evaluations: 94494 Cache hits: 400 Total number of evaluations: 1520
# TAU/red_6_newv_avepsd$ time ./TAUscan 6 ../../red "" enu newv hash "-0.235808,9.293981,-2.191164,-7.247938,7.845702" 100 1 all
# 100 : 4.13663899530751201949e+02 3.25533090851195688820e+03 1.99056544020467929581e+04; 3.75768428564799614477e+03
# real    0m7.773s user    0m7.631s sys     0m0.132s
# TAU/red_6_newv_avepsd$ ./laMols 6 ../../red "" count dom enu newv "" "" 1 1 "-0.235808,9.293981,-2.191164,-7.247938,7.845702" "" ""
#  N       rt  pl lbt  dis   lbo    lar gcd     satc           t        ppc st      nds      lvs          nsel         nsuel
#  6    count dom enu newv   asc  relpr   1        0      14.477     350655  0     5301     2720  1.267125e+00  1.173378e+00
#   mu0    qfppc  pprunes  pmprune  pprobes   rounds  solc         tr  pelvals      dp
#144.12   0.6963   138.46   133.66   113.57   1.8276     0  0.0025901   4.6394  7.4204
#    12        0        0   27.746   10.227        1     0          0        0       0
#   310        2      900      200   396.81        5     0   0.010104   32.335      11
#72.177  0.62798   184.88   39.933   72.028  0.86002     0  0.0021354   7.7611  1.8297
#   mu0    qfppc  pprunes  pmprune  pprobes   rounds  solc          tr  pelvals      dp
#60.821   1.8728   2.6379   15.915   47.455    1.143     0  0.00081263   20.444  9.2221
#     8     1.12        0        0   5.5556        1     0           0   4.6053       6
#   187        3      350   155.56   412.83        4     0    0.011264       25      12
#76.157  0.24481   11.664   30.574   62.678  0.49245     0   0.0018427   6.7013  1.4753
#      estlvs       uestlvs
#7.087249e+03  6.464941e+03
#4.136639e+02  3.840000e+02
#4.439396e+04  2.457600e+04
#7.950176e+03  6.296597e+03
#   dm0        w  ltausp      minp     meanp      maxp       sdd         tb
# 30.69   2.0535  4.7697   0.42904    0.4919   0.55571  0.063018  0.0021326
#     0        2       1   0.12237      0.25      0.25         0          0
#   175        4  32.245       0.5       0.5   0.74769   0.24769   0.010795
#51.323  0.26459   3.236  0.087502  0.038567  0.081017  0.075331  0.0017153
# Slightly better than for ave.

# Uni-probs:
# TAU/red_6_newv_avepsd$ nomad nprand
# 533 3596.402128   0.041285   4.625004  -8.777577  -6.21053    8.702014
# A termination criterion is reached: No termination (all). Mesh minimum precision reached (Algo)
# Blackbox evaluations: 1207 Total model evaluations: 103572  Cache hits: 390 Total number of evaluations: 1597
# TAU/red_6_newv_avepsd$ time ./TAUscan 6 ../../red "" enu,rand newv hash "0.041285,4.625004,-8.777577,-6.21053,8.702014" 100 1 all
# 100 : 5.12000000000000000000e+02 3.77343999999999999995e+03 3.27680000000000000000e+04; 5.29124469960623831222e+03
# real    0m7.351s user    0m7.205s sys     0m0.138s
# TAU/red_6_newv_avepsd$ ./laMols 6 ../../red "" count dom enu newv "" "" 1 1 "0.041285,4.625004,-8.777577,-6.21053,8.702014" "" ""
#  N       rt  pl lbt  dis   lbo    lar gcd     satc           t        ppc st      nds      lvs          nsel         nsuel
#  6    count dom enu newv   asc  relpr   1        0      14.731     377658  0     5157     2748  1.909712e+00  1.220181e+00
#   mu0    qfppc  pprunes  pmprune  pprobes   rounds  solc         tr  pelvals      dp
#154.67  0.76812      126   127.05   116.03   1.8792     0  0.0028273    5.203  6.9191
#    12        0        0   32.571   8.3916        1     0          0        0       0
#   310      2.5      900      200   485.16        6     0   0.012332   36.757      11
#  67.8  0.65306   178.43    39.87   78.831  0.89708     0  0.0023168   8.3851  1.6248
#   mu0   qfppc  pprunes  pmprune  pprobes   rounds  solc          tr  pelvals      dp
#64.562  1.8852   4.3472   18.069   47.002   1.1325     0  0.00082631   19.873  8.5793
#     8    1.12        0        0    3.125        1     0       2e-06    3.125       5
#   196       4      400   155.56   532.26        5     0    0.013445       25      12
#77.334   0.284   23.078   32.504   64.673  0.51472     0   0.0018616   7.1079  1.3402
#      estlvs       uestlvs
#1.276996e+04  6.839336e+03
#3.391557e+02  5.120000e+02
#8.012392e+04  3.276800e+04
#1.650952e+04  6.922105e+03
#   dm0        w  ltausp      minp     meanp      maxp       sdd         tb
#37.715   2.1403  46.433    0.4165   0.48052    0.5432  0.062028  0.0023102
#     0        2       1  0.047347      0.25      0.25         0    3.8e-05
#   179        4  206.76       0.5       0.5    0.8219    0.3219   0.008588
#56.151  0.46317  54.144   0.11048  0.062012  0.091966  0.077453  0.0018716


# Only using "rred A" (instead of "red A"):

# MOLS> time ./laMols 6 "@squares A B aux\nrred A B aux\nls A B aux\nrprod B aux A\n" "" count dom enu newv "" "" 1 16 "" "" ""
#  N       rt  pl lbt  dis   lbo    lar gcd     satc           t        ppc st      nds      lvs          nsel         nsuel
#   weights: Z -> 0 0 0 0 0 0 0
#  6    count dom enu newv   asc  relpr   1        0   12051.655   66385819  0  1236843   722840  4.160366e+00  3.412009e+00
#   weights: O -> 0 0 1 1 1 1 1
#  6    count dom enu newv   asc  relpr   1        0    9499.034   54267132  0   816513   448581  1.268593e+00  1.973747e+00
#   weights: A -> 0 0 1 2 3 4 5
#  6    count dom enu newv   asc  relpr   1        0   12291.091   57961377  0   857946   489230  1.988952e+00  2.014213e+00
#   weights: L -> 0 0 1 1.5849625007211561815 2 2.3219280948873623478 2.5849625007211561815
#  6    count dom enu newv   asc  relpr   1        0   10216.759   52722019  0   724666   390720  1.021209e+00  1.534207e+00

# Optimising ave, with MAX_TIME=20000, rep=1000:
# rred_6_newv_ave$ nomad np
# 735 182656.694152  -0.98       8.999993 -10.0       -1.999998  -6.000006
# A termination criterion is reached: No termination (all). Mesh minimum precision reached (Algo)
# Blackbox evaluations: 1158 Total model evaluations: 101135 Cache hits: 287 Total number of evaluations: 1445
# TAU/rred_6_newv_ave> time ./TAUscan 6 "@squares A B aux\nrred A B aux\nls A B aux\nrprod B aux A\n" "" enu newv hash "-0.98,8.999993,-10.0,-1.999998,-6.000006" 1000 10 all
# 1000 : 7.15733294001704586673e+03 2.97568999386546716210e+05 1.42639486419166222659e+07; 1.10496925943753131696e+06
# real    0m12.505s user    2m1.363s sys     0m1.348s
# TAU/rred_6_newv_ave$ time ./laMols 6 "@squares A B aux\nrred A B aux\nls A B aux\nrprod B aux A\n" "" count dom enu newv "" "" 1 16 "-0.98,8.999993,-10.0,-1.999998,-6.000006" "" ""
#  N       rt  pl lbt  dis   lbo    lar gcd     satc           t        ppc st      nds      lvs          nsel         nsuel
#  6    count dom enu newv   asc  relpr   1        0    5275.465   45559368  0   618586   330480  7.869121e+00  1.360173e+00
#   mu0   qfppc  pprunes  pmprune  pprobes  rounds  solc       tr  pelvals      dp
#156.42   0.774   131.15   129.51   118.88  1.9176     0   0.1189   5.2043  10.856
#    12       0        0   26.144   7.6923       1     0        0        0       0
#   360       3     1100      200   595.83       8     0  0.89618   40.625      15
#72.339  0.6475   181.06   37.972   81.453  0.9432     0  0.10535   8.4457  1.7728
#   mu0    qfppc  pprunes  pmprune  pprobes   rounds  solc        tr  pelvals      dp
#69.954   1.8836   6.2449   19.102   46.677   1.1407     0  0.031669   19.037  12.516
#     8   1.0667        0        0   1.4184        1     0         0   1.4184       9
#   212        5      550   155.56   579.27        6     0   0.83103    25.49      16
#78.866  0.28756   34.192   33.796   63.371  0.50324     0  0.072568    7.555   1.478
#      estlvs       uestlvs
#2.079481e+07  9.418918e+05
#7.157333e+03  4.608000e+04
#2.812770e+08  5.529600e+06
#4.040027e+07  1.024319e+06
#   dm0        w  ltausp       minp     meanp     maxp       sdd        tb
#34.722   2.1471   445.5    0.41241   0.48024  0.54852   0.06659   0.08894
#     0        2       1  0.0051076       0.2      0.2         0         0
#   194        5  2184.2        0.5       0.5  0.98655   0.48655   0.40055
#52.943  0.49557   542.1      0.117  0.063572  0.10007  0.086636  0.074861
# real    14m49.428s user    87m55.479s sys     98m34.193s
# Optimising with uniform probabilities:
# rred_6_newv_ave$ nomad nprand
# 146 289964.16      -0.6        3         -8         -5          1
# A termination criterion is reached: No termination (all). Mesh minimum precision reached (Algo)
# Blackbox evaluations: 1035 Total model evaluations: 92586 Cache hits: 129 Total number of evaluations: 1164
# TAU/rred_6_newv_ave> time ./TAUscan 6 "@squares A B aux\nrred A B aux\nls A B aux\nrprod B aux A\n" "" enu,rand newv hash "-0.6,3,-8,-5,1" 1000 10 all
# 1000 : 4.60800000000000000000e+04 2.89964159999999999997e+05 5.52960000000000000000e+06; 3.81824325259214010231e+05
# real    0m12.076s user    1m57.478s sys     0m1.323s
# TAU/rred_6_newv_ave$ time ./laMols 6 "@squares A B aux\nrred A B aux\nls A B aux\nrprod B aux A\n" "" count dom enu newv "" "" 1 16 "-0.6,3,-8,-5,1" "" ""
#  N       rt  pl lbt  dis   lbo    lar gcd     satc           t        ppc st      nds      lvs          nsel         nsuel
#  6    count dom enu newv   asc  relpr   1        0    5358.043   45468276  0   618586   330480  3.256255e+00  1.360173e+00
#   mu0    qfppc  pprunes  pmprune  pprobes   rounds  solc       tr  pelvals      dp
#156.42  0.77251   131.13   129.69   119.61   1.9189     0  0.12552   5.1978  10.856
#    12        0        0   26.144   7.6923        1     0        0        0       0
#   360        4     1100      200   598.44        8     0   1.1228   41.146      15
#72.339  0.64626   181.73   37.859   82.109  0.94253     0  0.11196   8.4176  1.7728
#   mu0    qfppc  pprunes  pmprune  pprobes   rounds  solc        tr  pelvals      dp
# 69.95   1.8851   6.3538   18.539   46.549   1.1403     0  0.033059    19.03  12.516
#     8   1.0476        0        0   1.4184        1     0         0   1.4184       9
#   212        5      550   155.56   588.08        6     0   0.93223       25      16
#78.862  0.28705   37.469   32.848   62.964  0.49881     0  0.075706   7.5713   1.478
#      estlvs       uestlvs
#3.834625e+06  9.418918e+05
#1.027382e+04  4.608000e+04
#4.122689e+07  5.529600e+06
#6.525821e+06  1.024319e+06
#   dm0        w  ltausp      minp     meanp      maxp       sdd        tb
#34.718   2.1471  115.45   0.41274   0.48024   0.54815  0.066233  0.093179
#     0        2       1  0.031952       0.2       0.2         0         0
#   194        5  610.12       0.5       0.5   0.92925   0.42925   0.42672
#52.941  0.49557  138.73   0.11626  0.063572  0.098986  0.085521  0.078806
# real    14m59.001s user    89m18.052s sys     106m22.177s
# Apparently the same tree(!), but different details regarding the distance.

# Using the old weights obtained by tau-probabilities:
# TAU/rred_6_newv_ave$ time ./laMols 6 "@squares A B aux\nrred A B aux\nls A B aux\nrprod B aux A\n" "" count dom enu newv "" "" 1 16 "0.985256,9.9852,-10,-9.89,10" "" ""
#  N       rt  pl lbt  dis   lbo    lar gcd     satc           t        ppc st      nds      lvs          nsel         nsuel
#  6    count dom enu newv   asc  relpr   1        0    4244.912   55130723  0   793646   436800  1.492849e+00  1.844058e+00
#   mu0    qfppc  pprunes  pmprune  pprobes   rounds  solc        tr  pelvals      dp
#124.78   0.4875   166.89   145.01   96.735   1.5569     0  0.082397   3.8463  11.493
#    12        0        0   28.177   8.0292        1     0         0        0       0
#   360        4      900      200   359.67        5     0   0.61774   36.782      16
#83.676  0.62302   193.23   47.941   60.721  0.79111     0    0.0847   7.6486  1.8958
#   mu0    qfppc  pprunes  pmprune  pprobes   rounds  solc        tr  pelvals      dp
#58.673   2.0098  0.80017   8.3299   27.486   1.0165     0   0.01071   19.224  13.124
#     8   1.0526        0        0   1.4599        1     0         0   1.4599       9
#   189        5      140   108.57   291.62        3     0   0.44734       25      17
#70.626  0.34472   2.8623   17.152   23.961  0.14559     0  0.029311   8.2164  1.5811
#      estlvs       uestlvs
#1.410251e+06  1.922161e+06
#4.331691e+04  4.608000e+04
#8.103175e+06  1.769472e+07
#1.533805e+06  3.323748e+06
#   dm0        w  ltausp      minp     meanp      maxp       sdd        tb
# 24.43   2.2241   7.149   0.40152   0.46807   0.54219  0.066435  0.072046
#     0        2       1  0.037811       0.2       0.2         0         0
#   169        5  757.39       0.5       0.5   0.84418   0.34418   0.39709
#49.048  0.55109  11.303   0.13978  0.075199  0.099241  0.094007  0.070066
# real    12m35.796s user    70m44.919s sys     97m44.119s
# Clearly worse (leaf-wise).
# And using the old weights obtained by uniform probabilities:
# TAU/rred_6_newv_ave$ time ./laMols 6 "@squares A B aux\nrred A B aux\nls A B aux\nrprod B aux A\n" "" count dom enu newv "" "" 1 16 "-0.9131,3.5,-4,-8.24,-5.64" "" ""
# N       rt  pl lbt  dis   lbo    lar gcd     satc           t        ppc st      nds      lvs          nsel         nsuel
# 6    count dom enu newv   asc  relpr   1        0    5291.446   45784783  0   624386   330000  1.325897e+00  1.579052e+00
#   mu0    qfppc  pprunes  pmprune  pprobes   rounds  solc       tr  pelvals      dp
#159.19  0.77848   121.04   126.75   116.93   1.8988     0  0.11877   5.0072  10.671
#    12        0        0   27.746   7.7586        1     0        0        0       0
#   360        3      900      200   542.16        7     0  0.87116   37.766      16
#69.325  0.63727   169.37   38.667   75.412  0.87112     0  0.10057   7.8353  1.9063
#   mu0    qfppc  pprunes  pmprune  pprobes   rounds  solc        tr  pelvals      dp
#68.377    1.886   4.2947    16.88   43.971    1.108     0  0.028665   19.588  12.352
#     8     1.05        0        0   1.4599        1     0         0   1.4599       8
#   211        5      450   155.56   536.02        5     0   0.77229   25.126      17
#78.669  0.29437    27.69   30.356   54.076  0.42478     0  0.063888   7.2159  1.6328
#      estlvs       uestlvs
#9.101408e+05  1.152824e+06
#5.252370e+04  3.840000e+04
#7.145738e+06  1.105920e+07
#1.154683e+06  1.695619e+06
#   dm0       w  ltausp      minp    meanp      maxp       sdd        tb
#36.414   2.121  11.318   0.41454  0.48323   0.55166   0.06722  0.091232
#     0       2       1  0.039644      0.2       0.2         0         0
#   197       5  158.73       0.5      0.5   0.83557   0.33557   0.41785
#56.225  0.4335  11.367   0.10909  0.05796  0.094158  0.082254  0.076031
# real    14m26.930s user    88m11.458s sys     96m14.364s
# Basically the same as the solutions obtained by optimisation on the problem itself.


# N=7:

# Optimising TAUscan via Nomad (MAX_TIME 10000s, rep=1000):
# TAU_red_7_newv_ave> nomad np
# 358 10607353.930405  -1          5.75     -10          2.16       0.06     -10
# Blackbox evaluations: 1042 Total model evaluations: 93005 Cache hits: 292 Total number of evaluations: 1334
# MOLS> time ./TAUscan 7 data/SpecsCollection/Euler/red "" enu newv hash "-1,5.75,-10,2.16,0.06,-10" 1000 10 all
# 1000 : 6.27047811343901473791e+04 1.06073539304050722776e+07 8.48896741307919180777e+08; 3.48422400329753089209e+07
# real    0m49.350s user    8m2.517s sys     0m4.464s

# Alternative optimisation on ave+sd (MAX_TIME 10000s, rep=1000):
# TAU_red_7_newv_avepsd> nomad np
# 235 38245569.272132  -0.1212     3.44      -4.08       2.2       -6          1.97
# Blackbox evaluations: 1034 Total model evaluations: 92606 Cache hits: 343 Total number of evaluations: 1377
# MOLS> time ./TAUscan 7 data/SpecsCollection/Euler/red "" enu newv hash "-0.1212,3.44,-4.08,2.2,-6,1.97" 1000 10 all
# 1000 : 7.79039912476404853834e+04 1.82663813618189197259e+07 1.93315466068618126155e+08; 1.99791879103126500704e+07
# real    0m49.902s user    8m6.522s sys     0m4.533s

# Alternative optimisation on max (MAX_TIME 10000s, rep=1000):
# TAU_red_7_newv_max> nomad np
# 827 175918446.898071  -0.7       -0.22      -0.02      -1.97      -1.06      -0.08
# Blackbox evaluations: 1020 Total model evaluations: 88351 Cache hits: 329 Total number of evaluations: 1349
# MOLS> time ./TAUscan 7 data/SpecsCollection/Euler/red "" enu newv hash "-0.7,-0.22,-0.02,-1.97,-1.06,-0.08" 1000 10 all
# 1000 : 4.79134393707890764517e+06 3.57432422004955669036e+07 1.86894605771680999678e+08; 2.86026547464738024792e+07
# real    0m53.379s user    8m44.984s sys     0m4.628s

# Alternative optimisation on sd (MAX_TIME 10000s, rep=1000):
# TAU_red_7_newv_sd> nomad np
# 349 21293498.865993  -0.6423    -0.9894     1.011     -3.98       0.0211    -4.0037
# Blackbox evaluations: 1031 Total model evaluations: 89611 Cache hits: 326 Total number of evaluations: 1357
# MOLS> time ./TAUscan 7 data/SpecsCollection/Euler/red "" enu newv hash "-0.6423,-0.9894,1.011,-3.98,0.0211,-4.0037" 1000 10 all
# 1000 : 1.34337827896603487272e+06 2.54199752656692726414e+07 1.66019300304026724771e+08; 2.12934988659928526904e+07
# real    0m50.793s user    8m15.214s sys     0m4.467s

# Rerunning with version >= 0.99:

# MOLS> time ./laMols 7 data/SpecsCollection/Euler/red "" +count dom enu newv "" "" 1 16 "Z" "" "" &
#  N       rt  pl lbt  dis   lbo    lar gcd     satc           t        ppc st      nds      lvs          nsel         nsuel
#  7   +count dom enu newv   asc  relpr   1   342480 2733345.695 7688926579  0 108081820 72539746  4.463357e+01  1.637591e+00
#   mu0    qfppc  pprunes  pmprune  pprobes   rounds        solc       tr  pelvals      dp
#261.19  0.65361   11.055   132.84   176.58   1.7939  0.00029461  0.48197  0.84001  14.961
#    12        0        0   19.502   4.8387        1           0        0        0       0
#   558        4      300      200   1028.9       10           2   4.6591   22.422      22
#19.771  0.50309   4.6025   2.5169   65.286  0.74418    0.017227   0.2394   1.1655  1.5067
#   mu0    qfppc  pprunes  pmprune  pprobes   rounds       solc       tr  pelvals      dp
#218.72   1.8158   4.1732   24.476   65.182   1.2195  0.0045769  0.18332   8.0749  16.455
#     8   1.0227        0        0  0.81301        1          0        0  0.79681      11
#   290        5      150   140.21   1184.3       11          3   5.1672   27.953      23
#26.014  0.56509   4.3819   23.097   80.064  0.56759   0.071412  0.24415   3.9137  1.2204
#      estlvs       uestlvs
#1.445830e+11  2.670699e+08
#7.847875e+05  6.998400e+05
#3.533057e+17  1.160951e+11
#1.460142e+14  5.698074e+08
#   dm0        w  ltausp        minp     meanp     maxp       sdd       tb
#2.4096    3.041  4.6926     0.23084   0.34797  0.51118     0.124  0.36476
#     0        2       1  9.1805e-10       0.2      0.2         0        0
#   247        5  37.406         0.5       0.5  0.93648   0.43648    1.538
#5.9682  0.69934   2.306     0.14288  0.086335  0.12888  0.096044  0.11882
# real    3802m57.953s user    45555m45.699s sys     12389m32.160s

# MOLS> time ./laMols 7 data/SpecsCollection/Euler/red "" +count dom enu newv "" "" 1 16 "L" "" "" &
# N       rt  pl lbt  dis   lbo    lar gcd     satc           t        ppc st      nds      lvs          nsel         nsuel
#  7   +count dom enu newv   asc  relpr   1   342480 1342899.439 3337888072  0 41702766 24969307  1.723266e+00  2.898922e+00
#   mu0    qfppc  pprunes  pmprune  pprobes   rounds        solc       tr  pelvals      dp
#263.52  0.70196   16.672   132.98   187.97   1.9154  0.00071862  0.54871   1.1552  14.539
#    12        0        0   17.012   5.4878        1           0        0        0       0
#   558        4      300      200   940.41       10           2   5.3844    25.83      23
#27.808  0.50473   8.3099   3.8999   72.914  0.84069    0.026975  0.26705   1.5884  1.7589
#   mu0    qfppc  pprunes  pmprune  pprobes   rounds      solc       tr  pelvals      dp
#213.01    1.795   5.1842   30.901   76.486    1.318  0.013234  0.22018   9.1078  16.123
#     8   1.0222        0        0  0.77519        1         0        0  0.77519      10
#   325        6   217.65   140.84   1034.6       11         6   5.4947   31.707      24
#31.083  0.61313   5.2604   27.041   88.194  0.70097    0.1406  0.27494   4.2735  1.5126
#      estlvs       uestlvs
#9.911932e+07  2.348051e+08
#3.857168e+05  1.728000e+05
#4.872947e+10  1.791590e+11
#2.026272e+08  8.770161e+08
#   dm0        w   ltausp       minp     meanp     maxp       sdd        tb
#3.6193   2.4922   3.5896    0.30455   0.42502   0.5641   0.12061   0.39383
#     0        2        1  0.0015933   0.16667      0.2         0         0
#   293        6   10.604        0.5       0.5  0.92997   0.42997    1.3794
#8.7326  0.65653  0.97841    0.13581  0.092399   0.1171  0.089735  0.097591
# real    1711m10.791s user    22381m39.450s sys     3913m52.447s
# Much smaller variance than what obtained by optimisation on ave via tau-probs
# (and also smaller than obtained via uni-probs).

# Optimising TAUscan via Nomad (MAX_TIME 10000s, rep=1000):
# TAU/red_7_newv_ave$ nomad np
# 677 11999595.296573   0.159922   5.892873  -9.999974   1.520568   0.496493  -1.081186
# A termination criterion is reached: No termination (all). Mesh minimum precision reached (Algo)
# Blackbox evaluations: 1322 Total model evaluations: 109940 Cache hits: 415 Total number of evaluations: 1737
# TAU/red_7_newv_ave$ time ./TAUscan 7 ../../red "" enu newv hash "0.159922,5.892873,-9.999974,1.520568,0.496493,-1.081186" 1000 10 all
# 1000 : 6.14465240693299938961e+04 1.50763759588686072675e+07 5.07784234858192136104e+08; 4.08165321896545413620e+07
# real    0m29.580s user    4m51.562s sys     0m1.653s
# MOLS> time ./laMols 7 data/SpecsCollection/Euler/red "" +count dom enu newv "" "" 1 16 "0.159922,5.892873,-9.999974,1.520568,0.496493,-1.081186" "" ""
#  N       rt  pl lbt  dis   lbo    lar gcd     satc           t        ppc st      nds      lvs          nsel         nsuel
#  7   +count dom enu newv   asc  relpr   1   342480 1828718.669 3150817240  0 40471045 22402007  1.277065e+03  1.640611e+00
#   mu0    qfppc  pprunes  pmprune  pprobes  rounds        solc       tr  pelvals      dp
#298.42  0.69428   25.176    130.3   174.37  1.9595  0.00047573  0.65694   1.1454  14.501
#    12        0        0   19.124   7.4468       1           0        0        0       0
#   558        4      300      200   1028.4      11           3   7.1398   26.667      22
#21.788  0.49862   9.4556   3.1334    77.01  0.9088    0.023258  0.35111   1.6887  1.7908
#   mu0    qfppc  pprunes  pmprune  pprobes   rounds      solc       tr  pelvals      dp
#257.03   1.6596   5.2353   38.675   97.781   1.4568  0.014904  0.36012   10.801  16.209
#     8   1.0213        0        0  0.75472        1         0        0  0.75472      10
#   336        6   133.33   136.73   1000.6       11        15   6.4328    31.25      23
#26.851  0.40463   5.2007   24.141   91.405  0.81163   0.18763  0.37601   4.2996  1.4573
#      estlvs       uestlvs
#3.653533e+13  8.269937e+07
#3.055346e+04  2.560000e+05
#2.777589e+18  3.019899e+10
#3.564294e+15  1.643989e+08
#   dm0        w  ltausp        minp     meanp     maxp       sdd       tb
#4.1359   2.2398   53.07     0.35403   0.46616  0.58323   0.11091  0.50272
#     0        2       1  1.6885e-06   0.16667  0.19798         0        0
#   306        6  291.16         0.5       0.5  0.98709   0.48709   1.4253
#9.0411  0.57757  28.209     0.11855  0.077394  0.10921  0.085231  0.14097
# real    2442m21.679s user    30478m38.681s sys     6693m56.644s
# Worse than with uniform probabilities below; especially the high
# standard deviation is noteworthy; indicative for the worse
# performance seems the lower dm0-value.
# Optimising TAUscan via Nomad on sd (MAX_TIME 20000s, rep=2000):
# TAU/red_7_newv_sd$ nomad np
# 1    43253692.868139   0          0          0          0          0          0
# 109  22168590.433909  -1         -1          1         -4         -2          6
# 638  21642641.320509  -1.0       -0.999999   1.0       -4.000002  -2.000001   6.0
# 1100 20952604.930686  -1.0       -0.999999   1.0       -4.000002  -2.000001   6.0
# A termination criterion is reached: No termination (all). Mesh minimum precision reached (Algo)
# Blackbox evaluations: 1169 Total model evaluations: 94636 Cache hits: 269 Total number of evaluations: 1438
# TAU/red_7_newv_ave$ time ./TAUscan 7 ../../red "" enu newv hash "-1,-1,1,-4,-2,6" 2000 10 all
# 2000 : 2.26061901935667058183e+06 2.56126938790854317940e+07 2.29862783499849814980e+08; 2.21685904339090981575e+07
# real    1m6.611s user    10m52.935s sys     0m3.412s
# Doesn't look promising.
# So apparently here uniform-probabilities work somewhat better for optimisation.

# Using uniform probabilities:
# TAU/red_7_newv_ave$ nomad nprand
# 999 15875668.8       -0.81       3.09      -5.96       1.85      -4.5       -4.22
# A termination criterion is reached: No termination (all). Mesh minimum precision reached (Algo)
# Blackbox evaluations: 1293 Total model evaluations: 110199 Cache hits: 419 Total number of evaluations: 1712
# TAU/red_7_newv_ave$ time ./TAUscan 7 ../../red "" enu,rand newv hash "-0.81,3.09,-5.96,1.85,-4.5,-4.22" 1000 10 all
# 1000 : 4.91520000000000000000e+05 1.62047251199999999999e+07 1.88743680000000000000e+08; 1.96922621920704842669e+07
# real    0m28.534s user    4m39.739s sys     0m1.803s
# MOLS$ time ./laMols 7 data/SpecsCollection/Euler/red "" +count dom enu newv "" "" 1 16 "-0.81,3.09,-5.96,1.85,-4.5,-4.22" "" ""
#  N       rt  pl lbt  dis   lbo    lar gcd     satc           t        ppc st      nds      lvs          nsel         nsuel
#  7   +count dom enu newv   asc  relpr   1   342480 1051622.513 2615699973  0 33610302 18438586  2.634658e+00  1.603832e+00
#   mu0    qfppc  pprunes  pmprune  pprobes   rounds        solc       tr  pelvals      dp
#301.66  0.70881   24.476   129.81   180.98   2.0254  0.00061292  0.45434   1.3328  14.145
#   180        0        0   18.328   9.4444        1           0        0        0       0
#   558        4   110.53   138.86   1089.7       12           5   6.1432    27.74      23
#21.134  0.49589   9.1113   3.3582   82.245  0.96417    0.029152   0.4149   1.9398  1.8018
#   mu0    qfppc  pprunes  pmprune  pprobes   rounds     solc       tr  pelvals      dp
#259.41   1.6269   4.8791   39.214   99.676   1.4876  0.01807  0.23816   10.855  15.859
#     8   1.0179        0        0  0.70671        1        0        0  0.66225      10
#   336        6   116.67   135.53     1035       12       10    5.397    30.53      24
#27.566  0.38379   5.2242   23.912   94.424  0.84468  0.20211  0.33519   4.5441  1.4578
#      estlvs       uestlvs
#1.464286e+08  6.586776e+07
#1.952204e+05  2.457600e+05
#2.357378e+11  6.794772e+09
#9.955145e+08  1.249577e+08
#   dm0       w  ltausp        minp    meanp     maxp       sdd       tb
#4.9899  2.2153  17.004     0.36296  0.46925  0.57992   0.10517  0.33496
#     0       2       1  0.00024005  0.16667      0.2         0        0
#   299       6  96.173         0.5      0.5  0.97974   0.47974   1.2777
#10.216  0.5428  8.4275     0.11386  0.07379  0.10345  0.081414  0.25409
# real    2099m4.284s user    17527m2.521s sys     13421m58.927s
# Best result obtained yet.



# laMols with newvars for bin

# N=6:

# Absolute optimisation on lvs:
# LVS_red_6_bin_newv$ nomad np
# A termination criterion is reached: No termination (all). Mesh minimum precision reached (Algo)
# Best feasible solution: #121373 ( -0.822985 9.9742 -3.10621 -1.6376 9.98 ) Evaluation OK f = 2930 h =   0
# Blackbox evaluations: 1576 Total model evaluations: 122434 Cache hits: 554 Total number of evaluations: 2130
# LVS_red_6_bin_newv$ ./laMols 6 ../red "" count dom bin newv "" "" 1 1 "-0.822985,9.9742,-3.10621,-1.6376,9.98" "" ""
#  N       rt  pl lbt  dis   lbo    lar gcd     satc           t        ppc st      nds    inds      lvs     plvs
#  6    count dom bin newv   asc  relpr   1        0      19.680     390352  0     5859    2929     2930        0
#    mu0  qfppc  pprunes  pmprune  pprobes  rounds   solc     tr  pelvals      dp
#152.284  0.577  125.828  136.529  119.387   1.748  0.000  0.003    4.273  12.062
# 12.000  0.000    0.000   31.492   11.250   1.000  0.000  0.000    0.000   0.000
#310.000  2.200  900.000  200.000  513.661   7.000  0.000  0.013   31.285  21.000
# 80.119  0.634  177.726   41.634   77.705   0.981  0.000  0.002    7.610   3.373
#    mu0  qfppc  pprunes  pmprune  pprobes  rounds   solc     tr  pelvals      dp
# 62.329  1.921    1.497   12.342   41.604   1.091  0.000  0.001   20.189  14.057
#  8.000  1.120    0.000    0.000    1.770   1.000  0.000  0.000    1.770   7.000
#201.000  5.000   26.120  131.551  417.647   5.000  0.000  0.011   25.000  22.000
# 76.517  0.361    4.075   22.636   48.266   0.367  0.000  0.001    7.052   3.072
#      estlvs
#1.031390e+04
#1.824685e+02
#8.502924e+04
#1.278307e+04
#    mu1      w       ltau   minp  meanp   maxp    sdd     tb
# 86.096  2.000    442.633  0.411  0.500  0.589  0.089  0.003
# 12.000  2.000      0.000  0.010  0.500  0.500  0.000  0.000
#187.000  2.000  15618.125  0.500  0.500  0.990  0.490  0.010
# 58.771  0.000   1680.987  0.120  0.000  0.120  0.120  0.003
# Here the values for estlvs are not that high.

# Rerunning with version >= 0.99:
# LVS/red_6_bin_newv$ nomad np
# 1176 2568          0.165376   9.348974  -6.058735   1.728771  -1.666597
# 1564 2567          0.165376   9.348974  -6.058735   1.728771  -1.666597
# A termination criterion is reached: No termination (all). Mesh minimum precision reached (Algo)
# Blackbox evaluations: 1972 Total model evaluations: 114458 Cache hits: 818 Total number of evaluations: 2790
# LVS/red_6_bin_newv$ ./laMols 6 ../../red "" count dom bin newv "" "" 1 1 "0.165376,9.348974,-6.058735,1.728771,-1.666597" "" ""
#  N       rt  pl lbt  dis   lbo    lar gcd     satc           t        ppc st      nds      lvs          nsel         nsuel
#  6    count dom bin newv   asc  relpr   1        0      23.377     376225  0     5169     2585  2.909944e+00  8.394986e+00
#   mu0    qfppc  pprunes  pmprune  pprobes   rounds  solc         tr  pelvals      dp
#180.32  0.70453   74.548    125.5   135.76   1.8773     0  0.0037224   4.6079  12.155
#    12        0        0   26.946   8.4746        1     0          0        0       0
#   310        3      900      200   464.32        7     0   0.014444   36.932      21
# 56.89  0.60912   125.62    32.63   76.515  0.97513     0  0.0024698   7.9445  3.5481
#   mu0    qfppc  pprunes  pmprune  pprobes   rounds  solc          tr  pelvals      dp
#87.045   1.8961   23.057   28.952   37.729   1.0685     0  0.00074811   15.886   14.15
#     8   1.1111        0        0   1.8692        1     0           0   1.8692       6
#   203        5     1060   155.56   418.72        4     0    0.013099       25      22
#76.152  0.45638   91.608   42.404   39.004  0.26311     0    0.001269   8.2544  3.2652
#      estlvs       uestlvs
#2.447420e+04  1.847649e+05
#1.345550e+02  6.400000e+01
#5.732916e+05  4.194304e+06
#5.458765e+04  5.755548e+05
#   dm0  w  ltausp       minp  meanp     maxp      sdd         tb
# 30.58  2  32.806    0.38612    0.5  0.61388  0.11388  0.0045385
#     0  2       1  0.0045387    0.5      0.5        0          0
#   179  2  150.99        0.5    0.5  0.99546  0.49546   0.008821
#53.554  0  29.809    0.12692      0  0.12692  0.12692  0.0025971
# A good improvement over version before 0.99.

# TAU-optimisation (MAX_TIME=600, rep=100):
# TAU/red_6_bin_newv_ave$ nomad np
# 177   10.423704   1         -9.5       -7          7         -5.01
# A termination criterion is reached: Maximum allowed time reached (Base) No more points to evaluate
# Blackbox evaluations: 208 Total model evaluations: 20180 Cache hits: 18 Total number of evaluations: 226
# TAU/red_6_bin_newv_ave$ time ./TAUscan 6 ../../red "" bin newv hash "1,-9.5,-7,7,-5.01" 100 10 all
# 100 : 4.01349560996235924003e+00 1.04237037319964543332e+01 1.30320760689674278149e+02; 1.49861680328326735377e+01
# real    0m4.237s user    0m40.623s sys     0m0.181s
# TAU/red_6_bin_newv$ ./laMols 6 ../../red "" count dom bin newv "" "" 1 1 "1,-9.5,-7,7,-5.01" "" ""
#  N       rt  pl lbt  dis   lbo    lar gcd     satc           t        ppc st      nds      lvs          nsel         nsuel
#  6    count dom bin newv   asc  relpr   1        0      23.234     400728  0     6641     3321  4.757043e+06  2.885802e+02
#   mu0    qfppc  pprunes  pmprune  pprobes  rounds  solc         tr  pelvals      dp
#149.48  0.59998   133.21   138.42   118.83  1.7506     0  0.0029986   3.9976    15.2
#    12        0   3.6517   30.058    7.377       1     0    1.3e-05        0       0
#   310     2.25      900      200    689.4       8     0   0.025247   36.073      35
#88.481  0.59993   177.74   47.091   77.334  0.8965     0  0.0027449   7.3912  5.3768
#   mu0    qfppc  pprunes  pmprune  pprobes   rounds  solc         tr  pelvals      dp
#56.099   1.9005   7.4978   11.731   38.116   1.0825     0  0.0005837   20.553  17.195
#     8     1.08        0        0    2.381        1     0      2e-06    2.381       6
#   244        5      200   125.14   388.52        4     0   0.013258   25.532      36
#76.376  0.26577   22.967   23.662   42.897  0.33715     0  0.0014242    7.253  5.1952
#      estlvs       uestlvs
#7.515243e+16  2.765714e+08
#4.013496e+00  6.400000e+01
#9.809952e+19  6.871948e+10
#2.010242e+18  3.111658e+09
#   dm0  w  ltausp        minp  meanp     maxp      sdd         tb
#28.142  2  37.627      0.3847    0.5   0.6153   0.1153  0.0033855
#     0  2       1  2.6354e-15    0.5      0.5        0    7.5e-05
#   207  2  759.86         0.5    0.5        1      0.5   0.009573
#55.014  0  65.224     0.16743      0  0.16743  0.16743  0.0028319
# Node count not complete catastrophic, but optimisation likely worseless, due to
# very high variance.
# One needs to investigate this case, to understand what is going on: the problems
# are indicated by min-minp=2.6354e-15 and max-maxp=1.
# This might be numerical problems, or possibly these parameter-tuples have
# such a high variance.

# Uniform-optimisation (MAX_TIME=600, rep=100):
# TAU/red_6_bin_newv_ave$ nomad nprand
# 366  716.16      -0.507447  -1.9962     0.946      1.9666    -1.015781
# A termination criterion is reached: Maximum allowed time reached (Base) No more points to evaluate
# Blackbox evaluations: 406 Total model evaluations: 36183 Cache hits: 36 Total number of evaluations: 442
# TAU/red_6_bin_newv_ave$ time ./TAUscan 6 ../../red "" bin,rand newv hash "-0.507447,-1.9962,0.946,1.9666,-1.015781" 100 10 all
# 100 : 3.20000000000000000000e+01 7.16159999999999999976e+02 8.19200000000000000000e+03; 1.17472340797845909466e+03
#  real    0m1.188s user    0m10.392s sys     0m0.169s
# TAU/red_6_bin_newv$ ./laMols 6 ../../red "" count dom bin newv "" "" 1 1 "-0.507447,-1.9962,0.946,1.9666,-1.015781" "" ""
#  N       rt  pl lbt  dis   lbo    lar gcd     satc           t        ppc st      nds      lvs          nsel         nsuel
#  6    count dom bin newv   asc  relpr   1        0      42.729     620007  0     9145     4573  4.091502e+00  7.426049e+04
#   mu0    qfppc  pprunes  pmprune  pprobes   rounds  solc         tr  pelvals      dp
# 199.2  0.60213   40.531   122.07    136.9   1.7043     0  0.0037413   3.0763   18.95
#    50        0   3.6517   26.012        6        1     0    3.7e-05        0       0
#   310        4   658.06   164.06   622.87        8     0   0.020114   43.478      53
#39.087  0.63218   72.056   29.756   73.814  0.91011     0  0.0023672   6.2744  8.0891
#   mu0    qfppc  pprunes  pmprune  pprobes   rounds  solc          tr  pelvals      dp
#102.14   1.9894   25.485   22.353   35.277   1.0964     0  0.00077574   12.961  20.946
#     8   1.0606        0        0   1.1628        1     0           0   1.1236       5
#   278        5     1000   170.91   521.98        5     0    0.016473       25      54
#77.106  0.61339    107.5   38.608    56.37  0.41104     0    0.001802   9.2392  7.9696
#      estlvs       uestlvs
#8.112680e+04  2.521836e+13
#2.556546e+01  3.200000e+01
#1.793979e+07  1.801440e+16
#5.083353e+05  5.003831e+14
#   dm0  w  ltausp     minp  meanp     maxp      sdd         tb
#29.595  2  4.8816  0.30225    0.5  0.69775  0.19775  0.0047903
#     0  2       1   0.0263    0.5      0.5        0          0
#   226  2  25.818      0.5    0.5   0.9737   0.4737   0.011265
#    57  0  2.6053  0.15873      0  0.15873  0.15873  0.0023586
# Much worse than tau-optimisation.



squares A B aux
red A
rred B aux
ls A B aux
rprod B aux A
