# Counts for N >= 2:
# 0, 0, 2, 36, 0, 2400

# QUESTION: what is the relation to 3MOLSinv (regarding solutions and solving-
# time)?


# gcMols:

# N=6:

# MOLS> ./gcMols 6 data/SpecsCollection/3MOLS/basis "" count dom - - "" 1 1 "t,4"
# solved only by maxdegdom:
#  N       rt  pl  bt        bv   bo gcd      satc           t           ppc        flvs        gnds     gd st
#  6    count dom bin maxdegdom  asc   1         0       2.024       9778149       60113      120225     15  0
#  6    count dom enu maxdegdom  asc   1         0       1.988       9658961       60113      108996     15  0

# N=7:

# MOLS> time ./gcMols 7 data/SpecsCollection/3MOLS/basis "" +count dom enu maxdegdom "" 1 16 ""
# aborted after
# real    197m14.058s user    1762m28.190s sys     660m11.641s
# with 4 solutions found.
# Rerunning:
# MOLS> time ./gcMols 7 data/SpecsCollection/3MOLS/basis "" +count dom enu maxdegdom "" 1 16 "lvs,1000000000"
# XXX


# rlaMols:

# N=6:

# MOLS> time ./rlaMols 6 data/SpecsCollection/3MOLS/basis "" count dom enu maxdegdom "" "" 1 12 ""
#  N       rt  pl  bt        bv   bo    lar gcd     satc           t        ppc st      nds    inds      lvs
#  6   +count dom enu maxdegdom  asc  relpr   1        0     126.181     241533  0     3114    1318     1796
#    mu0  qfppc  pprunes  pmprune  pprobes  rounds   solc     tr  pelvals     dp
#587.938  0.737   12.908  127.736  198.465   2.135  0.000  0.474    0.805  5.294
#539.000  0.000    5.031  122.071  109.386   1.000  0.000  0.063    0.000  0.000
#660.000  1.400   27.067  129.550  589.116   6.000  0.000  1.837    4.082  7.000
# 20.108  0.466    3.778    0.810   77.528   0.924  0.000  0.247    0.750  1.032
#    mu0  qfppc  pprunes  pmprune  pprobes  rounds   solc     tr  pelvals     dp
#552.574  1.495    7.144   43.716  116.038   1.793  0.000  0.305    6.457  6.748
#212.000  1.100    0.000    0.000    0.943   1.000  0.000  0.000    0.943  6.000
#593.000  3.500  109.091  127.225  571.652   6.000  0.000  1.859   19.218  8.000
# 27.196  0.290    7.583   29.048  105.448   0.932  0.000  0.292    3.399  0.606
# real	0m13.261s user	2m6.183s sys	0m3.767s

# N=7:

# MOLS> time ./rlaMols 7 data/SpecsCollection/3MOLS/basis "" +count dom enu maxdegdom "" "" 1 16 ""
#  N       rt  pl  bt        bv   bo    lar gcd     satc           t        ppc st      nds    inds      lvs
#  7   +count dom enu maxdegdom  asc  relpr   1     2400 6721428.278 8263635879  0 75440601 33262378 42178223
#     mu0  qfppc  pprunes  pmprune  pprobes  rounds   solc      tr  pelvals      dp
# 898.590  0.677   20.095  123.455  145.760   1.779  0.000   2.408    0.327  15.390
# 588.000  0.000    4.405   74.689   72.372   1.000  0.000   0.019    0.000   0.000
#1176.000  3.000   87.701  129.762  982.559  10.000  1.000  34.155   28.631  31.000
#  54.596  0.507    5.634    1.042   50.821   0.685  0.002   1.201    0.452   2.596
#     mu0  qfppc  pprunes  pmprune   pprobes  rounds   solc      tr  pelvals      dp
# 827.224  1.870    1.421   17.743    31.297   1.140  0.000   0.551    2.486  17.883
# 270.000  1.031    0.000    0.000     0.246   1.000  0.000   0.000    0.206  10.000
#1004.000  5.000  248.649  126.579  1212.128  12.000  1.000  39.143   25.848  32.000
#  34.598  0.383    2.755   24.137    50.556   0.443  0.007   0.893    1.303   2.725
# real    7813m28.579s user    112023m48.286s sys     3096m31.286s

# N=8:

# MOLS> time ./rlaMols 8 data/SpecsCollection/3MOLS/basis "" +count dom enu maxdegdom "" "" 1 16 ""
# aborted:
#  N       rt  pl  bt        bv   bo    lar gcd     satc           t        ppc st      nds    inds      lvs
#  8   +count dom enu maxdegdom  asc  relpr   1        0 2302182.610 1559910265  1 14292904 5557235  8735669
#     mu0  qfppc  pprunes  pmprune  pprobes  rounds   solc      tr  pelvals      dp
#1048.775  0.956   38.528  122.552  164.178   2.075  0.000   4.654    0.601  35.578
# 835.000  0.000    3.909  104.074   70.938   1.000  0.000   0.135    0.000   0.000
#1904.000  4.000   86.075  127.166  736.049   8.000  0.000  25.684   10.579  50.000
#  69.533  0.296    9.010    1.193   44.526   0.498  0.000   1.528    0.529   2.515
#     mu0  qfppc  pprunes  pmprune  pprobes  rounds   solc      tr  pelvals      dp
# 999.077  1.898    1.622   23.329   38.001   1.142  0.000   1.198    2.035  37.159
# 441.000  1.032    0.000    0.000    0.169   1.000  0.000   0.000    0.168  22.000
#1368.000  6.000  125.098  125.368  692.730   8.000  0.000  33.085   20.954  51.000
#  64.321  0.382    5.634   18.626   47.472   0.393  0.000   1.440    1.458   2.390
# real    2474m14.690s user    38369m43.549s sys     435m55.464s



# laMols with wdL:

# MOLS> ./laMols 2,5 data/SpecsCollection/3MOLS/basis "" count "" enu wdL "" "" 1 1 "" "" ""
# all quickly solved by both A + L.

# N=6:

# MOLS> ./laMols 6 data/SpecsCollection/3MOLS/basis "" count "" enu wdL "" "" 1 12 "" "" ""
#   weights: A -> 0 0 1 2 3 4 5
#  N       rt  pl lbt  dis   lbo    lar gcd     satc           t        ppc st      nds    inds      lvs     plvs
#  6    count dom enu  wdL   asc  relpr   1        0     314.210    1287860  0    14384    5393     8991        0
#    mu0  qfppc  pprunes  pmprune  pprobes  rounds   solc     tr  pelvals      dp
#407.204  0.357    6.843  136.415  163.542   1.405  0.000  0.277    0.257   7.219
#371.000  0.000    0.000  126.515  111.860   1.000  0.000  0.033    0.000   0.000
#660.000  2.000   24.142  138.814  444.246   4.000  0.000  0.852    3.581  11.000
# 31.533  0.509    4.459    1.806   55.563   0.620  0.000  0.128    0.505   1.214
#    mu0  qfppc  pprunes  pmprune  pprobes  rounds   solc     tr  pelvals      dp
#367.881  1.743    3.119   18.606   40.058   1.128  0.000  0.077    4.119   8.730
#296.000  1.105    0.000    0.000    0.608   1.000  0.000  0.000    0.608   7.000
#392.000  4.000   44.444  129.504  480.463   4.000  0.000  0.941   10.997  12.000
# 14.141  0.372    3.525   18.842   58.750   0.403  0.000  0.106    1.677   0.848
#      estlvs
#1.454746e+04
#2.474211e+03
#3.023155e+05
#2.356874e+04
#    mu1      w   ltau   minp  meanp   maxp    sdd     tb
#406.027  2.667  0.046  0.321  0.397  0.483  0.074  0.232
#367.000  2.000  0.014  0.036  0.250  0.250  0.000  0.034
#660.000  4.000  0.103  0.500  0.500  0.853  0.353  0.569
# 30.958  0.654  0.021  0.127  0.093  0.107  0.065  0.047
##   weights: L -> 0 0 1 1.5849625007211561815 2 2.3219280948873623478 2.5849625007211561815
#  N       rt  pl lbt  dis   lbo    lar gcd     satc           t        ppc st      nds    inds      lvs     plvs
#  6    count dom enu  wdL   asc  relpr   1        0     283.192    1206182  0    13264    4973     8291        0
#    mu0  qfppc  pprunes  pmprune  pprobes  rounds   solc     tr  pelvals      dp
#408.789  0.419    6.388  136.346  172.564   1.532  0.000  0.267    0.279   7.113
#372.000  0.000    0.000  126.515  115.323   1.000  0.000  0.029    0.000   0.000
#660.000  2.000   20.280  138.710  442.931   4.000  0.000  0.906    2.811  10.000
# 32.449  0.517    4.209    1.822   64.485   0.733  0.000  0.163    0.469   1.133
#    mu0  qfppc  pprunes  pmprune  pprobes  rounds   solc     tr  pelvals      dp
#369.017  1.763    2.594   14.899   30.842   1.063  0.000  0.055    3.969   8.595
#327.000  1.118    0.000    0.000    0.885   1.000  0.000  0.000    0.885   7.000
#392.000  3.500   26.087  101.799  317.136   3.000  0.000  0.706   12.755  11.000
# 10.833  0.333    3.262   15.090   44.701   0.306  0.000  0.079    1.604   0.716
#      estlvs
#1.112034e+04
#1.890074e+03
#1.044799e+05
#7.255311e+03
#    mu1      w   ltau   minp  meanp   maxp    sdd     tb
#279.457  2.667  0.086  0.342  0.402  0.471  0.060  0.213
#261.000  2.000  0.021  0.061  0.250  0.250  0.000  0.030
#393.000  4.000  0.216  0.500  0.500  0.726  0.270  0.664
# 14.838  0.736  0.048  0.132  0.100  0.099  0.059  0.085

# Optimising TAUscan on ave via Nomad (MAX_TIME 3600s, rep=100):
# TAU_basis_6_wdL_ave$ nomad np
# 316 1567.331166   3.099962   5.100018   0.1002     6.999952
# Blackbox evaluations: 926 Total model evaluations: 85194 Cache hits: 311 Total number of evaluations: 1237
# TAU_basis_6_wdL_ave$ time ./TAUscan 6 ../basis "" enu wdL hash "3.099962,5.100018,0.1002,6.999952" 100 10 all
# 100 : 4.91278756084007450944e+02 2.10780989357942208207e+03 1.14061916559860725284e+04; 1.89668206647840879486e+03
# real    0m2.462s user    0m23.173s sys     0m0.161s
# TAU_basis_6_wdL_ave$ ./laMols 6 ../basis "" count "" enu wdL "" "" 1 16 "3.099962,5.100018,0.1002,6.999952" "" ""
#  N       rt  pl lbt  dis   lbo    lar gcd     satc           t        ppc st      nds    inds      lvs     plvs
#  6    count dom enu  wdL   asc  relpr   1        0     158.702     323129  0     3429    1113     2316        0
#    mu0  qfppc  pprunes  pmprune  pprobes  rounds   solc     tr  pelvals     dp
#520.115  0.402   10.327  130.884  158.380   1.532  0.000  0.512    0.297  5.398
#488.000  0.000    3.875  126.515  115.460   1.000  0.000  0.176    0.000  0.000
#660.000  2.000   19.038  131.683  353.360   3.000  0.000  2.036    1.844  8.000
# 18.924  0.508    3.164    0.664   59.348   0.728  0.000  0.224    0.493  1.160
#    mu0  qfppc  pprunes  pmprune  pprobes  rounds   solc     tr  pelvals     dp
#475.962  1.711   15.621   17.869   39.211   1.198  0.000  0.147    3.855  6.907
#216.000  1.091    0.000    0.000    0.463   1.000  0.000  0.000    0.463  5.000
#515.000  4.000  171.429  101.423  358.230   4.000  0.000  1.599   17.520  9.000
# 36.972  0.474   25.294   22.173   69.718   0.551  0.000  0.258    2.724  0.867
#      estlvs
#1.297151e+04
#4.912788e+02
#9.740462e+05
#7.234668e+04
#      mu1      w   ltau   minp  meanp   maxp    sdd     tb
#36487.447  3.080  0.000  0.224  0.349  0.496  0.119  0.451
#31270.000  2.000  0.000  0.002  0.200  0.227  0.000  0.196
#54316.000  5.000  0.001  0.500  0.500  0.879  0.379  0.859
# 3014.746  0.828  0.000  0.135  0.095  0.150  0.091  0.118
# A decent improvement (close to rlaMols).

# Rerunning with version >= 0.99:

# MOLS$ ./laMols 6 data/SpecsCollection/3MOLS/basis "" count "" enu wdL "" "" 1 16 "" "" ""
#   weights: A -> 0 0 1 2 3 4 5
#  N       rt  pl lbt  dis   lbo    lar gcd     satc           t        ppc st      nds      lvs          nsel         nsuel
#  6    count dom enu  wdL   asc  relpr   1        0     479.446    1286539  0    14435     8946  7.807966e-01  1.074211e+00
#   weights: L -> 0 0 1 1.5849625007211561815 2 2.3219280948873623478 2.5849625007211561815
#  N       rt  pl lbt  dis   lbo    lar gcd     satc           t        ppc st      nds      lvs          nsel         nsuel
#  6    count dom enu  wdL   asc  relpr   1        0     390.054    1207019  0    13321     8264  6.338016e-01  7.485113e-01

# Optimising tau-probs (MAX_TIME 3600s, rep=100):
# TAU/basis_6_wdL_ave$ nomad np
# 258 1612.517594   5.0958     3.0868     0.0001     5.0667
# A termination criterion is reached: No termination (all). Mesh minimum precision reached (Algo)
# Blackbox evaluations: 988 Total model evaluations: 93117 Cache hits: 384 Total number of evaluations: 1372
# TAU/basis_6_wdL_ave$ time ./TAUscan 6 ../../basis "" enu wdL hash "5.0958,3.0868,0.0001,5.0667" 100 10 all
# 100 : 4.95356324374501205660e+02 1.61251759423221869061e+03 5.80412948650128209849e+03; 1.06984530605146174986e+03
# real    0m2.584s user    0m24.005s sys     0m0.181s
# TAU/basis_6_wdL_ave$ ./laMols 6 ../../basis "" count "" enu wdL "" "" 1 16 "5.0958,3.0868,0.0001,5.0667" "" ""
#  N       rt  pl lbt  dis   lbo    lar gcd     satc           t        ppc st      nds      lvs          nsel         nsuel
#  6    count dom enu  wdL   asc  relpr   1        0     156.578     351667  0     3405     2268  3.984091e+00  9.852358e-01
#   mu0    qfppc  pprunes  pmprune  pprobes   rounds  solc        tr  pelvals      dp
# 520.3  0.41462   10.501   130.92   154.99   1.5092     0   0.51783  0.26074  5.4178
#   488        0   3.8747   126.52   115.07        1     0  0.011882        0       0
#   660        2   23.609    131.8   353.36        3     0     1.783   1.8443       8
#18.431  0.51035   3.4816  0.63407   55.464  0.67797     0   0.26645  0.44295  1.1577
#   mu0    qfppc  pprunes  pmprune  pprobes   rounds  solc       tr  pelvals       dp
#469.93   1.7451   18.171   18.758   43.688   1.2337     0  0.16634    3.998   6.9189
#   209   1.0732        0        0  0.46296        1     0        0  0.46296        5
#   515        5   171.43    124.1   491.57        5     0   2.7377   18.474        9
#56.445  0.52009   31.722    23.51   80.162  0.64944     0  0.31266    3.097  0.85702
#      estlvs       uestlvs
#3.826791e+04  4.469524e+03
#4.953563e+02  5.400000e+02
#1.979684e+06  2.304000e+04
#2.113073e+05  4.022726e+03
#   dm0        w  ltausp        minp     meanp     maxp       sdd        tb
#1.4283   2.9938  9.3594     0.21899   0.35929  0.52094   0.13111   0.46164
#     0        2  4.7974  0.00060278       0.2  0.23113         0  0.014317
#     9        5  19.764         0.5       0.5  0.82059   0.33436    0.8754
#2.3211  0.82274  3.0494     0.14432  0.096418  0.14581  0.090528   0.15069

# Optimising uni-probs (MAX_TIME 3600s, rep=100):
# TAU/basis_6_wdL_ave$ nomad nprand
# 509  1864.8        7          4.1        0.0001     5.1
# A termination criterion is reached: No termination (all). Mesh minimum precision reached (Algo)
# Blackbox evaluations: 927 Total model evaluations: 83322 Cache hits: 254 Total number of evaluations: 1181
# TAU/basis_6_wdL_ave$ time ./TAUscan 6 ../../basis "" enu,rand wdL hash "7,4.1,0.0001,5.1" 100 10 all
# 100 : 5.40000000000000000000e+02 1.89540000000000000002e+03 9.72000000000000000000e+03; 1.74824785012152823593e+03
# real    0m2.542s user    0m23.007s sys     0m0.200s
# TAU/basis_6_wdL_ave$ ./laMols 6 ../../basis "" count "" enu wdL "" "" 1 16 "7,4.1,0.0001,5.1" "" ""
#  N       rt  pl lbt  dis   lbo    lar gcd     satc           t        ppc st      nds      lvs          nsel         nsuel
#  6    count dom enu  wdL   asc  relpr   1        0     177.787     369488  0     3573     2388  4.084420e+00  1.042444e+00
#   mu0    qfppc  pprunes  pmprune  pprobes   rounds  solc       tr  pelvals      dp
#519.08  0.43834   10.723   130.92   160.73   1.5705     0  0.60708    0.303  5.4751
#   488        0   3.8747   126.52   115.46        1     0  0.19309        0       0
#   660        2   23.609   132.31   353.36        3     0   1.6316   1.8443       8
#18.958  0.51306   3.5183  0.67552   58.628  0.72734     0  0.24862  0.48011   1.176
#   mu0    qfppc  pprunes  pmprune  pprobes   rounds  solc       tr  pelvals       dp
#468.44   1.7378   18.237   17.651   40.137   1.2102     0  0.17806   3.8138   6.9698
#   209   1.0909        0        0  0.46296        1     0        0  0.46296        5
#   515        4   171.43    124.1   493.37        5     0   2.8216   18.474        9
#55.761  0.49969   31.758   22.974   77.853  0.63036     0  0.33672    2.922  0.87746
#      estlvs       uestlvs
#4.222578e+04  4.983015e+03
#4.870849e+02  5.400000e+02
#2.429426e+06  2.592000e+04
#2.468957e+05  4.705928e+03
#   dm0        w  ltausp        minp     meanp     maxp       sdd       tb
#1.6945   3.0143  16.941     0.22258   0.35824  0.51022   0.12434  0.52506
#     0        2  3.6414  0.00051438       0.2  0.22903         0   0.2567
#    10        5  33.513         0.5       0.5  0.81946   0.33601   1.0785
#2.6479  0.84267  8.0811     0.14759  0.098946  0.14841  0.091839  0.11101


# N=7:

# Optimising TAUscan on ave via Nomad (MAX_TIME 40000s, rep=1000):
# TAU_basis_7_wdL_ave$ nomad np
# Aborted early:
#BBE OBJ SOL
#1 602920332.736149   0.1        0.1        0.1        0.1        0.1
#14 578392700.718591   0.0001     0.1        0.1        0.1        1.1
#18 520396628.42514    0.0001     0.0001     0.0001     0.1        2.1
#30 495171258.814525   0.0001     0.0001     0.0001     0.1        3.1
#62 446119742.595062   0.0001     0.0001     0.0801     0.0001     4.1
#199 434578624.0758     0.0331     0.0301     0.1141     0.0041     3.6
#292 433077315.351203   0.032958   0.0351     0.114026   0.003854   3.6043
# Does not look promising.

# Rerunning with version >= 0.99:

# Optimising tau-probs (40000s, rep=10000):
# TAU/basis_7_wdL_ave$ nomad np
# 154 494041890.383894   0.11       0.0001     0.0001     0.23       0.0001
# A termination criterion is reached: Maximum allowed time reached (Base) Success found and opportunistic strategy is used
# Blackbox evaluations: 154 Total model evaluations: 14085 Cache hits: 9 Total number of evaluations: 163
# TAU/basis_7_wdL_ave$ time ./TAUscan 7 ../../basis "" enu wdL hash "0.11,0.0001,0.0001,0.23,0.0001" 10000 10 all
# 10000 : 8.08994002234867347124e+06 4.94041890383894209110e+08 6.15710319755351335965e+10; 1.40102001568028685800e+09
# real    19m44.517s user    196m18.393s sys     0m23.343s
# Similar to above.

# Optimising uni-probs (40000s, rep=10000):
# TAU/basis_7_wdL_ave$ nomad nprand
# 148 523163386.08       0.1654     0.0264     0.0678     0.1623     0.17
# A termination criterion is reached: Maximum allowed time reached (Base) No more points to evaluate
# Blackbox evaluations: 182 Total model evaluations: 14114 Cache hits: 20 Total number of evaluations: 202
# TAU/basis_7_wdL_ave$ time ./TAUscan 7 ../../basis "" enu,rand wdL hash "0.1654,0.0264,0.0678,0.1623,0.17" 10000 10 all
# 10000 : 3.68640000000000000000e+06 5.23163386079999999987e+08 1.71992678400000000000e+11; 2.32581053450552105717e+09
# real    18m17.305s user    181m37.323s sys     0m22.579s
# Indeed does not look promising.



# laMols with newvars:

# MOLS> ./laMols 2,5 data/SpecsCollection/3MOLS/basis "" count "" enu newv "" "" 1 1 "" "" ""
# all quickly solved by all four weights.

# N=6:

# MOLS> ./laMols 6 data/SpecsCollection/3MOLS/basis "" count "" enu newv "" "" 1 12 "" "" ""
# Z worst, O, A, L all very similar, with L slightly best:
#  N       rt  pl lbt  dis   lbo    lar gcd     satc           t        ppc st      nds    inds      lvs     plvs
#  6    count dom enu newv   asc  relpr   1        0     327.784    1218423  0    13709    4973     8736        0
#    mu0  qfppc  pprunes  pmprune  pprobes  rounds   solc     tr  pelvals      dp
#409.565  0.316    6.800  136.175  164.224   1.397  0.000  0.300    0.288   7.324
#372.000  0.000    0.000  126.515  116.622   1.000  0.000  0.072    0.000   0.000
#660.000  2.000   26.017  138.710  436.829   4.000  0.000  1.069    3.571  10.000
# 33.023  0.487    4.830    2.029   64.004   0.688  0.000  0.158    0.635   1.280
#    mu0  qfppc  pprunes  pmprune  pprobes  rounds   solc     tr  pelvals      dp
#370.165  1.721    2.427   19.482   44.853   1.141  0.000  0.092    4.314   8.804
#299.000  1.100    0.000    0.000    0.877   1.000  0.000  0.000    0.860   7.000
#392.000  4.000   31.579  129.716  484.496   4.000  0.000  1.094   11.054  11.000
# 14.205  0.386    2.821   21.239   67.626   0.469  0.000  0.129    1.799   0.888
#      estlvs
#1.436700e+04
#2.730977e+03
#2.353071e+05
#2.036622e+04
#    mu1      w   ltau   minp  meanp   maxp    sdd     tb
#279.563  2.756  0.039  0.288  0.384  0.464  0.079  0.252
#258.000  2.000  0.009  0.046  0.250  0.250  0.000  0.087
#393.000  4.000  0.086  0.500  0.500  0.763  0.263  0.556
# 15.536  0.645  0.019  0.130  0.091  0.111  0.064  0.058

# Optimising TAUscan on ave via Nomad (MAX_TIME 3600s, rep=100):
# TAU_basis_6_newv_ave$ nomad np
# 414 1450.694695  -0.999999 -10          9.990301  -7.009546  -0.999608
# Blackbox evaluations: 1086 Total model evaluations: 99516 Cache hits: 331 Total number of evaluations: 1417
# TAU_basis_6_newv_ave$ time ./TAUscan 6 ../basis "" enu newv hash "-0.999999,-10,9.990301,-7.009546,-0.999608" 100 10 all
# 100 : 4.74391932586464136840e+02 2.56038467074486284614e+03 6.13635477517657089699e+04; 6.10667485546389499529e+03
# real    0m2.335s user    0m20.981s sys     0m0.174s
# TAU_basis_6_newv_ave$ ./laMols 6 ../basis "" count "" enu newv "" "" 1 16 "-0.999999,-10,9.990301,-7.009546,-0.999608" "" ""
#  N       rt  pl lbt  dis   lbo    lar gcd     satc           t        ppc st      nds    inds      lvs     plvs
#  6    count dom enu newv   asc  relpr   1        0      49.991     290632  0     3149    1137     2012        0
#    mu0  qfppc  pprunes  pmprune  pprobes  rounds   solc     tr  pelvals     dp
#520.387  0.425   10.880  130.877  156.381   1.510  0.000  0.026    0.297  5.397
#490.000  0.000    3.875  126.515  115.460   1.000  0.000  0.011    0.000  0.000
#660.000  2.000   28.542  131.800  430.196   4.000  0.000  0.321    1.837  8.000
# 18.151  0.527    4.190    0.657   59.139   0.710  0.000  0.020    0.493  1.131
#    mu0  qfppc  pprunes  pmprune  pprobes  rounds   solc     tr  pelvals     dp
#477.817  1.657   18.694   21.779   49.944   1.256  0.000  0.010    4.384  6.849
#216.000  1.045    0.000    0.000    0.463   1.000  0.000  0.000    0.463  5.000
#515.000  4.000  195.652   92.798  358.230   4.000  0.000  0.094   16.327  9.000
# 40.168  0.454   31.819   22.470   74.689   0.582  0.000  0.015    3.066  0.849
#      estlvs
#6.388124e+03
#4.405855e+02
#2.213407e+05
#1.833575e+04
#    mu1      w   ltau   minp  meanp   maxp    sdd     tb
#329.447  2.769  0.124  0.273  0.385  0.519  0.111  0.025
#310.000  2.000  0.045  0.009  0.200  0.250  0.000  0.013
#393.000  5.000  0.223  0.500  0.500  0.860  0.360  0.256
#  9.148  0.734  0.038  0.138  0.094  0.127  0.084  0.016
# A reasonable result.

# Optimising TAUscan on ave+sd via Nomad (MAX_TIME 3600s, rep=100):
# TAU_basis_6_newv_avepsd$ nomad np
# 751  2513.392254   1.0        8.262      3.0       -5.672      1.7265
# A termination criterion is reached: No termination (all). Mesh minimum precision reached (Algo)
# Blackbox evaluations: 1145 Total model evaluations: 99328 Cache hits: 420 Total number of evaluations: 1565
# TAU_basis_6_newv_avepsd$ time ./TAUscan 6 ../basis "" enu newv hash "1.0,8.262,3.0,-5.672,1.7265" 100 10 all
# 100 : 4.65142577979407506716e+02 1.97107337154761465714e+03 8.04371972017600085270e+03; 1.57460496638359582966e+03
# real    0m2.273s user    0m21.045s sys     0m0.151s
# TAU_basis_6_newv_avepsd$ ./laMols 6 ../basis "" count "" enu newv "" "" 1 16 "1.0,8.262,3.0,-5.672,1.7265" "" ""
#  N       rt  pl lbt  dis   lbo    lar gcd     satc           t        ppc st      nds    inds      lvs     plvs
#  6    count dom enu newv   asc  relpr   1        0     151.305     295187  0     3221    1161     2060        0
#    mu0  qfppc  pprunes  pmprune  pprobes  rounds   solc     tr  pelvals     dp
#520.131  0.437   11.004  130.889  155.942   1.520  0.000  0.528    0.295  5.416
#490.000  0.000    3.875  126.515  115.460   1.000  0.000  0.113    0.000  0.000
#660.000  2.000   28.542  131.800  430.196   4.000  0.000  2.240    1.837  8.000
# 18.048  0.528    4.243    0.656   58.562   0.706  0.000  0.255    0.488  1.130
#    mu0  qfppc  pprunes  pmprune  pprobes  rounds   solc     tr  pelvals     dp
#477.495  1.663   18.636   21.287   46.208   1.230  0.000  0.190    4.291  6.872
#216.000  1.045    0.000    0.000    0.463   1.000  0.000  0.000    0.463  5.000
#515.000  4.000  195.652   92.798  358.230   4.000  0.000  1.863   16.327  9.000
# 39.530  0.447   31.506   22.210   69.877   0.546  0.000  0.276    2.937  0.845
#      estlvs
#5.829808e+03
#4.651426e+02
#1.585423e+05
#1.401171e+04
#    mu1      w   ltau   minp  meanp   maxp    sdd     tb
#329.314  2.773  0.000  0.273  0.384  0.520  0.111  0.470
#310.000  2.000  0.000  0.012  0.200  0.250  0.000  0.119
#393.000  5.000  0.000  0.500  0.500  0.855  0.355  0.730
#  9.099  0.727  0.000  0.136  0.093  0.126  0.083  0.110
# Basically the same.

# Rerunning with version >= 0.99:

# MOLS> ./laMols 6 data/SpecsCollection/3MOLS/basis "" count "" enu newv "" "" 1 16 "" "" ""
#   weights: Z -> 0 0 0 0 0 0 0
#  N       rt  pl lbt  dis   lbo    lar gcd     satc           t        ppc st      nds      lvs          nsel         nsuel
#  6    count dom enu newv   asc  relpr   1        0     577.764    1679630  0    18900    12129  1.288690e+00  1.216495e+00
#   weights: O -> 0 0 1 1 1 1 1
#  N       rt  pl lbt  dis   lbo    lar gcd     satc           t        ppc st      nds      lvs          nsel         nsuel
#  6    count dom enu newv   asc  relpr   1        0     472.158    1239987  0    14105     8700  6.496973e-01  8.809540e-01
#   weights: A -> 0 0 1 2 3 4 5
#  N       rt  pl lbt  dis   lbo    lar gcd     satc           t        ppc st      nds      lvs          nsel         nsuel
#  6    count dom enu newv   asc  relpr   1        0     415.079    1234291  0    13997     8688  6.890501e-01  8.348211e-01
#   weights: L -> 0 0 1 1.5849625007211561815 2 2.3219280948873623478 2.5849625007211561815
#  N       rt  pl lbt  dis   lbo    lar gcd     satc           t        ppc st      nds      lvs          nsel         nsuel
#  6    count dom enu newv   asc  relpr   1        0     462.769    1204885  0    13733     8652  7.518530e-01  9.706667e-01

# Optimising tau-probs (3600s, rep=100):
# TAU/basis_6_newv_avepsd$ nomad np
# 435 1371.925862  -0.139901  -4.998706   7.699958  -7.000246   8.100211
# A termination criterion is reached: No termination (all). Mesh minimum precision reached (Algo)
# Blackbox evaluations: 1110 Total model evaluations: 101197 Cache hits: 429 Total number of evaluations: 1539
# TAU/basis_6_newv_avepsd$ time ./TAUscan 6 ../../basis "" enu newv hash "-0.139901,-4.998706,7.699958,-7.000246,8.100211" 100 10 all
# 100 : 4.36038012651596374375e+02 2.04715930570304860214e+03 3.49533414129621875901e+04; 3.64859681813148602081e+03
# real    0m2.728s user    0m25.247s sys     0m0.133s
# TAU/basis_6_newv_avepsd$ ./laMols 6 ../../basis "" count "" enu newv "" "" 1 16 "-0.139901,-4.998706,7.699958,-7.000246,8.100211" "" ""
#  N       rt  pl lbt  dis   lbo    lar gcd     satc           t        ppc st      nds      lvs          nsel         nsuel
#  6    count dom enu newv   asc  relpr   1        0     171.920     273858  0     2933     1844  1.902542e+00  7.738716e-01
#   mu0    qfppc  pprunes  pmprune  pprobes   rounds  solc       tr  pelvals      dp
#521.59  0.38882   10.405    130.9   153.26   1.4922     0   0.6248  0.23496  5.3333
#   500        0   3.8747   126.52   115.07        1     0  0.14692        0       0
#   660        2   23.625    131.8    430.2        4     0   2.5069   1.7647       8
#17.669  0.50613    3.571  0.66676   58.976  0.72265     0  0.28832  0.42194  1.1048
#   mu0    qfppc  pprunes  pmprune  pprobes   rounds  solc       tr  pelvals      dp
#478.12   1.6656   17.144   25.209   63.832   1.3552     0  0.29293    4.914  6.7397
#   209    1.037        0        0  0.46296        1     0        0  0.46296       5
#   515        5   171.43   128.51   493.37        5     0   2.9763   18.724       9
#54.579  0.51237   30.816   26.467   90.106  0.72635     0  0.41116   3.4741  0.7944
#      estlvs       uestlvs
#8.518668e+03  2.948330e+03
#4.360380e+02  5.400000e+02
#2.277598e+05  1.296000e+04
#2.845044e+04  2.272242e+03
#   dm0        w  ltausp       minp     meanp     maxp       sdd       tb
# 1.315   2.6924  54.807    0.28383   0.39643   0.5273   0.10996  0.56285
#     0        2  6.1796  0.0069174       0.2     0.25         0  0.25521
#     9        5  112.43        0.5       0.5  0.78823   0.33166  0.96241
#2.2681  0.73886   34.17     0.1461  0.095378  0.12909  0.085997  0.11303
# Somewhat better than before.

# Optimising uni-probs (3600s, rep=100):
# TAU/basis_6_newv_avepsd$ nomad nprand
# 611 1404.72      -1         -1.41       1.0       -4.699999 -10
# A termination criterion is reached: No termination (all). Mesh minimum precision reached (Algo)
# Blackbox evaluations: 1121 Total model evaluations: 100687 Cache hits: 359 Total number of evaluations: 1480
# TAU/basis_6_newv_avepsd$ time ./TAUscan 6 ../../basis "" enu,rand newv hash "-1,-1.41,1.0,-4.699999,-10" 100 10 all
# 100 : 3.24000000000000000000e+02 1.70568000000000000005e+03 5.76000000000000000000e+03; 1.18748506746592205496e+03
# real    0m3.036s user    0m25.406s sys     0m0.179s
# TAU/basis_6_newv_avepsd$ ./laMols 6 ../../basis "" count "" enu newv "" "" 1 16 "-1,-1.41,1.0,-4.699999,-10" "" ""
#  N       rt  pl lbt  dis   lbo    lar gcd     satc           t        ppc st      nds      lvs          nsel         nsuel
#  6    count dom enu newv   asc  relpr   1        0     158.039     275399  0     2949     1804  1.205773e+00  1.063613e+00
#   mu0    qfppc  pprunes  pmprune  pprobes   rounds  solc       tr  pelvals      dp
#521.75  0.55662   11.859   130.71   159.21   1.6638     0  0.61024  0.30896  5.5686
#   488        0   3.8747   126.52   113.38        1     0  0.10892        0       0
#   660        2   28.542   131.56    430.2        4     0   2.3831   1.8367       9
#18.192  0.54062   4.4803  0.66012   59.099  0.73353     0  0.27674   0.4436  1.2258
#   mu0   qfppc  pprunes  pmprune  pprobes   rounds  solc       tr  pelvals       dp
#476.99  1.6785   17.995   19.878   44.072    1.204     0  0.19611   4.8974   7.1375
#   209     1.1        0        0  0.74627        1     0        0  0.74627        5
#   515       4   195.65   126.56   493.37        5     0   3.4222   22.334       10
#51.895  0.4136    33.08   23.751   73.903  0.59808     0  0.33146   3.8419  0.97384
#      estlvs       uestlvs
#4.426813e+03  3.844816e+03
#3.060770e+02  3.240000e+02
#7.263171e+04  3.456000e+04
#8.779612e+03  5.303629e+03
#   dm0       w  ltausp      minp     meanp     maxp       sdd       tb
#1.7328  2.5747  14.782   0.30301   0.41664  0.52894   0.10444  0.52812
#     0       2  4.1403  0.019347       0.2  0.22938         0  0.22555
#     9       5  34.577       0.5       0.5  0.73947   0.26811  0.92578
#2.3863  0.7537  7.7291   0.14093  0.099235  0.11947  0.072791  0.12477


# N=7:

# Optimising TAUscan on ave via Nomad (MAX_TIME 40000s, rep=1000):
# TAU_basis_7_newv_ave$ nomad np
# 622  12813145.63597   -0.243384   8.060945  -6.967825   0.3856    -8.893625  -1.440316
# A termination criterion is reached: No termination (all). Mesh minimum precision reached (Algo)
# Blackbox evaluations: 1385 Total model evaluations: 115949 Cache hits: 406 Total number of evaluations: 1791
# TAU_basis_7_newv_ave$ time ./TAUscan 7 ../basis "" enu newv hash "-0.243384,8.060945,-6.967825,0.3856,-8.893625,-1.440316" 1000 10 all
# 1000 : 1.36032434089532176273e+05 1.28131456359695468536e+07 5.58999438843289125711e+08; 3.51805819314250074895e+07
# real    1m51.747s user    18m21.859s sys     0m2.415s
# The predicted number of leaves is better than rlaMols.
# TAU_basis_7_newv_ave$ time ./laMols 7 ../basis "" +count "" enu newv "" "" 1 16  "-0.243384,8.060945,-6.967825,0.3856,-8.893625,-1.440316" "" ""
#  N       rt  pl lbt  dis   lbo    lar gcd     satc           t        ppc st      nds    inds      lvs     plvs
#  7   +count dom enu newv   asc  relpr   1     2400 6018827.961 3541493141  0 36190105 15930715 20259390        0
#     mu0  qfppc   pprunes  pmprune   pprobes  rounds   solc      tr  pelvals      dp
# 887.160  0.723    14.829  124.361   166.661   2.038  0.000   2.418    0.457  14.168
# 604.000  0.000     2.701   59.224     5.033   1.000  0.000   0.000    0.000   0.000
#1176.000  3.000  1252.632  132.348  1177.338  12.000  0.000  57.000   30.080  21.000
#  30.843  0.490     4.049    1.171    79.981   0.961  0.000   1.457    0.677   1.764
#    mu0  qfppc   pprunes  pmprune   pprobes  rounds   solc      tr  pelvals      dp
#839.722  1.654     3.907   27.151    69.634   1.471  0.000   1.108    3.781  15.872
#270.000  1.020     0.000    0.000     0.241   1.000  0.000   0.000    0.224  10.000
#923.000  6.000  1100.000  128.759  1093.633  11.000  1.000  41.490   33.174  22.000
# 41.005  0.425     6.166   29.756    94.882   0.832  0.011   1.545    2.115   1.427
#      estlvs
#3.027244e+11
#7.929977e+04
#7.480034e+15
#2.100444e+13
#    mu1      w   ltau   minp  meanp   maxp    sdd      tb
#500.652  2.272  0.001  0.346  0.462  0.583  0.114   1.964
#252.000  2.000  0.000  0.000  0.167  0.194  0.000   0.000
#621.000  6.000  0.066  0.500  0.500  0.995  0.495  20.006
# 14.385  0.604  0.001  0.122  0.081  0.115  0.088   0.568
# real    7216m9.671s user    100313m47.976s sys     5057m40.880s
# Half of the leaves as rlaMols (and also somewhat faster).

# With "opportunism" turned off
# ("EVAL_OPPORTUNISTIC no"), and LH_SEARCH:
# TAU_basis_7_newv_ave$ nomad np2
# 1567  54747117.861943  -0.710051   0.957691   8.803312   1.625003  -6.183982  -8.245003
# A termination criterion is reached: Maximum allowed time reached (Base) No more points to evaluate
# Blackbox evaluations: 1639 Total model evaluations: 127740 Cache hits: 393 Total number of evaluations: 2032
# TAU_basis_7_newv_ave$ time ./TAUscan 7 ../basis "" enu newv hash "-0.710051,0.957691,8.803312,1.625003,-6.183982,-8.245003" 1000 10 all
# 1000 : 5.90092025733874308401e+05 6.66145533637098923864e+07 3.15579936454505730281e+09; 1.79741101164433105907e+08
# real    1m39.325s user    16m13.525s sys     0m2.369s
# Looks worse; so "opportunism" seems (roughly) to work.

# Rerunning with version >= 0.99:

# Optimising tau-probs (40000s, rep=10000):
# TAU/basis_7_newv_ave$ nomad np
# 142 231999126.350575  -1        -10          9          1        -10         10
# A termination criterion is reached: Maximum allowed time reached (Base) Success found and opportunistic strategy is used
# Blackbox evaluations: 151 Total model evaluations: 18196 Cache hits: 11 Total number of evaluations: 162
# A very weak result.
# Possibly a better strategy is first to use lower rep, and then refine with higher rep:
# TAU/basis_7_newv_ave$ nomad np3
# 399   9922896.985896  -1          8.54     -10          1         -9.23       1.17
# A termination criterion is reached: No termination (all). Mesh minimum precision reached (Algo)
# Blackbox evaluations: 1249 Total model evaluations: 111362 Cache hits: 390 Total number of evaluations: 1639
# Similar to old result (somewhat better).
# TAU/basis_7_newv_ave$ time ./TAUscan 7 ../../basis "" enu newv hash "-1,8.54,-10,1,-9.23,1.17" 1000 10 all
# 1000 : 9.66372388718203288818e+04 9.92289698589576216455e+06 4.51619428318711983855e+08; 2.92126665946392861279e+07
# real    1m57.496s user    19m17.745s sys     0m2.026s
# Restarting rep=10000 optimisation, with these values as starting point:
# TAU/basis_7_newv_ave$ nomad np4
# 1   19150633.4554    -1          8.54     -10          1         -9.23       1.17
# 125 16724595.802382   0.06       8.5       -9.07       0.94      -8.39       1.07
# A termination criterion is reached: Maximum allowed time reached (Base) No more points to evaluate
# Blackbox evaluations: 166 Total model evaluations: 14138 Cache hits: 15 Total number of evaluations: 181
# Some improvement obtained.
# TAU/basis_7_newv_ave$ time ./TAUscan 7 ../../basis "" enu newv hash "0.06,8.5,-9.07,0.94,-8.39,1.07" 10000 10 all
# 10000 : 4.76067261225841879408e+04 1.67245958023817242074e+07 4.83382422091734394152e+09; 9.25175042845227280268e+07
# real    19m22.760s user    192m37.889s sys     0m22.375
# MOLS> time ./laMols 7 data/SpecsCollection/3MOLS/basis "" +count "" enu newv "" "" 1 16  "0.06,8.5,-9.07,0.94,-8.39,1.07" "" ""
# running on server XXX

# Optimising uni-probs (40000s, rep=10000):
# TAU/basis_7_newv_ave$ nomad nprand
# 95 487154170.944      1         -9          7          5        -10          7
# A termination criterion is reached: Maximum allowed time reached (Base) No more points to evaluate
# Blackbox evaluations: 152 Total model evaluations: 14158 Cache hits: 10 Total number of evaluations: 162
# Very weak (as with tau-probs).
# Optimising first with rep=1000:
# TAU/basis_7_newv_ave$ nomad np3rand
# 1197  30242686.32      -0.044123   8.291712  -1.150959   1.093746  -9.920424  -5.686335
# A termination criterion is reached: No termination (all). Mesh minimum precision reached (Algo)
# Blackbox evaluations: 1291 Total model evaluations: 105425 Cache hits: 431 Total number of evaluations: 1722
# Much better than with high reps.
# Restarting rep=10000 optimisation, with these values as starting point:
# TAU/basis_7_newv_ave$ nomad np4rand
# XXX
# TAU/basis_7_newv_ave$ time ./TAUscan 7 ../../basis "" enu,rand newv hash "XXX" 10000 10 all
# XXX
# TAU/basis_7_newv_ave$ time ./laMols 7 ../../basis "" +count "" enu newv "" "" 1 16  "XXX" "" ""



squares A B C AB AC BC
ls A B C AB AC BC
red A
rred B C
rprod B AB A # thus A = AB^-1 B
rprod C AC A # thus A = AC^-1 C
rprod C BC B # AB^-1 B = AC^-1 C => BC = AC AB^-1

# Redundant condition:
# rprod BC   AC         c132 AB
