# Counts for N >= 2:
# 0, 0, 2, 36, 0, 2400

# QUESTION: what is the relation to 3MOLSinv (regarding solutions and solving-
# time)?


# gcMols:

# MOLS> ./gcMols 6 data/SpecsCollection/3MOLS/basis "" count dom - - "" 1 1 "t,4"
# solved only by maxdegdom:
#  N       rt  pl  bt        bv   bo gcd      satc           t           ppc        flvs        gnds     gd st
#  6    count dom bin maxdegdom  asc   1         0       2.024       9778149       60113      120225     15  0
#  6    count dom enu maxdegdom  asc   1         0       1.988       9658961       60113      108996     15  0


# N=7:

# MOLS> time ./gcMols 7 data/SpecsCollection/3MOLS/basis "" +count dom enu maxdegdom "" 1 16 ""
# aborted after
# real    197m14.058s user    1762m28.190s sys     660m11.641s
# with 4 solutions found.



# rlaMols:

# N=6:

# MOLS> time ./rlaMols 6 data/SpecsCollection/3MOLS/basis "" count dom enu maxdegdom "" "" 1 12 ""
#  N       rt  pl  bt        bv   bo    lar gcd     satc           t        ppc st      nds    inds      lvs
#  6   +count dom enu maxdegdom  asc  relpr   1        0     126.181     241533  0     3114    1318     1796
#    mu0  qfppc  pprunes  pmprune  pprobes  rounds   solc     tr  pelvals     dp
#587.938  0.737   12.908  127.736  198.465   2.135  0.000  0.474    0.805  5.294
#539.000  0.000    5.031  122.071  109.386   1.000  0.000  0.063    0.000  0.000
#660.000  1.400   27.067  129.550  589.116   6.000  0.000  1.837    4.082  7.000
# 20.108  0.466    3.778    0.810   77.528   0.924  0.000  0.247    0.750  1.032
#    mu0  qfppc  pprunes  pmprune  pprobes  rounds   solc     tr  pelvals     dp
#552.574  1.495    7.144   43.716  116.038   1.793  0.000  0.305    6.457  6.748
#212.000  1.100    0.000    0.000    0.943   1.000  0.000  0.000    0.943  6.000
#593.000  3.500  109.091  127.225  571.652   6.000  0.000  1.859   19.218  8.000
# 27.196  0.290    7.583   29.048  105.448   0.932  0.000  0.292    3.399  0.606
# real	0m13.261s user	2m6.183s sys	0m3.767s

# N=7:

# MOLS> time ./rlaMols 7 data/SpecsCollection/3MOLS/basis "" +count dom enu maxdegdom "" "" 1 16 ""
#  N       rt  pl  bt        bv   bo    lar gcd     satc           t        ppc st      nds    inds      lvs
#  7   +count dom enu maxdegdom  asc  relpr   1     2400 6721428.278 8263635879  0 75440601 33262378 42178223
#     mu0  qfppc  pprunes  pmprune  pprobes  rounds   solc      tr  pelvals      dp
# 898.590  0.677   20.095  123.455  145.760   1.779  0.000   2.408    0.327  15.390
# 588.000  0.000    4.405   74.689   72.372   1.000  0.000   0.019    0.000   0.000
#1176.000  3.000   87.701  129.762  982.559  10.000  1.000  34.155   28.631  31.000
#  54.596  0.507    5.634    1.042   50.821   0.685  0.002   1.201    0.452   2.596
#     mu0  qfppc  pprunes  pmprune   pprobes  rounds   solc      tr  pelvals      dp
# 827.224  1.870    1.421   17.743    31.297   1.140  0.000   0.551    2.486  17.883
# 270.000  1.031    0.000    0.000     0.246   1.000  0.000   0.000    0.206  10.000
#1004.000  5.000  248.649  126.579  1212.128  12.000  1.000  39.143   25.848  32.000
#  34.598  0.383    2.755   24.137    50.556   0.443  0.007   0.893    1.303   2.725
# real    7813m28.579s user    112023m48.286s sys     3096m31.286s

# N=8:

# MOLS> time ./rlaMols 8 data/SpecsCollection/3MOLS/basis "" +count dom enu maxdegdom "" "" 1 16 ""
# aborted:
#  N       rt  pl  bt        bv   bo    lar gcd     satc           t        ppc st      nds    inds      lvs
#  8   +count dom enu maxdegdom  asc  relpr   1        0 2302182.610 1559910265  1 14292904 5557235  8735669
#     mu0  qfppc  pprunes  pmprune  pprobes  rounds   solc      tr  pelvals      dp
#1048.775  0.956   38.528  122.552  164.178   2.075  0.000   4.654    0.601  35.578
# 835.000  0.000    3.909  104.074   70.938   1.000  0.000   0.135    0.000   0.000
#1904.000  4.000   86.075  127.166  736.049   8.000  0.000  25.684   10.579  50.000
#  69.533  0.296    9.010    1.193   44.526   0.498  0.000   1.528    0.529   2.515
#     mu0  qfppc  pprunes  pmprune  pprobes  rounds   solc      tr  pelvals      dp
# 999.077  1.898    1.622   23.329   38.001   1.142  0.000   1.198    2.035  37.159
# 441.000  1.032    0.000    0.000    0.169   1.000  0.000   0.000    0.168  22.000
#1368.000  6.000  125.098  125.368  692.730   8.000  0.000  33.085   20.954  51.000
#  64.321  0.382    5.634   18.626   47.472   0.393  0.000   1.440    1.458   2.390
# real    2474m14.690s user    38369m43.549s sys     435m55.464s



# laMols with wdL:

# MOLS> ./laMols 2,5 data/SpecsCollection/3MOLS/basis "" count "" enu wdL "" "" 1 1 "" "" ""
# all quickly solved by both A + L.

# N=6:

# MOLS> ./laMols 6 data/SpecsCollection/3MOLS/basis "" count "" enu wdL "" "" 1 12 "" "" ""
#   weights: A -> 0 0 1 2 3 4 5
#  N       rt  pl lbt  dis   lbo    lar gcd     satc           t        ppc st      nds    inds      lvs     plvs
#  6    count dom enu  wdL   asc  relpr   1        0     314.210    1287860  0    14384    5393     8991        0
#    mu0  qfppc  pprunes  pmprune  pprobes  rounds   solc     tr  pelvals      dp
#407.204  0.357    6.843  136.415  163.542   1.405  0.000  0.277    0.257   7.219
#371.000  0.000    0.000  126.515  111.860   1.000  0.000  0.033    0.000   0.000
#660.000  2.000   24.142  138.814  444.246   4.000  0.000  0.852    3.581  11.000
# 31.533  0.509    4.459    1.806   55.563   0.620  0.000  0.128    0.505   1.214
#    mu0  qfppc  pprunes  pmprune  pprobes  rounds   solc     tr  pelvals      dp
#367.881  1.743    3.119   18.606   40.058   1.128  0.000  0.077    4.119   8.730
#296.000  1.105    0.000    0.000    0.608   1.000  0.000  0.000    0.608   7.000
#392.000  4.000   44.444  129.504  480.463   4.000  0.000  0.941   10.997  12.000
# 14.141  0.372    3.525   18.842   58.750   0.403  0.000  0.106    1.677   0.848
#      estlvs
#1.454746e+04
#2.474211e+03
#3.023155e+05
#2.356874e+04
#    mu1      w   ltau   minp  meanp   maxp    sdd     tb
#406.027  2.667  0.046  0.321  0.397  0.483  0.074  0.232
#367.000  2.000  0.014  0.036  0.250  0.250  0.000  0.034
#660.000  4.000  0.103  0.500  0.500  0.853  0.353  0.569
# 30.958  0.654  0.021  0.127  0.093  0.107  0.065  0.047
##   weights: L -> 0 0 1 1.5849625007211561815 2 2.3219280948873623478 2.5849625007211561815
#  N       rt  pl lbt  dis   lbo    lar gcd     satc           t        ppc st      nds    inds      lvs     plvs
#  6    count dom enu  wdL   asc  relpr   1        0     283.192    1206182  0    13264    4973     8291        0
#    mu0  qfppc  pprunes  pmprune  pprobes  rounds   solc     tr  pelvals      dp
#408.789  0.419    6.388  136.346  172.564   1.532  0.000  0.267    0.279   7.113
#372.000  0.000    0.000  126.515  115.323   1.000  0.000  0.029    0.000   0.000
#660.000  2.000   20.280  138.710  442.931   4.000  0.000  0.906    2.811  10.000
# 32.449  0.517    4.209    1.822   64.485   0.733  0.000  0.163    0.469   1.133
#    mu0  qfppc  pprunes  pmprune  pprobes  rounds   solc     tr  pelvals      dp
#369.017  1.763    2.594   14.899   30.842   1.063  0.000  0.055    3.969   8.595
#327.000  1.118    0.000    0.000    0.885   1.000  0.000  0.000    0.885   7.000
#392.000  3.500   26.087  101.799  317.136   3.000  0.000  0.706   12.755  11.000
# 10.833  0.333    3.262   15.090   44.701   0.306  0.000  0.079    1.604   0.716
#      estlvs
#1.112034e+04
#1.890074e+03
#1.044799e+05
#7.255311e+03
#    mu1      w   ltau   minp  meanp   maxp    sdd     tb
#279.457  2.667  0.086  0.342  0.402  0.471  0.060  0.213
#261.000  2.000  0.021  0.061  0.250  0.250  0.000  0.030
#393.000  4.000  0.216  0.500  0.500  0.726  0.270  0.664
# 14.838  0.736  0.048  0.132  0.100  0.099  0.059  0.085

# Optimising TAUscan on ave via Nomad (MAX_TIME 3600s, rep=100):
# TAU_basis_6_wdL_ave$ nomad np
# 316 1567.331166   3.099962   5.100018   0.1002     6.999952
# Blackbox evaluations: 926 Total model evaluations: 85194 Cache hits: 311 Total number of evaluations: 1237
# TAU_basis_6_wdL_ave$ time ./TAUscan 6 ../basis "" enu wdL hash "3.099962,5.100018,0.1002,6.999952" 100 10 all
# 100 : 4.91278756084007450944e+02 2.10780989357942208207e+03 1.14061916559860725284e+04; 1.89668206647840879486e+03
# real    0m2.462s user    0m23.173s sys     0m0.161s
# TAU_basis_6_wdL_ave$ ./laMols 6 ../basis "" count "" enu wdL "" "" 1 16 "3.099962,5.100018,0.1002,6.999952" "" ""
#  N       rt  pl lbt  dis   lbo    lar gcd     satc           t        ppc st      nds    inds      lvs     plvs
#  6    count dom enu  wdL   asc  relpr   1        0     158.702     323129  0     3429    1113     2316        0
#    mu0  qfppc  pprunes  pmprune  pprobes  rounds   solc     tr  pelvals     dp
#520.115  0.402   10.327  130.884  158.380   1.532  0.000  0.512    0.297  5.398
#488.000  0.000    3.875  126.515  115.460   1.000  0.000  0.176    0.000  0.000
#660.000  2.000   19.038  131.683  353.360   3.000  0.000  2.036    1.844  8.000
# 18.924  0.508    3.164    0.664   59.348   0.728  0.000  0.224    0.493  1.160
#    mu0  qfppc  pprunes  pmprune  pprobes  rounds   solc     tr  pelvals     dp
#475.962  1.711   15.621   17.869   39.211   1.198  0.000  0.147    3.855  6.907
#216.000  1.091    0.000    0.000    0.463   1.000  0.000  0.000    0.463  5.000
#515.000  4.000  171.429  101.423  358.230   4.000  0.000  1.599   17.520  9.000
# 36.972  0.474   25.294   22.173   69.718   0.551  0.000  0.258    2.724  0.867
#      estlvs
#1.297151e+04
#4.912788e+02
#9.740462e+05
#7.234668e+04
#      mu1      w   ltau   minp  meanp   maxp    sdd     tb
#36487.447  3.080  0.000  0.224  0.349  0.496  0.119  0.451
#31270.000  2.000  0.000  0.002  0.200  0.227  0.000  0.196
#54316.000  5.000  0.001  0.500  0.500  0.879  0.379  0.859
# 3014.746  0.828  0.000  0.135  0.095  0.150  0.091  0.118
# A decent improvement (close to rlaMols).

# N=7:

# Optimising TAUscan on ave via Nomad (MAX_TIME 40000s, rep=1000):
# TAU_basis_7_wdL_ave$ nomad np
# Aborted early:
#BBE OBJ SOL
#1 602920332.736149   0.1        0.1        0.1        0.1        0.1
#14 578392700.718591   0.0001     0.1        0.1        0.1        1.1
#18 520396628.42514    0.0001     0.0001     0.0001     0.1        2.1
#30 495171258.814525   0.0001     0.0001     0.0001     0.1        3.1
#62 446119742.595062   0.0001     0.0001     0.0801     0.0001     4.1
#199 434578624.0758     0.0331     0.0301     0.1141     0.0041     3.6
#292 433077315.351203   0.032958   0.0351     0.114026   0.003854   3.6043
# Does not look promising.



# laMols with newvars:

# MOLS> ./laMols 2,5 data/SpecsCollection/3MOLS/basis "" count "" enu newv "" "" 1 1 "" "" ""
# all quickly solved by all four weights.

# N=6:

# MOLS> ./laMols 6 data/SpecsCollection/3MOLS/basis "" count "" enu newv "" "" 1 12 "" "" ""
# Z worst, O, A, L all very similar, with L slightly best:
#  N       rt  pl lbt  dis   lbo    lar gcd     satc           t        ppc st      nds    inds      lvs     plvs
#  6    count dom enu newv   asc  relpr   1        0     327.784    1218423  0    13709    4973     8736        0
#    mu0  qfppc  pprunes  pmprune  pprobes  rounds   solc     tr  pelvals      dp
#409.565  0.316    6.800  136.175  164.224   1.397  0.000  0.300    0.288   7.324
#372.000  0.000    0.000  126.515  116.622   1.000  0.000  0.072    0.000   0.000
#660.000  2.000   26.017  138.710  436.829   4.000  0.000  1.069    3.571  10.000
# 33.023  0.487    4.830    2.029   64.004   0.688  0.000  0.158    0.635   1.280
#    mu0  qfppc  pprunes  pmprune  pprobes  rounds   solc     tr  pelvals      dp
#370.165  1.721    2.427   19.482   44.853   1.141  0.000  0.092    4.314   8.804
#299.000  1.100    0.000    0.000    0.877   1.000  0.000  0.000    0.860   7.000
#392.000  4.000   31.579  129.716  484.496   4.000  0.000  1.094   11.054  11.000
# 14.205  0.386    2.821   21.239   67.626   0.469  0.000  0.129    1.799   0.888
#      estlvs
#1.436700e+04
#2.730977e+03
#2.353071e+05
#2.036622e+04
#    mu1      w   ltau   minp  meanp   maxp    sdd     tb
#279.563  2.756  0.039  0.288  0.384  0.464  0.079  0.252
#258.000  2.000  0.009  0.046  0.250  0.250  0.000  0.087
#393.000  4.000  0.086  0.500  0.500  0.763  0.263  0.556
# 15.536  0.645  0.019  0.130  0.091  0.111  0.064  0.058

# Optimising TAUscan on ave via Nomad (MAX_TIME 3600s, rep=100):
# TAU_basis_6_newv_ave$ nomad np
# 414 1450.694695  -0.999999 -10          9.990301  -7.009546  -0.999608
# Blackbox evaluations: 1086 Total model evaluations: 99516 Cache hits: 331 Total number of evaluations: 1417
# TAU_basis_6_newv_ave$ time ./TAUscan 6 ../basis "" enu newv hash "-0.999999,-10,9.990301,-7.009546,-0.999608" 100 10 all
# 100 : 4.74391932586464136840e+02 2.56038467074486284614e+03 6.13635477517657089699e+04; 6.10667485546389499529e+03
# real    0m2.335s user    0m20.981s sys     0m0.174s
# TAU_basis_6_newv_ave$ ./laMols 6 ../basis "" count "" enu newv "" "" 1 16 "-0.999999,-10,9.990301,-7.009546,-0.999608" "" ""
#  N       rt  pl lbt  dis   lbo    lar gcd     satc           t        ppc st      nds    inds      lvs     plvs
#  6    count dom enu newv   asc  relpr   1        0      49.991     290632  0     3149    1137     2012        0
#    mu0  qfppc  pprunes  pmprune  pprobes  rounds   solc     tr  pelvals     dp
#520.387  0.425   10.880  130.877  156.381   1.510  0.000  0.026    0.297  5.397
#490.000  0.000    3.875  126.515  115.460   1.000  0.000  0.011    0.000  0.000
#660.000  2.000   28.542  131.800  430.196   4.000  0.000  0.321    1.837  8.000
# 18.151  0.527    4.190    0.657   59.139   0.710  0.000  0.020    0.493  1.131
#    mu0  qfppc  pprunes  pmprune  pprobes  rounds   solc     tr  pelvals     dp
#477.817  1.657   18.694   21.779   49.944   1.256  0.000  0.010    4.384  6.849
#216.000  1.045    0.000    0.000    0.463   1.000  0.000  0.000    0.463  5.000
#515.000  4.000  195.652   92.798  358.230   4.000  0.000  0.094   16.327  9.000
# 40.168  0.454   31.819   22.470   74.689   0.582  0.000  0.015    3.066  0.849
#      estlvs
#6.388124e+03
#4.405855e+02
#2.213407e+05
#1.833575e+04
#    mu1      w   ltau   minp  meanp   maxp    sdd     tb
#329.447  2.769  0.124  0.273  0.385  0.519  0.111  0.025
#310.000  2.000  0.045  0.009  0.200  0.250  0.000  0.013
#393.000  5.000  0.223  0.500  0.500  0.860  0.360  0.256
#  9.148  0.734  0.038  0.138  0.094  0.127  0.084  0.016
# A reasonable result.

# Optimising TAUscan on ave+sd via Nomad (MAX_TIME 3600s, rep=100):
# TAU_basis_6_newv_avepsd$ nomad np
# 751  2513.392254   1.0        8.262      3.0       -5.672      1.7265
# A termination criterion is reached: No termination (all). Mesh minimum precision reached (Algo)
# Blackbox evaluations: 1145 Total model evaluations: 99328 Cache hits: 420 Total number of evaluations: 1565
# TAU_basis_6_newv_avepsd$ time ./TAUscan 6 ../basis "" enu newv hash "1.0,8.262,3.0,-5.672,1.7265" 100 10 all
# 100 : 4.65142577979407506716e+02 1.97107337154761465714e+03 8.04371972017600085270e+03; 1.57460496638359582966e+03
# real    0m2.273s user    0m21.045s sys     0m0.151s
# TAU_basis_6_newv_avepsd$ ./laMols 6 ../basis "" count "" enu newv "" "" 1 16 "1.0,8.262,3.0,-5.672,1.7265" "" ""
#  N       rt  pl lbt  dis   lbo    lar gcd     satc           t        ppc st      nds    inds      lvs     plvs
#  6    count dom enu newv   asc  relpr   1        0     151.305     295187  0     3221    1161     2060        0
#    mu0  qfppc  pprunes  pmprune  pprobes  rounds   solc     tr  pelvals     dp
#520.131  0.437   11.004  130.889  155.942   1.520  0.000  0.528    0.295  5.416
#490.000  0.000    3.875  126.515  115.460   1.000  0.000  0.113    0.000  0.000
#660.000  2.000   28.542  131.800  430.196   4.000  0.000  2.240    1.837  8.000
# 18.048  0.528    4.243    0.656   58.562   0.706  0.000  0.255    0.488  1.130
#    mu0  qfppc  pprunes  pmprune  pprobes  rounds   solc     tr  pelvals     dp
#477.495  1.663   18.636   21.287   46.208   1.230  0.000  0.190    4.291  6.872
#216.000  1.045    0.000    0.000    0.463   1.000  0.000  0.000    0.463  5.000
#515.000  4.000  195.652   92.798  358.230   4.000  0.000  1.863   16.327  9.000
# 39.530  0.447   31.506   22.210   69.877   0.546  0.000  0.276    2.937  0.845
#      estlvs
#5.829808e+03
#4.651426e+02
#1.585423e+05
#1.401171e+04
#    mu1      w   ltau   minp  meanp   maxp    sdd     tb
#329.314  2.773  0.000  0.273  0.384  0.520  0.111  0.470
#310.000  2.000  0.000  0.012  0.200  0.250  0.000  0.119
#393.000  5.000  0.000  0.500  0.500  0.855  0.355  0.730
#  9.099  0.727  0.000  0.136  0.093  0.126  0.083  0.110
# Basically the same.

# N=7:

# Optimising TAUscan on ave via Nomad (MAX_TIME 40000s, rep=1000):
# TAU_basis_7_newv_ave$ nomad np
# 622  12813145.63597   -0.243384   8.060945  -6.967825   0.3856    -8.893625  -1.440316
# A termination criterion is reached: No termination (all). Mesh minimum precision reached (Algo)
# Blackbox evaluations: 1385 Total model evaluations: 115949 Cache hits: 406 Total number of evaluations: 1791
# TAU_basis_7_newv_ave$ time ./TAUscan 7 ../basis "" enu newv hash "-0.243384,8.060945,-6.967825,0.3856,-8.893625,-1.440316" 1000 10 all
# 1000 : 1.36032434089532176273e+05 1.28131456359695468536e+07 5.58999438843289125711e+08; 3.51805819314250074895e+07
# real    1m51.747s user    18m21.859s sys     0m2.415s
# Getting closer to rlaMols, but still too slow.

# With "opportunism" turned off
# ("EVAL_OPPORTUNISTIC no"), and LH_SEARCH:
# TAU_basis_7_newv_ave$ nomad np2
# running on server2 XXX



squares A B C AB AC BC
ls A B C AB AC BC
red A
rred B C
rprod B AB A # thus A = AB^-1 B
rprod C AC A # thus A = AC^-1 C
rprod C BC B # AB^-1 B = AC^-1 C => BC = AC AB^-1

# Redundant condition:
# rprod BC   AC         c132 AB
