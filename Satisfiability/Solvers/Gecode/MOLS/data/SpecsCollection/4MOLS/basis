# Counts for N >= 2:
# 0, 0, 0, 36, 0, >= 720
# Apparently not in OEIS.
#

# gcMols:

# MOLS> ./gcMols 2,5 data/SpecsCollection/4MOLS/basis "" count dom enu mindom "" 1 1 ""
#  N       rt  pl  bt        bv   bo gcd      satc           t           ppc        flvs        gnds     gd st
#  2    count dom enu    mindom  asc   1         0       0.000            44           1           0      0  0
#  3    count dom enu    mindom  asc   1         0       0.000           153           1           0      0  0
#  4    count dom enu    mindom  asc   1         0       0.000          1722           8          15      3  0
#  5    count dom enu    mindom  asc   1        36       0.009         46991         210         434      8  0

# N=6:

# MOLS> ./gcMols 6 data/SpecsCollection/4MOLS/basis "" count dom - - "" 1 1 "t,20"
# Two successes:
#  N       rt  pl  bt        bv   bo gcd      satc           t           ppc        flvs        gnds     gd st
#  6    count dom bin    mindeg  asc   1         0      10.838      56244746      247036      494071     19  0
#  6    count dom enu    mindeg  asc   1         0       8.627      46670198      181946      305266     16  0
# So dom+enum+mindeg is best (at least for N=6).

# N=7:

# MOLS> time ./gcMols 7 data/SpecsCollection/4MOLS/basis "" +count dom enu mindom "" 1 16 ""
# running on server2 XXX 720 solutions found

# MOLS> time ./gcMols 7 data/SpecsCollection/4MOLS/basis "" +count dom enu mindeg "" 1 16 ""
# running on server2 XXX 48 solutions found



# rlaMols:

# N=6:

# MOLS> ./rlaMols 6 data/SpecsCollection/4MOLS/basis "" count dom - - "" "" 1 16 "lvs,20000"
# clearly best: bin/enu + maxdegdom:
#  N       rt  pl  bt        bv   bo    lar gcd     satc           t        ppc st      nds    inds      lvs
#  6    count dom bin maxdegdom  asc  relpr   1        0    1196.234     850522  0    11537    5768     5769
#     mu0  qfppc  pprunes  pmprune  pprobes  rounds   solc     tr  pelvals      dp
#1035.279  0.603   11.356  127.501  143.576   1.688  0.000  1.267    0.204  11.900
# 996.000  0.000    4.396  126.106  110.876   1.000  0.000  0.142    0.000   0.000
#1130.000  2.000   23.103  128.414  444.311   4.000  0.000  7.861    1.465  17.000
#  25.655  0.548    2.978    0.420   47.859   0.684  0.000  0.835    0.278   2.344
#     mu0  qfppc  pprunes  pmprune  pprobes  rounds   solc     tr  pelvals      dp
# 996.631  1.513    6.637   34.270   71.643   1.370  0.000  0.717    2.645  13.898
# 951.000  1.074    0.000    0.837    0.941   1.000  0.000  0.009    0.418   6.000
#1066.000  2.600   46.154  127.218  480.200   5.000  0.000  7.155   13.300  18.000
#  14.834  0.230    6.057   30.376   76.538   0.613  0.000  0.891    1.431   1.878
#  N       rt  pl  bt        bv   bo    lar gcd     satc           t        ppc st      nds    inds      lvs
#  6    count dom enu maxdegdom  asc  relpr   1        0    1086.338     877339  0    10900    4924     5976
#     mu0  qfppc  pprunes  pmprune  pprobes  rounds   solc     tr  pelvals     dp
#1031.048  0.682   11.673  127.550  147.624   1.780  0.000  1.374    0.235  6.768
# 998.000  0.000    4.396  126.106  110.876   1.000  0.000  0.031    0.000  0.000
#1130.000  2.000   23.103  128.300  444.311   4.000  0.000  7.973    1.465  8.000
#  24.122  0.535    2.938    0.417   50.379   0.682  0.000  1.080    0.290  1.140
#     mu0  qfppc  pprunes  pmprune  pprobes  rounds   solc     tr  pelvals     dp
# 995.302  1.528    7.004   31.910   67.066   1.346  0.000  0.695    2.565  8.431
# 893.000  1.077    0.000    0.000    0.219   1.000  0.000  0.000    0.219  6.000
#1063.000  4.000   46.154  127.218  480.200   5.000  0.000  8.735   13.300  9.000
#  17.130  0.248    6.375   30.336   76.238   0.602  0.000  1.004    1.430  0.624

# N=7:

# MOLS> time ./rlaMols 7 data/SpecsCollection/4MOLS/basis "" +count dom enu maxdegdom "" "" 1 16 ""
# running on server2 XXX 3 solutions found



# laMols with wdL

# N=6:

# Optimising for lvs via Nomad:
# LVS_basis_6_wdL$ nomad np
# 48 2292          2.1        3          0.0001     1.1
# A termination criterion is reached: Maximum allowed time reached (Base) No more points to evaluate
# Blackbox evaluations: 750 Total model evaluations: 45829 Cache hits: 107 Total number of evaluations: 857
# LVS_basis_6_wdL$ time ./laMols 6 ../basis "" count dom enu wdL "" "" 1 16 "2.1,3,0.0001,1.1" "" ""
#  N       rt  pl lbt  dis   lbo    lar gcd     satc           t        ppc st      nds    inds      lvs     plvs
#  6    count dom enu  wdL   asc  relpr   1        0     506.517     436137  0     3405    1113     2292        0
#     mu0  qfppc  pprunes  pmprune  pprobes  rounds   solc     tr  pelvals     dp
# 965.389  0.403    8.869  129.008  152.021   1.510  0.000  2.096    0.218  5.398
# 925.000  0.000    4.036  126.106  116.545   1.000  0.000  0.573    0.000  0.000
#1130.000  2.000   13.748  129.424  340.689   3.000  0.000  6.414    1.730  8.000
#  22.375  0.510    1.914    0.438   56.208   0.698  0.000  0.908    0.410  1.160
#    mu0  qfppc  pprunes  pmprune  pprobes  rounds   solc     tr  pelvals     dp
#912.220  1.707   16.142   12.072   31.661   1.184  0.000  0.504    2.201  6.913
#540.000  1.073    0.000    0.000    0.233   1.000  0.000  0.000    0.233  5.000
#959.000  4.000  171.429   97.186  363.420   4.000  0.000  6.921   12.750  9.000
# 50.100  0.472   25.708   20.231   67.365   0.543  0.000  1.037    1.824  0.868
#      estlvs
#2.077073e+04
#4.897156e+02
#1.753998e+06
#1.355185e+05
#      mu1      w   ltau   minp  meanp   maxp    sdd     tb
# 7810.607  3.058  0.003  0.217  0.351  0.506  0.126  1.888
# 7151.000  2.000  0.001  0.001  0.200  0.230  0.000  0.579
#10118.000  5.000  0.006  0.500  0.500  0.895  0.395  3.357
#  371.321  0.816  0.001  0.139  0.094  0.155  0.096  0.408
# real    0m44.147s user    8m26.527s sys     0m21.496s

# Optimising TAUscan on ave via Nomad (MAX_TIME 3600s, rep=100):
# TAU_basis_6_wdL_ave$ nomad np
# 248 1757.816506   1.765      2.64       0.0067     0.0101
# A termination criterion is reached: No termination (all). Mesh minimum precision reached (Algo)
# Blackbox evaluations: 1033 Total model evaluations: 96603 Cache hits: 392 Total number of evaluations: 1425
# TAU_basis_6_wdL_ave$ time ./TAUscan 6 ../basis "" enu wdL hash "1.765,2.64,0.0067,0.0101" 100 10 all
# 100 : 4.91985915554090475488e+02 2.23871147770567961732e+03 1.27468551182104811881e+04; 1.94125181647070586943e+03
# real    0m6.710s user    1m2.152s sys     0m0.388s
# TAU_basis_6_wdL_ave$ time ./laMols 6 ../basis "" count dom enu wdL "" "" 1 16 "1.765,2.64,0.0067,0.0101" "" ""
#  N       rt  pl lbt  dis   lbo    lar gcd     satc           t        ppc st      nds    inds      lvs     plvs
#  6    count dom enu  wdL   asc  relpr   1        0     531.324     503980  0     3621    1161     2460        0
#     mu0  qfppc  pprunes  pmprune  pprobes  rounds   solc     tr  pelvals     dp
# 964.215  0.428    9.139  128.980  159.149   1.576  0.000  2.286    0.271  5.457
# 925.000  0.000    4.036  126.106  116.126   1.000  0.000  0.633    0.000  0.000
#1130.000  2.000   16.556  129.424  340.043   3.000  0.000  7.460    1.730  8.000
#  22.683  0.514    2.182    0.447   63.478   0.751  0.000  1.162    0.473  1.180
#    mu0  qfppc  pprunes  pmprune  pprobes  rounds   solc     tr  pelvals     dp
#903.893  1.830   17.644   10.659   26.248   1.146  0.000  0.433    2.098  6.990
#540.000  1.083    0.000    0.000    0.233   1.000  0.000  0.000    0.233  5.000
#959.000  5.000  171.429   96.104  362.121   4.000  0.000  7.898   13.853  9.000
# 62.722  0.611   30.612   18.878   61.871   0.494  0.000  0.994    1.719  0.891
#      estlvs
#5.910090e+05
#4.919859e+02
#8.042119e+07
#5.961005e+06
#     mu1      w   ltau   minp  meanp   maxp    sdd     tb
#4877.627  3.118  0.005  0.207  0.345  0.502  0.127  1.959
#4491.000  2.000  0.002  0.000  0.200  0.231  0.000  0.725
#6273.000  5.000  0.010  0.500  0.500  0.893  0.393  3.913
# 224.559  0.831  0.002  0.143  0.095  0.155  0.096  0.569
# real    0m46.760s user    8m51.348s sys     0m22.820s
# Number of leaves only slightly worse than above, but estlvs much higher.



# laMols with newvars:

# MOLS> time ./laMols 6 data/SpecsCollection/4MOLS/basis "" count dom enu newv "" "" 1 12 "0" "" ""
#  N       rt  pl lbt  dis   lbo    lar gcd     satc           t        ppc st      nds    inds      lvs     plvs
#  6    count dom enu newv   asc  relpr   1        0     642.170    2023685  0    12053    3809     8244        0
#     mu0  qfppc  pprunes  pmprune  pprobes  rounds   solc     tr  pelvals      dp
# 717.631  0.559    4.552  134.872  176.715   1.536  0.000  0.591    0.629   7.274
# 663.000  0.000    0.000  126.106  117.496   1.000  0.000  0.035    0.000   0.000
#1130.000  1.533   17.073  137.557  265.714   2.000  0.000  2.537    4.540  10.000
#  88.958  0.527    4.769    3.114   52.094   0.499  0.000  0.467    0.980   1.360
#    mu0  qfppc  pprunes  pmprune  pprobes  rounds   solc     tr  pelvals      dp
#633.311  1.765    1.709   18.926   74.317   1.407  0.000  0.231    3.066   8.797
#591.000  1.054    0.000    0.000    0.672   1.000  0.000  0.000    0.672   7.000
#665.000  4.000   12.500  106.316  416.692   4.000  0.000  1.833   10.376  11.000
# 31.605  0.523    2.148   22.026   99.529   0.673  0.000  0.346    2.071   0.960
#      estlvs
#1.379129e+04
#2.267437e+03
#5.770856e+04
#9.868476e+03
#    mu1      w   ltau   minp  meanp   maxp    sdd     tb
#482.909  3.164  0.052  0.267  0.336  0.421  0.070  0.436
#455.000  2.000  0.006  0.065  0.250  0.250  0.000  0.040
#668.000  4.000  0.112  0.500  0.500  0.736  0.282  1.386
# 38.987  0.727  0.043  0.107  0.089  0.130  0.063  0.246
# real	1m17.501s user	10m42.178s sys	0m3.918s

# Optimising for lvs via Nomad:
# LVS_basis_6_newv$ nomad np
# running on server2 XXX



squares A B C D  AB AC AD BC BD CD
ls A B C D  AB AC AD BC BD CD
red A
rred B C D AB AC AD BC BD CD
rprod B AB A
rprod C AC A
rprod D AD A
rprod C BC B
rprod D BD B
rprod D CD C
