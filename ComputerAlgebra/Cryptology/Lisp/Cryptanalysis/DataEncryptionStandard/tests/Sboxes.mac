/* Matthew Gwynne, 26.3.2011 (Swansea) */
/* Copyright 2011 Oliver Kullmann
This file is part of the OKlibrary. OKlibrary is free software; you can redistribute
it and/or modify it under the terms of the GNU General Public License as published by
the Free Software Foundation and included in this library; either version 3 of the
License, or any later version. */

/*!
  \file ComputerAlgebra/Cryptology/Lisp/Cryptanalysis/DataEncryptionStandard/tests/Sboxes.mac
  \brief Tests regarding constraint translations of DES.

Use by

oklib_load("OKlib/ComputerAlgebra/Cryptology/Lisp/Cryptanalysis/DataEncryptionStandard/tests/Sboxes.mac");

*/

/*!
\htmlonly
*/

oklib_include("OKlib/ComputerAlgebra/TestSystem/Lisp/Asserts.mac")$

kill(f)$

okltest_des_sbox_fulldnf_cl(f) := block(
  assert(f(1) =
    [{-10,-6,-5,-4,-3,-2,-1,7,8,9},
     {-10,-9,-8,-7,-5,-4,-3,-2,-1,6},
     {-10,-9,-7,-6,-4,-3,-2,-1,5,8},{-4,-3,-2,-1,5,6,7,8,9,10},
     {-9,-6,-5,-3,-2,-1,4,7,8,10},{-7,-5,-3,-2,-1,4,6,8,9,10},
     {-9,-8,-7,-6,-3,-2,-1,4,5,10},{-10,-9,-7,-3,-2,-1,4,5,6,8},
     {-10,-8,-7,-6,-5,-4,-2,-1,3,9},{-10,-5,-4,-2,-1,3,6,7,8,9},
     {-6,-4,-2,-1,3,5,7,8,9,10},{-10,-8,-7,-4,-2,-1,3,5,6,9},
     {-8,-6,-5,-2,-1,3,4,7,9,10},{-9,-5,-2,-1,3,4,6,7,8,10},
     {-10,-9,-8,-6,-2,-1,3,4,5,7},{-9,-8,-7,-2,-1,3,4,5,6,10},
     {-8,-7,-6,-5,-4,-3,-1,2,9,10},{-10,-8,-5,-4,-3,-1,2,6,7,9},
     {-10,-8,-6,-4,-3,-1,2,5,7,9},{-10,-7,-4,-3,-1,2,5,6,8,9},
     {-10,-7,-6,-5,-3,-1,2,4,8,9},{-10,-9,-5,-3,-1,2,4,6,7,8},
     {-10,-9,-6,-3,-1,2,4,5,7,8},{-8,-3,-1,2,4,5,6,7,9,10},
     {-9,-7,-6,-5,-4,-1,2,3,8,10},{-9,-8,-5,-4,-1,2,3,6,7,10},
     {-9,-8,-6,-4,-1,2,3,5,7,10},{-9,-7,-4,-1,2,3,5,6,8,10},
     {-10,-9,-8,-7,-6,-5,-1,2,3,4},{-8,-7,-5,-1,2,3,4,6,9,10},
     {-7,-6,-1,2,3,4,5,8,9,10},{-10,-9,-8,-1,2,3,4,5,6,7},
     {-10,-9,-7,-6,-5,-4,-3,-2,1,8},{-5,-4,-3,-2,1,6,7,8,9,10},
     {-9,-8,-7,-6,-4,-3,-2,1,5,10},{-10,-9,-4,-3,-2,1,5,6,7,8},
     {-10,-6,-5,-3,-2,1,4,7,8,9},{-10,-9,-8,-5,-3,-2,1,4,6,7},
     {-10,-9,-8,-6,-3,-2,1,4,5,7},{-10,-8,-7,-3,-2,1,4,5,6,9},
     {-9,-6,-5,-4,-2,1,3,7,8,10},{-10,-9,-7,-5,-4,-2,1,3,6,8},
     {-10,-7,-6,-4,-2,1,3,5,8,9},{-9,-8,-4,-2,1,3,5,6,7,10},
     {-10,-8,-7,-6,-5,-2,1,3,4,9},{-9,-8,-7,-5,-2,1,3,4,6,10},
     {-8,-6,-2,1,3,4,5,7,9,10},{-7,-2,1,3,4,5,6,8,9,10},
     {-6,-5,-4,-3,1,2,7,8,9,10},{-9,-7,-5,-4,-3,1,2,6,8,10},
     {-10,-9,-6,-4,-3,1,2,5,7,8},{-8,-4,-3,1,2,5,6,7,9,10},
     {-9,-8,-6,-5,-3,1,2,4,7,10},{-8,-7,-5,-3,1,2,4,6,9,10},
     {-7,-6,-3,1,2,4,5,8,9,10},{-10,-3,1,2,4,5,6,7,8,9},
     {-8,-7,-6,-5,-4,1,2,3,9,10},{-10,-8,-5,-4,1,2,3,6,7,9},
     {-10,-8,-6,-4,1,2,3,5,7,9},{-10,-9,-8,-7,-4,1,2,3,5,6},
     {-9,-7,-6,-5,1,2,3,4,8,10},{-10,-7,-5,1,2,3,4,6,8,9},
     {-10,-9,-8,-7,-6,1,2,3,4,5},{-9,1,2,3,4,5,6,7,8,10}]),
  assert(f(5) =
    [{-10,-8,-7,-6,-5,-4,-3,-2,-1,9},{-10,-5,-4,-3,-2,-1,6,7,8,9},
     {-10,-9,-6,-4,-3,-2,-1,5,7,8},{-8,-4,-3,-2,-1,5,6,7,9,10},
     {-10,-9,-7,-6,-5,-3,-2,-1,4,8},{-10,-8,-7,-5,-3,-2,-1,4,6,9},
     {-9,-8,-7,-6,-3,-2,-1,4,5,10},{-10,-9,-3,-2,-1,4,5,6,7,8},
     {-7,-6,-5,-4,-2,-1,3,8,9,10},{-10,-9,-7,-5,-4,-2,-1,3,6,8},
     {-10,-8,-6,-4,-2,-1,3,5,7,9},{-7,-4,-2,-1,3,5,6,8,9,10},
     {-8,-6,-5,-2,-1,3,4,7,9,10},{-9,-5,-2,-1,3,4,6,7,8,10},
     {-10,-7,-6,-2,-1,3,4,5,8,9},{-9,-8,-7,-2,-1,3,4,5,6,10},
     {-10,-9,-8,-6,-5,-4,-3,-1,2,7},{-9,-7,-5,-4,-3,-1,2,6,8,10},
     {-9,-7,-6,-4,-3,-1,2,5,8,10},{-10,-9,-8,-7,-4,-3,-1,2,5,6},
     {-8,-7,-6,-5,-3,-1,2,4,9,10},{-5,-3,-1,2,4,6,7,8,9,10},
     {-6,-3,-1,2,4,5,7,8,9,10},{-10,-8,-3,-1,2,4,5,6,7,9},
     {-9,-6,-5,-4,-1,2,3,7,8,10},{-8,-7,-5,-4,-1,2,3,6,9,10},
     {-10,-9,-8,-7,-6,-4,-1,2,3,5},{-9,-8,-4,-1,2,3,5,6,7,10},
     {-10,-6,-5,-1,2,3,4,7,8,9},{-10,-9,-8,-5,-1,2,3,4,6,7},
     {-9,-8,-6,-1,2,3,4,5,7,10},{-10,-7,-1,2,3,4,5,6,8,9},
     {-10,-9,-7,-6,-5,-4,-3,-2,1,8},{-8,-5,-4,-3,-2,1,6,7,9,10},
     {-10,-8,-7,-6,-4,-3,-2,1,5,9},{-10,-9,-8,-4,-3,-2,1,5,6,7},
     {-9,-8,-7,-6,-5,-3,-2,1,4,10},{-10,-9,-5,-3,-2,1,4,6,7,8},
     {-8,-6,-3,-2,1,4,5,7,9,10},{-7,-3,-2,1,4,5,6,8,9,10},
     {-10,-8,-6,-5,-4,-2,1,3,7,9},{-9,-8,-7,-5,-4,-2,1,3,6,10},
     {-9,-6,-4,-2,1,3,5,7,8,10},{-10,-4,-2,1,3,5,6,7,8,9},
     {-7,-6,-5,-2,1,3,4,8,9,10},{-10,-8,-7,-5,-2,1,3,4,6,9},
     {-10,-9,-8,-6,-2,1,3,4,5,7},{-9,-2,1,3,4,5,6,7,8,10},
     {-6,-5,-4,-3,1,2,7,8,9,10},{-10,-7,-5,-4,-3,1,2,6,8,9},
     {-9,-8,-6,-4,-3,1,2,5,7,10},{-4,-3,1,2,5,6,7,8,9,10},
     {-10,-9,-6,-5,-3,1,2,4,7,8},{-10,-9,-8,-7,-5,-3,1,2,4,6},
     {-9,-7,-6,-3,1,2,4,5,8,10},{-9,-8,-3,1,2,4,5,6,7,10},
     {-10,-7,-6,-5,-4,1,2,3,8,9},{-10,-8,-5,-4,1,2,3,6,7,9},
     {-8,-7,-6,-4,1,2,3,5,9,10},{-10,-9,-7,-4,1,2,3,5,6,8},
     {-10,-9,-8,-7,-6,-5,1,2,3,4},{-9,-7,-5,1,2,3,4,6,8,10},
     {-10,-6,1,2,3,4,5,7,8,9},{-8,-7,1,2,3,4,5,6,9,10}]),
  true)$

okltest_des_sbox_fullcnf_fcs(f) := block([cnf_fcl],
  cnf_fcl : f(1),
  assert(cnf_fcl[1] = {1,2,3,4,5,6,7,8,9,10}),
  assert(length(cnf_fcl[2]) = 960),
  assert(listify(cnf_fcl[2])[1] = {-10,-9,-8,-7,-6,-5,-4,-3,-2,-1}),
  assert(listify(cnf_fcl[2])[960] = {1,2,3,4,5,6,7,8,9,10}),
  cnf_fcl : f(5),
  assert(cnf_fcl[1] = {1,2,3,4,5,6,7,8,9,10}),
  assert(length(cnf_fcl[2]) = 960),
  assert(listify(cnf_fcl[2])[1] = {-10,-9,-8,-7,-6,-5,-4,-3,-2,-1}),
  assert(listify(cnf_fcl[2])[960] = {1,2,3,4,5,6,7,8,9,10}),
  true)$


/*!
\endhtmlonly
*/
