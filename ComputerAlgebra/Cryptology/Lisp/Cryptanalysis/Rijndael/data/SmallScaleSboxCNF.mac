/* Matthew Gwynne, 16.12.2010 (Swansea) */
/* Copyright 2010, 2011 Oliver Kullmann
This file is part of the OKlibrary. OKlibrary is free software$ you can redistribute
it and/or modify it under the terms of the GNU General Public License as published by
the Free Software Foundation and included in this library$ either version 3 of the
License, or any later version. */

/*!
  \file ComputerAlgebra/Cryptology/Lisp/Cryptanalysis/Rijndael/data/SmallScaleSboxCNF.mac
  \brief CNF and r_1-based CNF representations with smallest number of clauses known for each small scale Sbox

Use by

oklib_load("OKlib/ComputerAlgebra/Cryptology/Lisp/Cryptanalysis/Rijndael/data/SmallScaleSboxCNF.mac")$

*/

/*!
\htmlonly
*/

oklib_include("OKlib/ComputerAlgebra/Cryptology/Lisp/Cryptanalysis/Rijndael/SboxAnalysis.mac")$
oklib_include("OKlib/ComputerAlgebra/Cryptology/Lisp/Cryptanalysis/Rijndael/data/SboxCNF.mac")$


/*********************************************************
 * Smallest known number of clauses                      *
 *********************************************************
*/

/* Takes the exponent and the element in the field to multiply with */
ss_sbox_cnfs : sm2hm({})$

set_hm(ss_sbox_cnfs, 4, [[1,2,3,4,5,6,7,8],
  [{-4,-3,-2,5},{-6,-5,-3,-2},{-6,-1,5},{-6,-2,3,5},{-7,-3,1,2},{-7,-5,3,4},
   {-7,-6,-4,2},{-7,-4,-2,3,6},{-5,1,7},{-5,-3,4,7},{-8,-2,1,3},{-8,-4,-3},
   {-8,-5,-2},{-8,2,3,5},{-8,-6,3,4},{-8,-3,6},{-8,-5,-4,-1,6},{-8,-2,4,7},
   {-3,1,4,8},{2,6,8},{-7,-1,8},{3,7,8}]])$

/* Generated by

maxima> output_rijnsbox_fullcnf_stdname();
shell> QuineMcCluskeySubsumptionHypergraph-n16-O3-DNDEBUG AES_Sbox_full.cnf > AES_Sbox_shg.cnf
shell> cat AES_Sbox_shg.cnf | MinOnes2WeightedMaxSAT-O3-DNDEBUG > AES_Sbox_shg.wcnf
shell> ubcsat-okl  -alg gsat -w -runs 100 -cutoff 40000000 -wtarget 294 -solve 1 -seed 3213901809 -i AES_Sbox_shg.wcnf -r model AES_Sbox_s294.ass;
shell> cat  AES_Sbox_full.cnf_primes | FilterDimacs AES_Sbox_s294.ass > AES_Sbox_s294.cnf
maxima> SboxMinCNF : read_fcl_f("AES_Sbox_s294.cnf");

Statistics : [16,294,1939,8,6]

*/
set_hm(ss_sbox_cnfs, 8, SboxMinCNF)$


/*********************************************************
 * r_1-bases with smallest known number of clauses       *
 *********************************************************
*/

ss_sbox_rbase_cnfs : sm2hm({})$

/* Generated by

maxima> output_ss_sbox_fullcnf_stdname(2,4,ss_polynomial_2_4);
shell>  QuineMcCluskey-n8-O3-DNDEBUG AES_sbox_2_4_full.cnf > primes_sbox.cnf
shell>  cat primes_sbox.cnf | SortByClauseLength-O3-DNDEBUG > primes_sbox_sorted.cnf
shell>  RUcpGen-O3-DNDEBUG primes_sbox_sorted.cnf | RUcpBase-O3-DNDEBUG > sbox_base.cnf

Statistics: [8,27,96,4,3]

It is not known if this is the minimum.

*/
set_hm(ss_sbox_rbase_cnfs, 4, [[1,2,3,4,5,6,7,8],
  [{-1,2,5},{-6,-2,-1},{-7,-4,5},{-2,1,7},{1,3,7},{-8,-4,-3},{-8,-5,-2},{-8,-3,6},{-1,3,8},{-5,4,8},{2,6,8},{-7,-1,8},{-4,-3,-1,5},{-6,-4,-3,-2},{-6,-1,3,4},{-6,-2,3,4},{-6,-5,1,2},{-4,-1,2,6},{-5,-2,3,6},{-7,-3,1,2},{-7,-1,2,3},{-2,3,4,7},{-5,-3,4,7},{-8,1,3,4},{-8,-6,3,5},{-3,1,4,8},{-6,4,7,8}]])$

/*!
\endhtmlonly
*/
