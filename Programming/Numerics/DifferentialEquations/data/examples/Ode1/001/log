1) Extreme spikes of accuracies

Using

  const FP::float80 c = 10;
  const RK41d_80::F_t F = [](const FP::float80 x, const FP::float80 y)
  {return FP::fma(FP::cos(x), y + x*x, - 2*x);};
  const RK41d_80::f_t sol = [](const FP::float80 x)
  {return c * FP::exp(FP::sin(x)) - x*x;};
  const FP::float80 x0 = 0, y0h = sol(x0);

that is,

  F(x,y) = cos(x) (y + x^2) - 2x

  sol(x) = c exp(sin(x)) - x^2
  sol(0) = c

yields

> ./Ode1 -10 10 1000 1000
x0                             0
y0                            10
a,b                        -10,1                                                            10,1
N(b,s,i)                    1000                            1000                           25000

x                -10                   0                  10
 y           -82.771                                 -94.196
y            -94.196             -34.655              24.885
 x                10                                    1.46
 ads         -20.863             -14.693              31.218
span-q                             5.954

x                -10                   0                  10
 acc             173                                      23
acc                0          9.9539e+05          1.9908e+06
 x                 0                                   -5.06
 ads          2474.3                 102               62919
span-q                             99539

x                            -10                               0                              10
 y        -82.770789919782434094                                          -94.195903379527587101
y         -94.195903379527587101           -34.65542515257776238           24.885053074372062341
 x                            10                                                            1.46
 ads      -20.863253535788473048          -14.693111203188481335           31.218207540743567614
span-q                                      5.954047822694982472

x                            -10                               0                              10
 acc                         173                                                              23
acc                            0                    9.953925e+05                    1.990785e+06
 x                             0                                          -5.0599999999999999999
 ads  2.47430969030969030964e+03                        1.02e+02      6.29193710114422590145e+04
span-q                                                  99539.25


has one extreme spike (and two much smaller spikes); median-accuracy = 102.

> ./Ode1 -10 10 5000 5000
x0,y0              0                  10
a,b            -10,1                10,1
N's             5000                5000               25000

x                -10                   0                  10

y            -94.196             -34.655              24.885
 x                10                                   1.464
 mu md sd    -20.809                   ?              31.172
span-q                             5.954

acc                0          1.8592e+06          3.7184e+06
 x                 ?                                   -5.06
 mu md sd     2526.1                 404               63495
span-q                        1.8592e+05

x0,y0 : 0 10
x  : -10 0 10
y  : (-94.195903379527583701, 10)
  -34.655404847300224441
  (24.885093684927134821, 1.4639999999999999993)
  mu md sd : -20.809119626840431934 ? 31.171505777237594045
span-q = 5.9540498532227359258
acc: (0, ?)
  1859206.5
  (3.718413e+06, -5.0600000000000000004)
  mu md sd : 2.52612317536492701464e+03  4.04e+02  6.34949638998613483984e+04
span-q = 185920.65000000000001


Three smaller spikes show up; again median-accuracy = 404.

> ./Ode1 -10 10 10000 10000
10000 10000
x  : -10 10
y  : (-94.1959,10) (24.8851,1.462)
-20.8024 31.1657
acc: 0 (1.93055e+07,-5.06)
6990.48 211537 1040

Same picture.

> ./Ode1 -10 10 20000 20000
20000 20000
x  : -10 10
y  : (-94.1959,10) (24.8851,1.462)
-20.799 31.1627
acc: 0 (7.50976e+07,-3.105)
22216.5 706197 1363

Now the smaller spike got larger (still four spikes) --
perhaps they are all similar.

> ./Ode1 -10 10 100000 100000
100000 100000
x  : -10 10
y  : (-94.1959,10) (24.8851,1.4624)
-20.7963 31.1604
acc: 0 (2.33891e+08,-2.0122)
27573 978313 4071

Again the four spikes, but different heights.

These are just the zeros of the solution! And zero is "much more sensitive".


Considering the first root:

> ./Ode1 -5.060057 -5.060056 1000 1000
1000 1000 25000
x  : -5.0600570000000000001 -5.0600565000000000001 -5.060056
y  : (-1.5727463126704784776e-05,-5.0600570000000000001) -6.3056626798548668788e-06 (3.1161377669950510183e-06,-5.060056)
  ms: -6.3056607567695256293e-06 5.4451159861411319918e-06
span_y / span_x = 18.843600893697334738
acc: 54132812 (238785034454,-5.0600561649999999999)
  msm: 1126303730.8511488511 8760323523.2125291126 224969446

It seems basically impossible to improved the low accuracy here:

> ./Ode1 -5.060057 -5.060056 1000 1000 1e5
1000 1000 100000
x  : -5.0600570000000000001 -5.0600565000000000001 -5.060056
y  : (-1.5727463126655132407e-05,-5.0600570000000000001) -6.3056626798052145019e-06 (3.1161377670447034037e-06,-5.060056)
  ms: -6.3056607567198732494e-06 5.4451159861411319959e-06
span_y / span_x = 18.843600893697334753
acc: 24119797 (115851687400,-5.0600561649999999999)
  msm: 532909372.41958041958 4192252984.1892064407 104917363

One needs to check whether the solution is indeed given with high precision.
